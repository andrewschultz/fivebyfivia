commit 40a6a0b54690e52b6d053630c9f2c8560150f8bf
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Tue Jul 13 15:36:13 2021 -0500

    1.0.3 added noun abbreviations in X and fixed the parchment

diff --git a/story.ni b/story.ni
index 82186de..aaabceb 100644
--- a/story.ni
+++ b/story.ni
@@ -73,7 +73,23 @@ when play begins:

 chapter FIVEBYFIVIA DELENDA EST

-FIVEBYFIVIA DELENDA EST is a thing. the player carries FIVEBYFIVIA DELENDA EST. description of DELENDA is "[DELENDA] contains the instructions for your current quest. Right now, it seems you need to [current-quest-text].[paragraph break]There are also some general notes about not calling the enemy king until your allies are all set, or he'll get suspicious.".
+FIVEBYFIVIA DELENDA EST is a thing. the player carries FIVEBYFIVIA DELENDA EST. description of DELENDA is "[DELENDA] contains the instructions for your current quest. Right now, it seems you need to [current-quest-text].[paragraph break][noun-abbrevs].".
+
+to say noun-abbrevs:
+	if quest-index is 4:
+		say "There seem to be no useful scrawls in the margins for this final quest";
+		continue the action;
+	say "Scrawls in the margins indicate ways to think of your allies more efficiently. ";
+	if in-tutorial is true:
+		say "[b]Q[r] calls the Queen, [b]R[r] the rook, and [b]K[r] the enemy king";
+		continue the action;
+	if quest-index is 1:
+		say "[b]KR[r] and [b]QR[r] pick a rook, though since they're functionally equivalent, [b]R[r] is just fine, too";
+	else if quest-index is 2:
+		say "Q[r] refers to the Queen";
+	else if quest-index is 3:
+		say "R refers to [the preferred-rook]";
+	say ". [b]K[r] refers to your King if he's not placed and the enemy King if yours is. You could think [b]K1[r] and [b]K2[r], but since the enemy king should be called last (he may get suspicious if he has to wait around,) that may be excessive";

 printed name of DELENDA is "[i]FIVEBYFIVIA DELENDA EST[r]".

@@ -84,11 +100,11 @@ understand "del" as DELENDA.
 understand "scroll" as DELENDA.

 after examining DELENDA for the first time:
-	say "You may wish to shorten typing [delenda]'s long name to [b]FDE[r], [b]EST[r], or [b]DEL[r]. Or you can just type [b]X[r]. You're an ambitious knight, not some boring old scribe who shows off writing fancy words out. You have much more exciting ways to show off!"
+	say "You may wish to shorten typing [delenda]'s long name to [b]FDE[r], [b]EST[r], or [b]DEL[r]. Or you can just type [b]X[r]. You're an ambitious knight, not some boring old scribe who writes big long fancy words out, just because. You have much more exciting ways to show off!"

 to say current-quest-text:
 	if quest-index is 4:
-		say "trample around all twenty-five precincts of [5b] without repeating twice";
+		say "trample around all twenty-five counties of [5b] without repeating twice";
 		continue the action;
 	say "entrap the [age-of] king of [5b] with [the list of offensive pieces]"

@@ -648,7 +664,7 @@ to show-the-board:
 	say "1[pie of a1][pie of b1][pie of c1][pie of d1][pie of e1] 1[line break]";
 	say "  a b c d e[variable letter spacing][paragraph break]";
 	if in-tutorial is true:
-		say "Q = queen, R = queenside rook, k = enemy king, + = guarded square.";
+		say "Q = queen, R = rook, k = enemy king, + = guarded square.";
 		continue the action;
 	say "[if in-tutorial is false]* = you, ^ = available in one move, [end if]+ = square is guarded[if friendly king is not irrelevant], K = your king[end if][if queenside rook is not irrelevant or kingside rook is not irrelevant], R = rook[end if][if queen is not irrelevant], Q = queen[end if], k = enemy king.";

@@ -850,32 +866,38 @@ parch-take-count is a number that varies.

 check taking PARCHMENTE:
 	increment parch-take-count;
-	say "[one of]It blows away before you can get close! Well, that's a bit of temptation resisted by default. Perhaps it will fly back into view later[or]This time, you snag the parchment[stopping].";
+	say "[one of]It blows away before you can get close! Well, that's a bit of temptation resisted by default. Perhaps it will fly back into view sooner or later (fourth wall break: it should be sooner.)[or]This time, you snag the parchment.[stopping]";
 	if parch-take-count is 2:
 		now player has PARCHMENTE;
 	the rule succeeds;

-description of YE OLDE HINTE PARCHMENTE is "[if player does not have parchmente]It's too far to read. You'll have to TAKE it to read it[else][parchment-tips][end if]."
+description of YE OLDE HINTE PARCHMENTE is "[if player does not have parchmente]The writing's too small to read when it's on the ground. You'll have to TAKE it to read it[else][parchment-tips][end if]"

 read-so-far is a number that varies. read-so-far is 1.

 this is the theres-more rule:
 	say "There's more. Read it (Y, any other letter is N)?";
 	let Q be the chosen letter;
-	if Q is 89 or Q is 115, the rule succeeds;
+	if Q is 89 or Q is 121, the rule succeeds;
 	the rule fails;

 to say parchment-tips:
-	say "1. Ye must save the CORNER SQUARES for last.";
+	say "1. Ye must save CERTAIN COUNTIES for last. Which might they be?";
 	if read-so-far < 2:
 		consider the theres-more rule;
 		unless the rule succeeded, continue the action;
-		now read-so-far is 3;
-	say "2. Ye have but one route to and from each CORNER SQUARE.";
+		now read-so-far is 2;
+	say "2. Ye must save the CORNER COUNTIES for last.";
 	if read-so-far < 3:
 		consider the theres-more rule;
 		unless the rule succeeded, continue the action;
-	say "3. If ye avoid such squares, you may soon find the next move is FORCED, saving thee considerable brain work."
+		now read-so-far is 3;
+	say "3. Ye have but one route to and from each CORNER COUNTY.";
+	if read-so-far < 4:
+		consider the theres-more rule;
+		unless the rule succeeded, continue the action;
+		now read-so-far is 4;
+	say "4. If ye avoid such CORNER COUNTIES, you may soon find the next move is FORCED, saving thee considerable brain work.[no line break]"

 volume regular verbs to reject

@@ -1143,7 +1165,7 @@ to show-visited:
 	say "2[vis of a2][vis of b2][vis of c2][vis of d2][vis of e2] 2[line break]";
 	say "1[vis of a1][vis of b1][vis of c1][vis of d1][vis of e1] 1[line break]";
 	say "  a b c d e[variable letter spacing][line break]";
-	say "You've visited [number of circle-visited rooms] of [5b]'s twenty-five precincts.";
+	say "You've visited [number of circle-visited rooms in words] of [5b]'s twenty-five counties.";

 carry out statsing:
 	if quest-index is 4:
@@ -1244,7 +1266,8 @@ understand "v" as verbsing.

 carry out verbsing:
 	say "The main verbs you can use are about going places. You have 8 different diagonal directions, which you can see in detail with [b]DIRS[r].";
-	say "You can also [b]C[r]/[b]CALL[r] or [b]P[r]/[b]PLACE[r] allies or the [5b]n king. These are all the commands you need to win. [b]X[r] [delenda] for your current quest. You can also [b]FAIL[r]/[b]F[r] to reset the current quest.";
+	say "You can also [b]C[r]/[b]CALL[r] or [b]P[r]/[b]PLACE[r] allies or the [5b]n king. You can often use abbreviations for the allies you need to place. These are all the commands you need to win.";
+	say "[line break][b]X[r] [delenda] details your current quest, including useful shorthand to refer to your allies. You can also [b]FAIL[r]/[b]F[r] to reset the current quest.";
 	say "[line break]But there are also meta-commands. Of these, [b]M[r] or [b]MAP[r] to see the map at any time is likely to be the most useful. It shows you where your allies are and what they are guarding. [b]B[r] or [b]BOARD[r] also works.";
 	say "General meta-commands include [b]ABOUT[r]/[b]A[r] and [b]CREDITS[r]/[b]CR[r] for general game information and thanks.";
 	say "You also have the option of toggling abbreviations of long directions with [b]ABB[r].";
@@ -1256,8 +1279,6 @@ carry out verbsing:
 	else:
 		say "[b]T[r] toggles tour view for the quest between printing directions and printing a map.";
 	say "And of course, there's this command, too: [b]VERBS[r]/[b]VERB[r]/[b]V[r].";
-	say "[line break]While this is more nouns than vertbs, note you can often use abbreviations for nouns, e.g. [b]CALL Q[r] for the queen or [b]CALL KR[r] for the kingside rook or [b]CALL K[r] for the king.";
-	the rule succeeds.

 chapter xyzzying

commit 9e3ab7dcd7be81f3aa3a7196077ca16601ccb8b5
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Tue Jul 13 09:17:34 2021 -0500

    1.0.3 release: story.ni added meta-information, T now toggles views for all quests closed #4

diff --git a/story.ni b/story.ni
index 6805f02..82186de 100644
--- a/story.ni
+++ b/story.ni
@@ -10,6 +10,10 @@ release along with the "Parchment" interpreter.

 release along with cover art.

+to say email: say "blurglecruncheon@gmail.com"
+
+to say github: say "https://github.com/andrewschultz/fivebyfivia-delenda-est"
+
 volume basics and definitions

 include Undo Output Control by Erik Temple.
@@ -42,8 +46,9 @@ after examining a thing (called th):

 got-rook-for-queen is a truth state that varies.

-understand the command "y" as something new. [this is to reject "That was a rhetorical question" before ]
-understand the command "yes" as something new. [this is to reject "That was a rhetorical question" before ]
+understand the command "y" as something new.
+understand the command "yes" as something new.
+understand the command "no" as something new. [these are to reject the "That was a rhetorical question" error, which can annoy players. ]

 chapter rooms

@@ -154,10 +159,13 @@ to say room-color:
 rule for printing the locale description:
 	if quest-index is 4:
 		now location of player is circle-visited;
-		if show-tour-view is true:
+		if maps-in-description is true:
 			show-visited;
 			the rule succeeds;
-	say "[room-detail].";
+	if maps-in-description is true:
+		show-the-board;
+	else:
+		say "[room-detail].";
 	continue the action;

 to say room-detail:
@@ -431,6 +439,7 @@ when play begins:
 				now re2 is mapped southeasteast of rn1;
 				now rn1 is mapped northwestwest of re2;
 	setup-next-puzzle;
+	say "[line break][bracket]NOTE: [5b] has different commands from standard adventures, including options that may make navigation easier. The [b]ABOUT[r]/[b]A[r] and [b]VERBS[r]/[b]V[r] commands describe them.[close bracket][line break]";

 volume people and quests

@@ -617,7 +626,7 @@ to quest-conclusion:
 		say "The king is dead, cut down in his prime! Long live the young king. Any show of overwhelming force is likely to intimidate him, but etiquette demands he meet with your king -- and perhaps one of your rooks will trail along. You wonder what you can do with that.";
 	else if quest-index is 3:
 		say "The young king is dead! The last of his line. All that remains for you to do is the traditional dance of victory and domination over a weaker country. It is time to walk over each of Fivebyfivia's twenty-five counties without repeating, to show your kingdom's efficiency in both conquering and providing vital constituent services. Okay, mostly conquering.[paragraph break]By the way, there is a new meta-verb. [b]T[r] or [b]TOUR[r] to toggles tour view mode, which shows an overall map of [5b] instead of telling you directions. It is set to on.";
-		if screen-reader is false, now show-tour-view is true;
+		if screen-reader is false, now maps-in-description is true;
 	increment quest-index;
 	setup-next-puzzle;

@@ -641,7 +650,7 @@ to show-the-board:
 	if in-tutorial is true:
 		say "Q = queen, R = queenside rook, k = enemy king, + = guarded square.";
 		continue the action;
-	say "[if in-tutorial is false]* = you, [end if]+ = square is guarded[if friendly king is not irrelevant], K = your king[end if][if queenside rook is not irrelevant or kingside rook is not irrelevant], R = rook[end if][if queen is not irrelevant], Q = queen[end if], k = enemy king.";
+	say "[if in-tutorial is false]* = you, ^ = available in one move, [end if]+ = square is guarded[if friendly king is not irrelevant], K = your king[end if][if queenside rook is not irrelevant or kingside rook is not irrelevant], R = rook[end if][if queen is not irrelevant], Q = queen[end if], k = enemy king.";

 to say pie of (r - a room):
 	say " ";
@@ -657,6 +666,8 @@ to say pie of (r - a room):
 		say "*";
 	else if r is guarded:
 		say "+";
+	else if r is knight-movable:
+		say "^";
 	else:
 		say "-"

@@ -931,7 +942,7 @@ understand "about" as abouting.
 understand "a" as abouting.

 carry out abouting:
-	say "This game was originally written for ParserComp 2021.[paragraph break]I'd always sort of had an idea to write up a game about chess, especially after playing Zork Zero, but I never quite found one that could be simple enough for people who didn't play and worthwhile enough for those who did. And even if it did balance these, where was the story?[paragraph break]I wasn't expecting one to pop up. The resurgence of chess online with COVID, along with tournaments like PogChamps, reminded me that there was a lot more to chess than twenty-move-deep theoretical slogs.[paragraph break]But one evening, something came into form. And as ParserComp's deadline came up, my bigger plan had stalled, so why not bail out?[paragraph break]I like parser games with weird directions. So I tried to make one.[paragraph break]Thankfully, I was able to find something that worked, technically, and it had the shell of a story, too. And I hope you enjoy this, too, whether or not you play chess.";
+	say "This game was originally written for ParserComp 2021.[paragraph break]I'd always sort of had an idea to write up a game about chess, especially after playing Zork Zero, but I never quite found one that could be simple enough for people who didn't play and worthwhile enough for those who did. And even if it did balance these, where would the story be? I wasn't expecting anything to pop up.[paragraph break]The resurgence of chess online with COVID, along with tournaments like PogChamps, reminded me that there was a lot more to chess than twenty-move-deep theoretical slogs.[paragraph break]Then one evening, something came into form. And as ParserComp's deadline came up, my bigger planned game had stalled, so why not bail out?[paragraph break]I had some initial doubts, but I started to see how I could work around them. The result was something that worked technically, addressed an odd sort of position that always amused me, and it had the shell of a story, too. I'd also wanted to do some programming related to chess, so I had fun. And I hope you enjoy this, too, whether or not you play chess.[paragraph break]If this is still during ParserComp, please also check out the other games (17 others!) and try to leave a transcript. For Z-machine games, typing TRANSCRIPT helps--even if you can't find anything or leave comments, the programmer may notice certain things worth fixing from how you play, e.g. they wanted to make a hint more prominent. My address is [email].[paragraph break][b]CREDITS[r]/[b]CR[r] has more information about specific people who helped me.";
 	the rule succeeds.

 chapter boarding
@@ -978,12 +989,16 @@ chapter creditsing
 creditsing is an action out of world.

 understand the command "credits" as something new.
+understand the command "cr" as something new.

 understand "credits" as creditsing.
+understand "cr" as creditsing.

 carry out creditsing:
-	say "Thanks to Wade Clarke, Dee Cooke, Arthur DiBianca, Garry Francis and Olaf Nowicki for testing.";
-	say "[line break]Thanks to chessgames.com, chess.com and lichess.org for all the chess fun and puzzles and opponents from all over the globe. This all was especially nice during the pandemic.";
+	say "Thanks to Wade Clarke, Dee Cooke, Arthur DiBianca, Garry Francis and Olaf Nowacki for testing. I know my games are tricky to test, especially when I have the idea 2-3 weeks before the deadline.";
+	say "[line break]Thanks to Adam Sommerfield for holding ParserComp and for allowing updates. I tried not to need them but failed.";
+	say "[line break]Thanks to the people on itch.io who reported bugs in-comp, including salty-horse. It may seem trivial, but trust me: after that first five minutes of 'Geez, that can't be it. Wait, did I overlook THAT?' it's very much appreciated. If you find a bug, report it at [github] or send me a mail at [email].";
+	say "[line break]Thanks to chessgames.com, chess.com and lichess.org for all the chess fun and puzzles and opponents from all over the globe. This all has been especially nice during the pandemic.";
 	the rule succeeds.

 chapter dirsing
@@ -999,7 +1014,7 @@ understand "dir" as dirsing.
 carry out dirsing:
 	say "There are eight directions your horse can travel,, clockwise from north: northnortheast, northeasteast, southeasteast, southsoutheast, southsouthwest, southwestwest, northwestwest and northnorthwest.";
 	say "[line break]That's a bit long, so you can abbreviate them [b]NNE[r], [b] NEE[r], [b] SEE[r], [b] SSE[r], [b] SSW[r], [b] SWW[r], [b]NWW[r], [b]NNW[r] or any possible permutations. The game will treat all similar permutations as identical, e.g. there is no practical difference between [b]NNE[r], [b]NEN[r] and [b]ENN[r].";
-	say "You can toggle how the directions appear (long or short) in room descriptions with [b]ABB[r] or [b]A[r].";
+	say "[line break]You can toggle how the directions appear (long or short) in room descriptions with [b]ABB[r] or [b]A[r].";
 	the rule succeeds.

 chapter fail
@@ -1094,7 +1109,7 @@ to say vis of (r - a room):
 		say "+";
 	else if r is circle-visited:
 		say "*";
-	else if quest-index is 4 and r is knight-movable:
+	else if r is knight-movable:
 		say "?[no line break]";
 	else:
 		say " "
@@ -1153,18 +1168,18 @@ chapter ting
 ting is an action applying to nothing.

 understand the command "t" as something new.
-understand the command "tour" as something new.
+understand the command "toggle" as something new.

-understand "t" as ting when quest-index is 4.
-understand "tour" as ting when quest-index is 4.
+understand "t" as ting.
+understand "toggle" as ting.

 carry out ting:
-	if screen-reader is true, say "Toggling tour view would cause the screen reader to make strange outputs, so I'm restricting it." instead;
-	now show-tour-view is whether or not show-tour-view is false;
-	say "Tour view is now [on-off of show-tour-view].";
+	if screen-reader is true, say "Toggling maps in the room description would cause the screen reader to make strange outputs, so I'm restricting it." instead;
+	now maps-in-description is whether or not maps-in-description is false;
+	say "Toggling maps in the room description to [on-off of maps-in-description].";
 	the rule succeeds.

-show-tour-view is a truth state that varies.
+maps-in-description is a truth state that varies.

 chapter tuting

@@ -1231,7 +1246,7 @@ carry out verbsing:
 	say "The main verbs you can use are about going places. You have 8 different diagonal directions, which you can see in detail with [b]DIRS[r].";
 	say "You can also [b]C[r]/[b]CALL[r] or [b]P[r]/[b]PLACE[r] allies or the [5b]n king. These are all the commands you need to win. [b]X[r] [delenda] for your current quest. You can also [b]FAIL[r]/[b]F[r] to reset the current quest.";
 	say "[line break]But there are also meta-commands. Of these, [b]M[r] or [b]MAP[r] to see the map at any time is likely to be the most useful. It shows you where your allies are and what they are guarding. [b]B[r] or [b]BOARD[r] also works.";
-	say "General meta-commands include [b]ABOUT[r]/[b]A[r] and [b]CREDITS[r] for general game information and thanks.";
+	say "General meta-commands include [b]ABOUT[r]/[b]A[r] and [b]CREDITS[r]/[b]CR[r] for general game information and thanks.";
 	say "You also have the option of toggling abbreviations of long directions with [b]ABB[r].";
 	say "If you want a rules refresher, [b]CHESS[r] or [b]CH[r] will teach you all you need to know. Don't worry--you won't be quizzed on en passant!";
 	if quest-index > 1:
commit d93641b5288b2dfadcbad81ba278cf1a4726776b
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jul 7 06:01:52 2021 -0500

    1.0.2 trivial fix for full disambiguation of rooks

diff --git a/story.ni b/story.ni
index 6ed6e73..6805f02 100644
--- a/story.ni
+++ b/story.ni
@@ -457,7 +457,7 @@ check taking a piece:

 preferred-rook is a piece that varies.

-does the player mean calling preferred-rook when quest-index is 2 or quest-index is 3: it is likely. [ this is to avoid disambiguation that gets rejected either way ]
+does the player mean calling preferred-rook: it is likely. [ this is to avoid disambiguation that gets rejected either way e.g. "do you want the kingside or queenside rook?" / either / "That is not part of your maneuvers." ]

 definition: a piece (called p) is offensive:
 	if p is enemy king, no;
@@ -699,7 +699,7 @@ definition: a piece (called p) is accessory:

 to setup-next-puzzle:
 	reset-the-board;
-	if quest-index is 1 or quest-index is 3:
+	if quest-index < 4: [ maybe this randomization is self-indulgent, but the QR and KR are functionally equivalent. ]
 		if a random chance of 1 in 2 succeeds:
 			now preferred-rook is queenside rook;
 		else:
commit 5e65f150e61471f02d85cefb1e569471247cc722
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jul 7 05:00:23 2021 -0500

    1.0.2 caught regression in enemy king placement, found bug in detecting kings placed next to each other code

diff --git a/README.md b/README.md
index 8b5dc42..db69979 100644
--- a/README.md
+++ b/README.md
@@ -1,2 +1,7 @@
-# knights-errand
-ParserComp 2021 project
+# Fivebyfivia Delenda Est
+
+A ParserComp 2021 project.
+
+This repository was private while being developed for ParserComp, where judging started on July 1, 2021. The full game page is at https://andrewschultz.itch.io/fivebyfivia-delenda-est.
+
+The code was officially opened to the public on July 6, 2021.
diff --git a/story.ni b/story.ni
index 9b3caec..6ed6e73 100644
--- a/story.ni
+++ b/story.ni
@@ -457,7 +457,7 @@ check taking a piece:

 preferred-rook is a piece that varies.

-does the player mean calling preferred-rook when quest-index is not 3: it is likely. [ this is to avoid disambiguation that gets rejected either way ]
+does the player mean calling preferred-rook when quest-index is 2 or quest-index is 3: it is likely. [ this is to avoid disambiguation that gets rejected either way ]

 definition: a piece (called p) is offensive:
 	if p is enemy king, no;
@@ -531,12 +531,13 @@ rule for supplying a missing noun when calling:
 		say "You need to specify which ally to summon of [the list of not-last pieces].";
 		reject the player's command.

-this is the enemy-placement rule:
+this is the enemy-king-placement rule:
 	if number of reserved pieces > 1:
 		say "You probably don't want to summon the enemy king until last. He'd get really suspicious if you just made him wait around." instead;
-	if enemy king is off-stage or location of enemy king is offsite, continue the action;
-	if absval of (x of location of enemy king - x of location of friendly king) < 2 and absval of (y of location of enemy king - y of location of friendly king) < 2:
-		say "Wait, no, you can't put the enemy kings adjacent to each other, not even diagonally. They operate through intermediaries, apparently." instead;
+	let ax be absval of (x of location of player - x of location of friendly king);
+	let ay be absval of (y of location of player - y of location of friendly king);
+	if  ax < 2 and ay < 2:
+		say "Wait, no, you can't put the enemy kings adjacent to each other[if ax is 1 and ay is 1], not even diagonally[end if]. They operate through intermediaries, apparently." instead;

 carry out calling:
 	if quest-index is 4, say "You're on your own now." instead;
@@ -550,7 +551,7 @@ carry out calling:
 	if number of pieces in location of player > 0:
 		say "That would make things too crowded here at [location of player], since [the random piece in location of player] is already present." instead;
 	if noun is enemy king:
-		abide by the enemy-placement rule;
+		abide by the enemy-king-placement rule;
 	say "You call [the noun] to [location of player].";
 	now need-to-hurry is true;
 	now noun is placed;
@@ -698,7 +699,7 @@ definition: a piece (called p) is accessory:

 to setup-next-puzzle:
 	reset-the-board;
-	if quest-index is 1 or quest-index is 2:
+	if quest-index is 1 or quest-index is 3:
 		if a random chance of 1 in 2 succeeds:
 			now preferred-rook is queenside rook;
 		else:
@@ -1288,6 +1289,7 @@ test q1f with "call rook/nnw/call rook/ssw/call king".
 test q1 with "ssw/nnw/see/see/call kingside/nww/call queenside/sww/call king".
 test q1s with "nnw/call kingside/ssw/see/call queenside/sww/call king".

+test q2a with "see/place k/sww/place q/nne/sse/place k".
 test q2f with "call queen/nnw/call king/ssw/call king".
 test q2n with "ssw/nee/call queen/sww/nne/call king/sse/call king".
 test q2 with "sse/call queen/nnw/ssw/nnw/call friendly king/sse/call enemy king".
commit 4795d7cda99a509fbd3733a2d7efe2d35f1a1531
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jul 7 04:27:29 2021 -0500

    1.0.2 pre-release testing: forgot to reset guards after tutorial, uncovered another bug from badly written code

diff --git a/story.ni b/story.ni
index 9f738d2..9b3caec 100644
--- a/story.ni
+++ b/story.ni
@@ -127,8 +127,8 @@ Include (-
 	'x//':   print "examine";
 	'z//':   print "wait";
 	'about':  print "see info about the game";
-	'c//', 'credit', 'credits': print "see the credits";
-	'c//', 'p//', 'call', 'place': print "place";
+	'credit', 'credits': print "see the credits";
+	'c//', 'p//', 'call', 'place': print "(P)lace or (C)all";
 	default: rfalse;
 	}
 	rtrue;
@@ -478,7 +478,7 @@ summon-list of queen is { false, true, false, false }.

 the kingside rook is a neuter piece. understand "kr" as kingside rook. understand "r" as kingside rook. short-text of kingside rook is "KR/R".

-summon-list of kingside rook is { true, false, true, false }.
+summon-list of kingside rook is { true, false, false, false }.

 the queenside rook is a neuter piece. understand "qr" as queenside rook. understand "r" as queenside rook. short-text of queenside rook is "QR/R".

@@ -534,8 +534,8 @@ rule for supplying a missing noun when calling:
 this is the enemy-placement rule:
 	if number of reserved pieces > 1:
 		say "You probably don't want to summon the enemy king until last. He'd get really suspicious if you just made him wait around." instead;
-	if enemy king is off-stage, continue the action;
-	if absval of (x of location of enemy king - x of location of enemy king) < 2 and absval of (y of location of enemy king - y of location of enemy king) < 2:
+	if enemy king is off-stage or location of enemy king is offsite, continue the action;
+	if absval of (x of location of enemy king - x of location of friendly king) < 2 and absval of (y of location of enemy king - y of location of friendly king) < 2:
 		say "Wait, no, you can't put the enemy kings adjacent to each other, not even diagonally. They operate through intermediaries, apparently." instead;

 carry out calling:
@@ -698,16 +698,18 @@ definition: a piece (called p) is accessory:

 to setup-next-puzzle:
 	reset-the-board;
+	if quest-index is 1 or quest-index is 2:
+		if a random chance of 1 in 2 succeeds:
+			now preferred-rook is queenside rook;
+		else:
+			now preferred-rook is kingside rook;
+		if quest-index is 3:
+			now entry 3 of summon-list of preferred-rook is true;
 	repeat with P running through pieces:
 		if entry quest-index of summon-list of P is true:
 			now P is reserved;
 		else:
 			now P is irrelevant;
-	if quest-index is 1:
-		if a random chance of 1 in 2 succeeds:
-			now preferred-rook is queenside rook;
-		else:
-			now preferred-rook is kingside rook;
 	if quest-index is 4:
 		say "No allies this time.";
 	else:
@@ -1196,7 +1198,8 @@ carry out tuting:
 		let Q be the chosen letter;
 		if Q is 81 or Q is 113, break;
 	now in-tutorial is false;
-	repeat with X running through tutorial-held pieces:
+	reset-guard;
+	repeat with X running through pieces:
 		now X is in offsite;
 		now X is not tutorial-held;
 	repeat with X running through pieces:
diff --git a/todo.txt b/todo.txt
index 13c5e98..a8d00c7 100644
--- a/todo.txt
+++ b/todo.txt
@@ -1,8 +1 @@
 TO DO LIST:
-
-[??rook roll pun]
-[?? random rook placed for 1st]
-[??note kingside/queenside rook the same]
-[?? random rook for final?]
-[?? what if random flight square, a piece is on it. Have a capture.]
-
commit 8171bf8229ee1c2da302a5ba20fb472f6075f78e
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Tue Jul 6 08:16:17 2021 -0500

    1.0.2 release: fix TUTORIAL verb, remember to reset pieces

diff --git a/story.ni b/story.ni
index fd8e5e3..9f738d2 100644
--- a/story.ni
+++ b/story.ni
@@ -64,6 +64,7 @@ when play begins:
 		now screen-reader is true;
 	say "Peace treaties get old and boring and stuffy after a while, y'know? They don't exactly keep up with the times. History changes. Perhaps the wimps who got a CLEAR bargain from the peace treaty don't deserve it any more.[paragraph break]That's definitely the case with [5b]. They've had fun for long enough. Besides, [12b] was called Elshapium when the treaty was signed, and now annexing [5b] would just about make a nice new square tidy country, pleasing to look at on a map.[paragraph break]Besides, if [12b] doesn't annex [5b], some far less civilized nation will. It's for their own good. Especially since gold and precious metals were discovered.[paragraph break]Thankfully, the [12b] spy ministry has devised a cunning plan to make sure things go as well as they can for [5b]. And you, a knight with a crazy (and crazy fast) horse, are just the person to help execute it! The old [5b]n king will never suspect you.[paragraph break]A solemn minister hands you a scroll entitled [FIVEBYFIVIA DELENDA EST]. And you're off!";
 	now right hand status line is "[entry quest-index of quest-quick-desc]";
+	now all pieces are in offsite;

 chapter FIVEBYFIVIA DELENDA EST

@@ -445,7 +446,7 @@ chapter pieces

 a piece is a kind of person. a piece can be reserved, irrelevant or placed. a piece is usually irrelevant. a piece has a list of truth state called summon-list. a piece has text called short-text.

-a piece has a room called cached-position.
+a piece has a room called cached-position. cached-position of a piece is usually offsite.

 a piece can be tutorial-held. a piece is usually not tutorial-held.

@@ -728,7 +729,7 @@ to fail-and-reset:
 past-intro is a truth state that varies.

 to reset-the-board:
-	now all pieces are off-stage;
+	now all pieces are in offsite;
 	now all placed pieces are reserved;
 	now all rooms are not guarded;
 	now max-turns-after-placing is entry quest-index of max-wait-times;
@@ -1193,8 +1194,14 @@ carry out tuting:
 		say "[blather entry][line break]";
 		say "Type any key to continue[if my-row < 4] or Q to quit[end if].";
 		let Q be the chosen letter;
-		if Q is 81 or Q is 113, the rule succeeds;
+		if Q is 81 or Q is 113, break;
 	now in-tutorial is false;
+	repeat with X running through tutorial-held pieces:
+		now X is in offsite;
+		now X is not tutorial-held;
+	repeat with X running through pieces:
+		if cached-position of X is not offsite, move X to cached-position of X;
+		now cached-position of X is offsite;
 	the rule succeeds.

 table of tutorial stuff
commit 21c42ac0c25b686c38aeae24d5db5f737796f4d9
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Tue Jul 6 08:15:26 2021 -0500

    two small changes for 1.0.1: web interpreter and cover art

diff --git a/story.ni b/story.ni
index 10795c4..fd8e5e3 100644
--- a/story.ni
+++ b/story.ni
@@ -6,7 +6,9 @@ the story description is "Less impossible than beating Stockfish".

 release along with a website.

-release along with an interpreter.
+release along with the "Parchment" interpreter.
+
+release along with cover art.

 volume basics and definitions

commit 20f52e3da41a6f1c3c810f6fb95cc1d2e85c0942
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jun 30 22:22:39 2021 -0500

    a few more changes before release

diff --git a/story.ni b/story.ni
index 4b315aa..10795c4 100644
--- a/story.ni
+++ b/story.ni
@@ -4,6 +4,10 @@ the story headline is "Flagrant Horsing Around".

 the story description is "Less impossible than beating Stockfish".

+release along with a website.
+
+release along with an interpreter.
+
 volume basics and definitions

 include Undo Output Control by Erik Temple.
@@ -220,7 +224,7 @@ after printing the locale description when need-to-hurry is true:
 after printing the locale description when quest-index is 1:
 	increment moves-this-quest;
 	if remainder after dividing moves-this-quest by 7 is 0 and number of placed pieces is 0:
-		say "You're still looking around for the best square to [b]CALL[r] or [b]PLACE[r] allies. It's worth scouting around, but just so you know, more than one square works for the first piece, and even if you mess up, this quest will reset, and you can retry. It's worth experimenting.[paragraph break]Oh, and if you want to seriously plan things out, every other square is reachable in four moves from the center.";
+		say "[line break]You're still looking around for the best square to [b]CALL[r] or [b]PLACE[r] allies. It's worth scouting around, but just so you know, more than one square works for the first piece, and even if you mess up, this quest will reset, and you can retry. It's worth experimenting.[paragraph break]Oh, and if you want to seriously plan things out, every other square is reachable in four moves from the center.";
 	continue the action;

 section circle-visited
@@ -450,7 +454,7 @@ check taking a piece:

 preferred-rook is a piece that varies.

-does the player mean calling preferred-rook when quest-index is 1: it is likely.
+does the player mean calling preferred-rook when quest-index is not 3: it is likely. [ this is to avoid disambiguation that gets rejected either way ]

 definition: a piece (called p) is offensive:
 	if p is enemy king, no;
@@ -539,7 +543,7 @@ carry out calling:
 	if noun is placed:
 		say "You already placed [the noun] at [location of the noun]." instead;
 	if noun is irrelevant:
-		say "Right now [the noun] is not part of your maneuver." instead;
+		say "Right now [the noun] is not part of your maneuver. You can, however, call [the list of reserved pieces]." instead;
 	if number of pieces in location of player > 0:
 		say "That would make things too crowded here at [location of player], since [the random piece in location of player] is already present." instead;
 	if noun is enemy king:
@@ -736,8 +740,6 @@ to reset-the-board:
 		if debug-state is true, say "DEBUG [random-parchment-number].";
 	if past-intro is true:
 		say "[if location of player is not c3]You go back to c3 in the center to start again[else]You're already at c3 in the center, so that saves time starting again[end if]. Time to re-summon [the list of accessory pieces].";
-		else:
-			say ".";
 		if location of player is not c3:
 			move player to c3;
 	else:
@@ -754,7 +756,7 @@ this is the takeit processing rule:

 this is the stalemate processing rule:
 	unless the location of the enemy king is not checked and the location of the enemy king is surrounded, the rule fails;
-	say "The enemy king looks around. He sighs in relief, safe at the moment. But he is a busy man! He needs to get up and do things. Every which way he looks, though, he realize he's being watched. He quickly looks from left to right but surrenders.[paragraph break]Since nobody was directly attacking him, nobody gets the kill. He's taken prisoner. Everyone else looks at you funny.";
+	say "The enemy king looks around. He sighs in relief, safe at the moment. But he is a busy man! He needs to get up and do things. Every which way he looks, though, he realize he's being watched. He quickly looks from left to right but surrenders.[paragraph break]Since nobody was directly attacking him, nobody gets the kill. He's taken prisoner. Everyone else looks at you funny. All this roundabout capturing stuff just isn't in the spirit of classical warfare!";
 	now entry quest-index in stalemated is True;
 	the rule succeeds;

@@ -989,9 +991,9 @@ understand "dirs" as dirsing.
 understand "dir" as dirsing.

 carry out dirsing:
-	say "The eight directions your horse can travel are, clockwise from north, northnortheast, northeasteast, southeasteast, southsoutheast, southsouthwest, southwestwest, northwestwest and northnorthwest.";
-	say "That's a bit long, so you can abbreviate them [b]NNE[r], [b] NEE[r], [b] SEE[r], [b] SSE[r], [b] SSW[r], [b] SWW[r], [b]NWW[r], [b]NNW[r] or any possible permutations. The game will treat all similar permutations as identical, e.g. there is no practical difference between [b]NNE[r], [b]NEN[r] and [b]ENN[r].";
-	say "You can toggle how the directions appear (long or short) in room descriptions with [b]ABB[r].";
+	say "There are eight directions your horse can travel,, clockwise from north: northnortheast, northeasteast, southeasteast, southsoutheast, southsouthwest, southwestwest, northwestwest and northnorthwest.";
+	say "[line break]That's a bit long, so you can abbreviate them [b]NNE[r], [b] NEE[r], [b] SEE[r], [b] SSE[r], [b] SSW[r], [b] SWW[r], [b]NWW[r], [b]NNW[r] or any possible permutations. The game will treat all similar permutations as identical, e.g. there is no practical difference between [b]NNE[r], [b]NEN[r] and [b]ENN[r].";
+	say "You can toggle how the directions appear (long or short) in room descriptions with [b]ABB[r] or [b]A[r].";
 	the rule succeeds.

 chapter fail
commit 589d65402ea31bc6a9f86ac7a29bc4628687032d
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jun 30 13:16:24 2021 -0500

    Olaf changes: mostly adding information about quests

diff --git a/story.ni b/story.ni
index aa8366c..4b315aa 100644
--- a/story.ni
+++ b/story.ni
@@ -6,6 +6,8 @@ the story description is "Less impossible than beating Stockfish".

 volume basics and definitions

+include Undo Output Control by Erik Temple.
+
 include Trivial Niceties by Andrew Schultz.

 include Old School Verb Total Carnage by Andrew Schultz.
@@ -376,7 +378,7 @@ to decide which room is room_of (n1 - a number) and (n2 - a number):
 			decide on Q;
 	if debug-state is true:
 		say "(DEBUG) Could not find room for [n1] and [n2].";
-	decide on offsite
+	decide on offsite;

 check going a normal direction:
 	if noun is up, say "Your horse can fly across ground but not over it." instead;
@@ -668,7 +670,7 @@ after printing the locale description when quest-index is 4:
 			say "Because of the lack of blood, other nations shake their head at [12b]'s annexation of [5b], but what can they do? Your discretion went above and beyond what the king and queen required of you. They delegate you to plan annexation of west, central and east Twelvebyfouria to the south. Each requires a slightly different solution: first, you take two knights, which people say couldn't be done -- but with the help of a treacherous pawn, you did it! While they are shaking their heads in disbelief, you sweep in with a bishop and up-and-comer knight, then two bishops.[paragraph break]You grow old and fat and wise and powerful enough so nobody has the courage to mention you are too old and fat to ride your super-fast horse. Besides, they don't have the time, because they're always mentioning how powerful you are.";
 			end the story finally saying "The beginning of a glorious (?) empire";
 		else:
-			say "But the blood is traced back to you. Even if it was the royalty that did the work. Somehow, a blood-soaked garment ... you are turned over to an intenational medieval crime court as a sacrifice. Somehow, the royal family convinced everyone you and your crazy-moving horse acted on your own, before they could dissuade you. But everyone in [5b] seems happier to be annexed by [12b]. Or at least nobody has said they aren't, so no sense in returning [5b]'s sovereignty.[paragraph break]Plus, your day of martyry is a national holiday every year.";
+			say "But the blood is traced back to you. Even if it was the royalty that did the work. Somehow, a blood-soaked garment ... you are turned over to an international medieval crime court as a sacrifice. Somehow, the royal family convinced everyone you and your crazy-moving horse acted on your own, before they could dissuade you. But everyone in [5b] seems happier to be annexed by [12b]. Or at least nobody has said they aren't, so no sense in returning [5b]'s sovereignty.[paragraph break]Plus, your day of martyry is a national holiday every year.";
 			end the story finally;
 	if number of circle-visited rooms is random-parchment-number and final-failed-yet is true and parchmente is off-stage:
 		say "[one of]A small parchment flutters into view. It is labeled [parchmente][or][parchmente] flutters into view again[stopping]. It'd be so tempting to read it, and yet, your adventurous spirit has trouble balancing duty to country with the pure personal satisfaction of solving everything on your own.";
@@ -682,6 +684,11 @@ does the player mean calling a reserved piece: it is very likely.

 does the player mean calling the enemy king when friendly king is reserved: it is very unlikely.

+definition: a piece (called p) is accessory:
+	if p is irrelevant, no;
+	if p is enemy king, no;
+	yes;
+
 to setup-next-puzzle:
 	reset-the-board;
 	repeat with P running through pieces:
@@ -694,6 +701,10 @@ to setup-next-puzzle:
 			now preferred-rook is queenside rook;
 		else:
 			now preferred-rook is kingside rook;
+	if quest-index is 4:
+		say "No allies this time.";
+	else:
+		say "So, your quest: you need to coordinate your king with [the list of accessory pieces]. It's also shorthanded in the status line in the upper right."

 max-turns-after-placing is a number that varies.

@@ -724,11 +735,11 @@ to reset-the-board:
 		now random-parchment-number is a random number between 12 and 16;
 		if debug-state is true, say "DEBUG [random-parchment-number].";
 	if past-intro is true:
-		if location of player is not c3:
-			say "You go back to c3 in the center to start again.";
+		say "[if location of player is not c3]You go back to c3 in the center to start again[else]You're already at c3 in the center, so that saves time starting again[end if]. Time to re-summon [the list of accessory pieces].";
 		else:
-			say "You're already at c3 in the center, so that saves time starting again.";
-		move player to c3;
+			say ".";
+		if location of player is not c3:
+			move player to c3;
 	else:
 		now past-intro is true;

@@ -866,6 +877,12 @@ rule for printing a parser error when the latest parser error is the noun did no
 rule for printing a parser error when the latest parser error is the only understood as far as error:
 	say "You only needed the first word of that command. You can use the up arrow and backspace so you don't have to retype."

+report undoing an action:
+	if quest-index is 4:
+		say "Undone. While I can't give any help on whether or not this has made the quest winnable, don't worry. You can restart if you need to.";
+	else:
+		say "Undone[if number of placed pieces is 0], though until you've placed a piece, there's nothing worth undoing[end if]. Note you can always undo everything with [b]F[r] or [b]FAIL[r].";
+
 section inventory trivia

 check taking inventory:
@@ -1251,10 +1268,6 @@ carry out trying:

 volume testing - not for release

-when play begins:
-	say "This should not show up in beta mode. It is a rule to toggle the debug-state truth state.";
-	now debug-state is true;
-
 chapter stupid stuff

 test q1f with "call rook/nnw/call rook/ssw/call king".
commit 2af3e91ef0e141d6cef8c1daa10398faabcf413d
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Mon Jun 28 19:24:17 2021 -0500

    #1 screen reader fixes

diff --git a/story.ni b/story.ni
index 7e315ce..aa8366c 100644
--- a/story.ni
+++ b/story.ni
@@ -47,7 +47,13 @@ to reset-guard: now all rooms are not guarded.

 chapter start of play

+screen-reader is a truth state that varies.
+
 when play begins:
+	say "Fivebyfivia has some text-mapping options that may cause screen-readers to give useless output. Are you using a screen reader?";
+	if the player consents:
+		say "Potentially garbling options are now restricted.";
+		now screen-reader is true;
 	say "Peace treaties get old and boring and stuffy after a while, y'know? They don't exactly keep up with the times. History changes. Perhaps the wimps who got a CLEAR bargain from the peace treaty don't deserve it any more.[paragraph break]That's definitely the case with [5b]. They've had fun for long enough. Besides, [12b] was called Elshapium when the treaty was signed, and now annexing [5b] would just about make a nice new square tidy country, pleasing to look at on a map.[paragraph break]Besides, if [12b] doesn't annex [5b], some far less civilized nation will. It's for their own good. Especially since gold and precious metals were discovered.[paragraph break]Thankfully, the [12b] spy ministry has devised a cunning plan to make sure things go as well as they can for [5b]. And you, a knight with a crazy (and crazy fast) horse, are just the person to help execute it! The old [5b]n king will never suspect you.[paragraph break]A solemn minister hands you a scroll entitled [FIVEBYFIVIA DELENDA EST]. And you're off!";
 	now right hand status line is "[entry quest-index of quest-quick-desc]";

@@ -141,7 +147,7 @@ rule for printing the locale description:
 		now location of player is circle-visited;
 		if show-tour-view is true:
 			show-visited;
-		the rule succeeds;
+			the rule succeeds;
 	say "[room-detail].";
 	continue the action;

@@ -601,11 +607,19 @@ to quest-conclusion:
 		say "The king is dead, cut down in his prime! Long live the young king. Any show of overwhelming force is likely to intimidate him, but etiquette demands he meet with your king -- and perhaps one of your rooks will trail along. You wonder what you can do with that.";
 	else if quest-index is 3:
 		say "The young king is dead! The last of his line. All that remains for you to do is the traditional dance of victory and domination over a weaker country. It is time to walk over each of Fivebyfivia's twenty-five counties without repeating, to show your kingdom's efficiency in both conquering and providing vital constituent services. Okay, mostly conquering.[paragraph break]By the way, there is a new meta-verb. [b]T[r] or [b]TOUR[r] to toggles tour view mode, which shows an overall map of [5b] instead of telling you directions. It is set to on.";
-		now show-tour-view is true;
+		if screen-reader is false, now show-tour-view is true;
 	increment quest-index;
 	setup-next-puzzle;

 to show-the-board:
+	if screen-reader is true:
+		if number of placed pieces is 0:
+			say "You haven't placed any pieces yet.";
+			continue the action;
+		say "Currently placed:";
+		repeat with Q running through placed pieces:
+			say "[Q] is at [location of Q].";
+		continue the action;
 	if in-tutorial is false, say "STRATEGIC MAP OF FIVEBYFIVIA SO FAR:[line break]";
 	say "[fixed letter spacing]  a b c d e[line break]";
 	say "5[pie of a5][pie of b5][pie of c5][pie of d5][pie of e5] 5[line break]";
@@ -1060,7 +1074,27 @@ to say vis of (r - a room):
 	else:
 		say " "

+definition: a room (called r) is circle-to-visit:
+	if r is offsite, no;
+	if r is circle-visited, no;
+	yes;
+
+definition: a room (called r) is safe-knight-movable:
+	if r is circle-visited, no;
+	if r is knight-movable, yes;
+	no;
+
 to show-visited:
+	if screen-reader is true:
+		if number of circle-visited rooms < 13:
+			say "You've visited [list of circle-visited rooms] so far.";
+		else:
+			say "You still need to visit [list of circle-to-visit rooms].";
+		if number of safe-knight-movable rooms > 0:
+			say "Of the above, you can immediately visit [list of safe-knight-movable rooms] from here.";
+		else:
+			say "Sadly, there are no rooms you can safely visit from here.";
+		continue the action;
 	say "VISITED SO FAR:[line break]";
 	say "[fixed letter spacing]  a b c d e[line break]";
 	say "5[vis of a5][vis of b5][vis of c5][vis of d5][vis of e5] 5[line break]";
@@ -1100,6 +1134,7 @@ understand "t" as ting when quest-index is 4.
 understand "tour" as ting when quest-index is 4.

 carry out ting:
+	if screen-reader is true, say "Toggling tour view would cause the screen reader to make strange outputs, so I'm restricting it." instead;
 	now show-tour-view is whether or not show-tour-view is false;
 	say "Tour view is now [on-off of show-tour-view].";
 	the rule succeeds.
@@ -1117,6 +1152,9 @@ understand the command "tut" as something new.
 understand "tut" as tuting.

 carry out tuting:
+	if screen-reader is true:
+		say "(Text maps bowdlerized for screen reader.) For checkmate with a queen and rook, you put a rook on the file next to the queen, then move the queen two right past the rook, then the rook two right past the queen, until the enemy king is up against the side of the board and attacked and cannot move.";
+		the rule succeeds;
 	now in-tutorial is true;
 	now queenside rook is tutorial-held;
 	now queen is tutorial-held;
commit d1053d1d187932ba33e00cf27a958317283d314b
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Mon Jun 28 18:22:27 2021 -0500

    Dee Cooke transcript (1st bit) plus acknowledging Olaf Nowicki

diff --git a/story.ni b/story.ni
index 3e76b09..7e315ce 100644
--- a/story.ni
+++ b/story.ni
@@ -137,8 +137,10 @@ to say room-color:
 	say "The ground is [if the remainder after dividing (x of location of player + y of location of player) by 2 is 0]light[else]dark[end if]er than normal here"

 rule for printing the locale description:
-	if quest-index is 4 and show-tour-view is true:
-		show-visited;
+	if quest-index is 4:
+		now location of player is circle-visited;
+		if show-tour-view is true:
+			show-visited;
 		the rule succeeds;
 	say "[room-detail].";
 	continue the action;
@@ -209,13 +211,14 @@ after printing the locale description when need-to-hurry is true:

 after printing the locale description when quest-index is 1:
 	increment moves-this-quest;
-	if remainder after dividing moves-this-quest by 7 is 0:
+	if remainder after dividing moves-this-quest by 7 is 0 and number of placed pieces is 0:
 		say "You're still looking around for the best square to [b]CALL[r] or [b]PLACE[r] allies. It's worth scouting around, but just so you know, more than one square works for the first piece, and even if you mess up, this quest will reset, and you can retry. It's worth experimenting.[paragraph break]Oh, and if you want to seriously plan things out, every other square is reachable in four moves from the center.";
 	continue the action;

 section circle-visited

 after going to a circle-visited room:
+	show-failure;
 	say "A groan goes up across the land. You've been here before. Your triumphant tour is cut short. [if number of circle-visited cornery rooms > 0]You seemed to get trapped in the corner squares[else if number of circle-visited rooms < 10]Perhaps a bit of planning might help you get more places[else]You wonder if starting from the end -- any end -- might help you find a path through. You note that since c3 is a light square, and you move from light to dark squares and back, you will have to end on a light square after 24 moves--maybe cutting down the possibilities by starting on a less accessible light square would help[end if].";
 	now final-failed-yet is true;
 	say "[line break]";
@@ -366,7 +369,7 @@ to decide which room is room_of (n1 - a number) and (n2 - a number):
 		if x of Q is n1 and y of Q is n2:
 			decide on Q;
 	if debug-state is true:
-		say "Could not find room for [n1] and [n2].";
+		say "(DEBUG) Could not find room for [n1] and [n2].";
 	decide on offsite

 check going a normal direction:
@@ -640,7 +643,6 @@ to decide which number is stalemate-count:
 	decide on temp;

 after printing the locale description when quest-index is 4:
-	now location of player is circle-visited;
 	if debug-state is true:
 		say "(DEBUG) [number of circle-visited rooms] visited, [number of not circle-visited rooms] unvisited.";
 		if number of not circle-visited rooms < 5:
@@ -649,10 +651,11 @@ after printing the locale description when quest-index is 4:
 		say "Horns blare! Voices soar to the sky! You have trampled all of [5b], literally and figuratively! Now is time for your reward!";
 		let t be stalemate-count;
 		if stalemate-count is 3:
-			say "Because of the lack of blood, other nations shake their head at [12b]'s annexation of [5b], but what can they do? Your discretion went above and beyond what the king and queen required of you. They delegate you to plan annexation of west, central and east Twelvebyfouria to the south. Each requires a slightly different solution: first, you take two knights, which people say couldn't be done -- but you did it! While they are shaking their heads in disbelief, you sweep in with a bishop and up-and-comer knight, then two bishops.[paragraph break]You grow old and fat and wise and powerful enough so nobody has the courage to mention you are too old and fat to ride your super-fast horse. Besides, they don't have the time, because they're always mentioning how powerful you are.";
+			say "Because of the lack of blood, other nations shake their head at [12b]'s annexation of [5b], but what can they do? Your discretion went above and beyond what the king and queen required of you. They delegate you to plan annexation of west, central and east Twelvebyfouria to the south. Each requires a slightly different solution: first, you take two knights, which people say couldn't be done -- but with the help of a treacherous pawn, you did it! While they are shaking their heads in disbelief, you sweep in with a bishop and up-and-comer knight, then two bishops.[paragraph break]You grow old and fat and wise and powerful enough so nobody has the courage to mention you are too old and fat to ride your super-fast horse. Besides, they don't have the time, because they're always mentioning how powerful you are.";
+			end the story finally saying "The beginning of a glorious (?) empire";
 		else:
 			say "But the blood is traced back to you. Even if it was the royalty that did the work. Somehow, a blood-soaked garment ... you are turned over to an intenational medieval crime court as a sacrifice. Somehow, the royal family convinced everyone you and your crazy-moving horse acted on your own, before they could dissuade you. But everyone in [5b] seems happier to be annexed by [12b]. Or at least nobody has said they aren't, so no sense in returning [5b]'s sovereignty.[paragraph break]Plus, your day of martyry is a national holiday every year.";
-		end the story;
+			end the story finally;
 	if number of circle-visited rooms is random-parchment-number and final-failed-yet is true and parchmente is off-stage:
 		say "[one of]A small parchment flutters into view. It is labeled [parchmente][or][parchmente] flutters into view again[stopping]. It'd be so tempting to read it, and yet, your adventurous spirit has trouble balancing duty to country with the pure personal satisfaction of solving everything on your own.";
 		move parchmente to location of player;
@@ -705,7 +708,7 @@ to reset-the-board:
 		now all rooms are not circle-visited;
 		now c3 is circle-visited;
 		now random-parchment-number is a random number between 12 and 16;
-		if debug-state is true, say "[random-parchment-number].";
+		if debug-state is true, say "DEBUG [random-parchment-number].";
 	if past-intro is true:
 		if location of player is not c3:
 			say "You go back to c3 in the center to start again.";
@@ -940,7 +943,7 @@ understand the command "credits" as something new.
 understand "credits" as creditsing.

 carry out creditsing:
-	say "Thanks to Wade Clarke and Arthur DiBianca and Garry Francis for testing.";
+	say "Thanks to Wade Clarke, Dee Cooke, Arthur DiBianca, Garry Francis and Olaf Nowicki for testing.";
 	say "[line break]Thanks to chessgames.com, chess.com and lichess.org for all the chess fun and puzzles and opponents from all over the globe. This all was especially nice during the pandemic.";
 	the rule succeeds.

@@ -1018,7 +1021,7 @@ carry out reviewing:
 		if entry x in stalemated is true:
 			say "You stalemated the enemy king with [stalemate-notes entry].";
 		else:
-			say "[checkmate-notes entry].";
+			say "[checkmate-notes entry]";
 	the rule succeeds.

 table of notes
@@ -1188,6 +1191,26 @@ when play begins:
 	now in-beta is true;
 	say "Beta testers have access to the commands TRY (1-4), to work on a particular quest, and WAYS. This text will not appear in the release, but if it does, that's my fault."

+chapter trying
+
+trying is an action applying to one number.
+
+understand the command "try" as something new.
+
+understand "try [number]" as trying.
+
+carry out trying:
+	if number understood < 1 or number understood > 4:
+		say "You need a number between 1 and 4." instead;
+	if quest-index is number understood:
+		say "We're already on that quest, so we won't reset it. Just do it wrong to reset.";
+		the rule succeeds;
+	else:
+		say "Moving to quest [number understood].";
+	now quest-index is number understood;
+	setup-next-puzzle;
+	the rule succeeds.
+
 volume testing - not for release

 when play begins:
@@ -1219,25 +1242,6 @@ test q4 with "nnw/ssw/sse/nee/nne/nww/sww/sse/see/nne/nnw/sww/ssw/see/nee/nnw/sw
 test win1 with "test q1/test q2/test q3/test q4".
 test win2 with "test q1s/test q2s/test q3s/test q4".

-chapter trying
-
-trying is an action applying to one number.
-
-understand the command "try" as something new.
-
-understand "try [number]" as trying.
-
-carry out trying:
-	if number understood < 1 or number understood > 4:
-		say "You need a number between 1 and 4." instead;
-	if quest-index is number understood:
-		say "We're already on that quest.";
-	else:
-		say "Moving to quest [number understood].";
-	now quest-index is number understood;
-	setup-next-puzzle;
-	the rule succeeds.
-
 chapter waysing

 waysing is an action out of world.
commit 2e85e07f19c0ed02115a1bdc08bfc75d9639cf82
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Mon Jun 28 18:18:52 2021 -0500

    fixed #2, also disabled Y/YES

diff --git a/story.ni b/story.ni
index 480660a..3e76b09 100644
--- a/story.ni
+++ b/story.ni
@@ -8,6 +8,8 @@ volume basics and definitions

 include Trivial Niceties by Andrew Schultz.

+include Old School Verb Total Carnage by Andrew Schultz.
+
 in-beta is a truth state that varies.

 debug-state is a truth state that varies.
@@ -32,6 +34,9 @@ after examining a thing (called th):

 got-rook-for-queen is a truth state that varies.

+understand the command "y" as something new. [this is to reject "That was a rhetorical question" before ]
+understand the command "yes" as something new. [this is to reject "That was a rhetorical question" before ]
+
 chapter rooms

 a room can be circle-visited. a room is usually not circle-visited.
commit 669458c358195632b0b10a8f199eb0ef2eaccfb5
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Mon Jun 28 17:57:49 2021 -0500

    FAIL/F verb implemented, #3 fixed

diff --git a/story.ni b/story.ni
index 969190d..480660a 100644
--- a/story.ni
+++ b/story.ni
@@ -955,6 +955,23 @@ carry out dirsing:
 	say "You can toggle how the directions appear (long or short) in room descriptions with [b]ABB[r].";
 	the rule succeeds.

+chapter fail
+
+failing is an action out of world.
+
+understand the command "fail" as something new.
+understand the command "f" as something new.
+
+understand "fail" as failing.
+understand "f" as failing.
+
+carry out failing:
+	if number of placed pieces is 0 and quest-index < 4:
+		say "You haven't placed any pieces yet." instead;
+	say "Okay, let's end things early...";
+	reset-the-board;
+	the rule succeeds;
+
 chapter helping

 helping is an action out of world.
@@ -1134,7 +1151,7 @@ understand "v" as verbsing.

 carry out verbsing:
 	say "The main verbs you can use are about going places. You have 8 different diagonal directions, which you can see in detail with [b]DIRS[r].";
-	say "You can also [b]C[r]/[b]CALL[r] or [b]P[r]/[b]PLACE[r] allies or the [5b]n king. These are all the commands you need to win. [b]X[r] [delenda] for your current quest.";
+	say "You can also [b]C[r]/[b]CALL[r] or [b]P[r]/[b]PLACE[r] allies or the [5b]n king. These are all the commands you need to win. [b]X[r] [delenda] for your current quest. You can also [b]FAIL[r]/[b]F[r] to reset the current quest.";
 	say "[line break]But there are also meta-commands. Of these, [b]M[r] or [b]MAP[r] to see the map at any time is likely to be the most useful. It shows you where your allies are and what they are guarding. [b]B[r] or [b]BOARD[r] also works.";
 	say "General meta-commands include [b]ABOUT[r]/[b]A[r] and [b]CREDITS[r] for general game information and thanks.";
 	say "You also have the option of toggling abbreviations of long directions with [b]ABB[r].";
commit 717d6031deb33efe7135108ae93626feee130ff7
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Sat Jun 26 16:22:39 2021 -0500

    add prospective areas to map

diff --git a/story.ni b/story.ni
index 19e809f..969190d 100644
--- a/story.ni
+++ b/story.ni
@@ -592,7 +592,8 @@ to quest-conclusion:
 	 else if quest-index is 2:
 		say "The king is dead, cut down in his prime! Long live the young king. Any show of overwhelming force is likely to intimidate him, but etiquette demands he meet with your king -- and perhaps one of your rooks will trail along. You wonder what you can do with that.";
 	else if quest-index is 3:
-		say "The young king is dead! The last of his line. All that remains for you to do is the traditional dance of victory and domination over a weaker country. It is time to walk over each of Fivebyfivia's twenty-five counties without repeating, to show your kingdom's efficiency in both conquering and providing vital constituent services. Okay, mostly conquering.[paragraph break]By the way, there is a new meta-verb. You may wish to type [b]T[r] or [b]TOUR[r] to toggle tour view mode.";
+		say "The young king is dead! The last of his line. All that remains for you to do is the traditional dance of victory and domination over a weaker country. It is time to walk over each of Fivebyfivia's twenty-five counties without repeating, to show your kingdom's efficiency in both conquering and providing vital constituent services. Okay, mostly conquering.[paragraph break]By the way, there is a new meta-verb. [b]T[r] or [b]TOUR[r] to toggles tour view mode, which shows an overall map of [5b] instead of telling you directions. It is set to on.";
+		now show-tour-view is true;
 	increment quest-index;
 	setup-next-puzzle;

@@ -648,7 +649,8 @@ after printing the locale description when quest-index is 4:
 			say "But the blood is traced back to you. Even if it was the royalty that did the work. Somehow, a blood-soaked garment ... you are turned over to an intenational medieval crime court as a sacrifice. Somehow, the royal family convinced everyone you and your crazy-moving horse acted on your own, before they could dissuade you. But everyone in [5b] seems happier to be annexed by [12b]. Or at least nobody has said they aren't, so no sense in returning [5b]'s sovereignty.[paragraph break]Plus, your day of martyry is a national holiday every year.";
 		end the story;
 	if number of circle-visited rooms is random-parchment-number and final-failed-yet is true and parchmente is off-stage:
-		say "[one of]A small parchment flutters into view. It is labeled [parchmente][or][parchmente] flutters into view again[stopping]. It'd be so tempting to read it, and yet, your adventurous spirit has trouble balancing duty to country with the pure personal satisfaction of solving everything on your own."
+		say "[one of]A small parchment flutters into view. It is labeled [parchmente][or][parchmente] flutters into view again[stopping]. It'd be so tempting to read it, and yet, your adventurous spirit has trouble balancing duty to country with the pure personal satisfaction of solving everything on your own.";
+		move parchmente to location of player;

 final-failed-yet is a truth state that varies.

@@ -1017,8 +1019,21 @@ understand "stats" as statsing.
 understand "st" as statsing.
 understand "stat" as statsing.

+definition: a room (called r) is knight-movable:
+	repeat with D running through weird directions:
+		if the room D of location of player is r, yes;
+	no;
+
 to say vis of (r - a room):
-	say " [if location of player is r]+[else if r is circle-visited]*[else] [end if]";
+	say " ";
+	if location of player is r:
+		say "+";
+	else if r is circle-visited:
+		say "*";
+	else if quest-index is 4 and r is knight-movable:
+		say "?[no line break]";
+	else:
+		say " "

 to show-visited:
 	say "VISITED SO FAR:[line break]";
@@ -1176,6 +1191,7 @@ test q3s with "sww/call rook/see/call friendly king/nne/sse/call enemy king".

 test a3 with "test q1/test q2/test q3".

+test q4f with "nnw/ssw/sse/nee/nne/nww/sww/sse/see/nne/nnw/sww/ssw/see/nee/nnw/sww/nnw/see/nee/sww".
 test q4 with "nnw/ssw/sse/nee/nne/nww/sww/sse/see/nne/nnw/sww/ssw/see/nee/nnw/sww/nnw/see/nee/ssw/sse/nww/sww".

 test win1 with "test q1/test q2/test q3/test q4".
commit 0ff7931f6d5dda5ae2a75e98b0a392a7a44503ad
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Sat Jun 26 15:44:02 2021 -0500

    parchment initial stuff

diff --git a/story.ni b/story.ni
index 16a3a7c..19e809f 100644
--- a/story.ni
+++ b/story.ni
@@ -123,7 +123,7 @@ a room has text called room-edge-text.

 offsite is a room. x of offsite is -3. y of offsite is -3.

-the description of a room is usually "[room-color]. You're [room-edge-text of the item described] of [5b][commentary].[paragraph break][room-detail].".
+the description of a room is usually "[room-color]. You're [room-edge-text of the item described] of [5b][commentary].".

 to say commentary:
 	let n be number of normal-viable directions;
@@ -131,6 +131,13 @@ to say commentary:
 to say room-color:
 	say "The ground is [if the remainder after dividing (x of location of player + y of location of player) by 2 is 0]light[else]dark[end if]er than normal here"

+rule for printing the locale description:
+	if quest-index is 4 and show-tour-view is true:
+		show-visited;
+		the rule succeeds;
+	say "[room-detail].";
+	continue the action;
+
 to say room-detail:
 	if quest-index is 4:
 		if number of visit-viable directions is 0:
@@ -204,7 +211,9 @@ after printing the locale description when quest-index is 1:
 section circle-visited

 after going to a circle-visited room:
-	say "A groan goes up. You've been here before. Your triumphant tour is cut short. [if number of circle-visited cornery rooms > 0]You seemed to get trapped in the corner squares[else if number of circle-visited rooms < 10]Perhaps a bit of planning might help you get more places[else]You wonder if starting from the end -- any end -- might help you find a path through. You note that since c3 is a light square, and you move from light to dark squares and back, you will have to end on a light square after 24 moves--maybe cutting down the possibilities by starting on a less accessible light square would help[end if].";
+	say "A groan goes up across the land. You've been here before. Your triumphant tour is cut short. [if number of circle-visited cornery rooms > 0]You seemed to get trapped in the corner squares[else if number of circle-visited rooms < 10]Perhaps a bit of planning might help you get more places[else]You wonder if starting from the end -- any end -- might help you find a path through. You note that since c3 is a light square, and you move from light to dark squares and back, you will have to end on a light square after 24 moves--maybe cutting down the possibilities by starting on a less accessible light square would help[end if].";
+	now final-failed-yet is true;
+	say "[line break]";
 	reset-the-board;

 chapter direction info
@@ -486,6 +495,9 @@ definition: a piece (called p) is not-last:
 	if p is reserved, yes;

 rule for supplying a missing noun when calling:
+	if quest-index is 4:
+		say "You're on your own.";
+		reject the player's command;
 	if number of not-last pieces is 1:
 		now noun is a random not-last piece;
 	else if number of reserved pieces is 1:
@@ -580,7 +592,7 @@ to quest-conclusion:
 	 else if quest-index is 2:
 		say "The king is dead, cut down in his prime! Long live the young king. Any show of overwhelming force is likely to intimidate him, but etiquette demands he meet with your king -- and perhaps one of your rooks will trail along. You wonder what you can do with that.";
 	else if quest-index is 3:
-		say "The young king is dead! The last of his line. All that remains for you to do is the traditional dance of victory and domination over a weaker country. It is time to walk over each of Fivebyfivia's twenty-five counties without repeating, to show your kingdom's efficiency in both conquering and providing vital constituent services. Okay, mostly conquering.";
+		say "The young king is dead! The last of his line. All that remains for you to do is the traditional dance of victory and domination over a weaker country. It is time to walk over each of Fivebyfivia's twenty-five counties without repeating, to show your kingdom's efficiency in both conquering and providing vital constituent services. Okay, mostly conquering.[paragraph break]By the way, there is a new meta-verb. You may wish to type [b]T[r] or [b]TOUR[r] to toggle tour view mode.";
 	increment quest-index;
 	setup-next-puzzle;

@@ -633,8 +645,14 @@ after printing the locale description when quest-index is 4:
 		if stalemate-count is 3:
 			say "Because of the lack of blood, other nations shake their head at [12b]'s annexation of [5b], but what can they do? Your discretion went above and beyond what the king and queen required of you. They delegate you to plan annexation of west, central and east Twelvebyfouria to the south. Each requires a slightly different solution: first, you take two knights, which people say couldn't be done -- but you did it! While they are shaking their heads in disbelief, you sweep in with a bishop and up-and-comer knight, then two bishops.[paragraph break]You grow old and fat and wise and powerful enough so nobody has the courage to mention you are too old and fat to ride your super-fast horse. Besides, they don't have the time, because they're always mentioning how powerful you are.";
 		else:
-			say "But the blood is traced back to you. Even if it was the royalty that did the work. Somehow, a blood-soaked garment ... you are turned over to an intenational medieval crime court as a sacrifice. Somehow, the royal family convinced everyone you and your crazy-moving horse acted on its own, before they could dissuade you. But on the bright side, your day of martyry is a national holiday every year.";
+			say "But the blood is traced back to you. Even if it was the royalty that did the work. Somehow, a blood-soaked garment ... you are turned over to an intenational medieval crime court as a sacrifice. Somehow, the royal family convinced everyone you and your crazy-moving horse acted on your own, before they could dissuade you. But everyone in [5b] seems happier to be annexed by [12b]. Or at least nobody has said they aren't, so no sense in returning [5b]'s sovereignty.[paragraph break]Plus, your day of martyry is a national holiday every year.";
 		end the story;
+	if number of circle-visited rooms is random-parchment-number and final-failed-yet is true and parchmente is off-stage:
+		say "[one of]A small parchment flutters into view. It is labeled [parchmente][or][parchmente] flutters into view again[stopping]. It'd be so tempting to read it, and yet, your adventurous spirit has trouble balancing duty to country with the pure personal satisfaction of solving everything on your own."
+
+final-failed-yet is a truth state that varies.
+
+random-parchment-number is a number that varies.

 does the player mean calling a reserved piece: it is very likely.

@@ -676,8 +694,11 @@ to reset-the-board:
 	now current-turns-after-placing is 0;
 	now need-to-hurry is false;
 	if quest-index is 4:
+		now parchmente is off-stage;
 		now all rooms are not circle-visited;
 		now c3 is circle-visited;
+		now random-parchment-number is a random number between 12 and 16;
+		if debug-state is true, say "[random-parchment-number].";
 	if past-intro is true:
 		if location of player is not c3:
 			say "You go back to c3 in the center to start again.";
@@ -767,6 +788,41 @@ definition: a room (called r) is surrounded:
 		no;
 	yes;

+volume clues
+
+YE OLDE HINTE PARCHMENTE is a thing. printed name is "[i]YE OLDE HINTE PARCHMENTE[r]". "[parchmente] has fluttered to the ground here[if parch-take-count > 0]. It looks slightly worse for the wear than before. Perhaps it absorbed a bit of water, so it's not flying around as fast as it used to[end if].".
+
+parch-take-count is a number that varies.
+
+check taking PARCHMENTE:
+	increment parch-take-count;
+	say "[one of]It blows away before you can get close! Well, that's a bit of temptation resisted by default. Perhaps it will fly back into view later[or]This time, you snag the parchment[stopping].";
+	if parch-take-count is 2:
+		now player has PARCHMENTE;
+	the rule succeeds;
+
+description of YE OLDE HINTE PARCHMENTE is "[if player does not have parchmente]It's too far to read. You'll have to TAKE it to read it[else][parchment-tips][end if]."
+
+read-so-far is a number that varies. read-so-far is 1.
+
+this is the theres-more rule:
+	say "There's more. Read it (Y, any other letter is N)?";
+	let Q be the chosen letter;
+	if Q is 89 or Q is 115, the rule succeeds;
+	the rule fails;
+
+to say parchment-tips:
+	say "1. Ye must save the CORNER SQUARES for last.";
+	if read-so-far < 2:
+		consider the theres-more rule;
+		unless the rule succeeded, continue the action;
+		now read-so-far is 3;
+	say "2. Ye have but one route to and from each CORNER SQUARE.";
+	if read-so-far < 3:
+		consider the theres-more rule;
+		unless the rule succeeded, continue the action;
+	say "3. If ye avoid such squares, you may soon find the next move is FORCED, saving thee considerable brain work."
+
 volume regular verbs to reject

 check pushing: say "You're not some boring old woodpusher who sits crouched over a board for hours on end. Besides, your allies can push themselves well enough. They're motivated enough." instead;
@@ -789,7 +845,7 @@ rule for printing a parser error when the latest parser error is the only unders
 section inventory trivia

 check taking inventory:
-	say "You don't have much on you other than [delenda]. Your horse is built for speed and not for hauling stuff.[paragraph break][if delenda is not examined]You probably want to [b]X[r] [delenda][else]If you need a refresher, no shame in trying to [b]X[r] [delenda] again." instead;
+	say "You don't have much on you other than [delenda]. Your horse is built for speed and not for hauling stuff.[paragraph break][if delenda is not examined]You probably want to [b]X[r] [delenda][else]If you need a refresher, no shame in trying to [b]X[r] [delenda] again[end if]." instead;

 section score trivia

@@ -844,7 +900,7 @@ understand "map" as boarding.
 understand "m" as boarding.

 carry out boarding:
-	if quest-index is 4, try statsing instead;
+	if quest-index is 4, show-visited instead;
 	show-the-board;
 	the rule succeeds.

@@ -964,17 +1020,20 @@ understand "stat" as statsing.
 to say vis of (r - a room):
 	say " [if location of player is r]+[else if r is circle-visited]*[else] [end if]";

+to show-visited:
+	say "VISITED SO FAR:[line break]";
+	say "[fixed letter spacing]  a b c d e[line break]";
+	say "5[vis of a5][vis of b5][vis of c5][vis of d5][vis of e5] 5[line break]";
+	say "4[vis of a4][vis of b4][vis of c4][vis of d4][vis of e4] 4[line break]";
+	say "3[vis of a3][vis of b3][vis of c3][vis of d3][vis of e3] 3[line break]";
+	say "2[vis of a2][vis of b2][vis of c2][vis of d2][vis of e2] 2[line break]";
+	say "1[vis of a1][vis of b1][vis of c1][vis of d1][vis of e1] 1[line break]";
+	say "  a b c d e[variable letter spacing][line break]";
+	say "You've visited [number of circle-visited rooms] of [5b]'s twenty-five precincts.";
+
 carry out statsing:
 	if quest-index is 4:
-		say "VISITED SO FAR:[line break]";
-		say "[fixed letter spacing]  a b c d e[line break]";
-		say "5[vis of a5][vis of b5][vis of c5][vis of d5][vis of e5] 5[line break]";
-		say "4[vis of a4][vis of b4][vis of c4][vis of d4][vis of e4] 4[line break]";
-		say "3[vis of a3][vis of b3][vis of c3][vis of d3][vis of e3] 3[line break]";
-		say "2[vis of a2][vis of b2][vis of c2][vis of d2][vis of e2] 2[line break]";
-		say "1[vis of a1][vis of b1][vis of c1][vis of d1][vis of e1] 1[line break]";
-		say "  a b c d e[variable letter spacing][line break]";
-		say "You've visited [number of circle-visited rooms] of [5b]'s twenty-five precincts.";
+		show-visited;
 	else:
 		say "Reserved pieces to (C)all: [list of reserved pieces].";
 		say "Pieces out on the board: [list of placed pieces].";
@@ -990,6 +1049,23 @@ after printing the name of a reserved piece (called p) when statsing:
 	say " ([b][short-text of p][r])";
 	continue the action;

+chapter ting
+
+ting is an action applying to nothing.
+
+understand the command "t" as something new.
+understand the command "tour" as something new.
+
+understand "t" as ting when quest-index is 4.
+understand "tour" as ting when quest-index is 4.
+
+carry out ting:
+	now show-tour-view is whether or not show-tour-view is false;
+	say "Tour view is now [on-off of show-tour-view].";
+	the rule succeeds.
+
+show-tour-view is a truth state that varies.
+
 chapter tuting

 in-tutorial is a truth state that varies.
@@ -1050,8 +1126,10 @@ carry out verbsing:
 	say "If you want a rules refresher, [b]CHESS[r] or [b]CH[r] will teach you all you need to know. Don't worry--you won't be quizzed on en passant!";
 	if quest-index > 1:
 		say "You can also [b]REVIEW[r] or [b]R[r] what you've done so far, though that's more for general chess endgame knowledge.";
-	else:
+	else if quest-index < 4:
 		say "[b]TUT[r] provides a tutorial on how pieces move and how a queen and rook can trap the king, which may help you.";
+	else:
+		say "[b]T[r] toggles tour view for the quest between printing directions and printing a map.";
 	say "And of course, there's this command, too: [b]VERBS[r]/[b]VERB[r]/[b]V[r].";
 	say "[line break]While this is more nouns than vertbs, note you can often use abbreviations for nouns, e.g. [b]CALL Q[r] for the queen or [b]CALL KR[r] for the kingside rook or [b]CALL K[r] for the king.";
 	the rule succeeds.
@@ -1071,7 +1149,7 @@ volume beta testing - not for release

 when play begins:
 	now in-beta is true;
-	say "This is just a check for myself that this is, indeed, the beta version. It won't appear in the release. There may not actually be anything special in the Beta. But it is still there,";
+	say "Beta testers have access to the commands TRY (1-4), to work on a particular quest, and WAYS. This text will not appear in the release, but if it does, that's my fault."

 volume testing - not for release

commit 6cd1635dc058d64080cb0693838abebc0ac7e7d9
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Sat Jun 26 14:22:21 2021 -0500

    AdB transcript 2

diff --git a/story.ni b/story.ni
index bf9a4c2..16a3a7c 100644
--- a/story.ni
+++ b/story.ni
@@ -123,23 +123,49 @@ a room has text called room-edge-text.

 offsite is a room. x of offsite is -3. y of offsite is -3.

-the description of a room is usually "[room-color]. You're [room-edge-text of the item described] of [5b].[paragraph break][room-detail].".
+the description of a room is usually "[room-color]. You're [room-edge-text of the item described] of [5b][commentary].[paragraph break][room-detail].".
+
+to say commentary:
+	let n be number of normal-viable directions;

 to say room-color:
 	say "The ground is [if the remainder after dividing (x of location of player + y of location of player) by 2 is 0]light[else]dark[end if]er than normal here"

 to say room-detail:
+	if quest-index is 4:
+		if number of visit-viable directions is 0:
+			say "Unfortunately, you can't go anywhere new, so you can just go [list of visit-nonviable directions] and try again";
+		else if number of visit-nonviable directions is 0:
+			say "Any direction of [list of visit-viable directions] leads somewhere new";
+		else:
+			say "While going [list of visit-viable directions] would lead somewhere new, going [list of visit-nonviable directions] would not";
+		continue the action;
 	if location of player is c3:
 		say "From here, your horse can bolt in any of the eight crazy directions it likes to zoom off. Hooray, freedom! Well, for you, not for [5b]";
 		continue the action;
-	say "You can go [list of viable directions][if number of placed pieces is 0] to search for the best place to CALL your first allies[end if]";
+	say "You can go [list of weird-viable directions][if number of placed pieces is 0 and quest-index < 4] to search for the best place to CALL your first allies[end if]";

 definition: a direction (called d) is viable:
-	if d is normal, no;
 	if the room d of location of player is offsite, no;
 	if the room d of location of player is nowhere, no;
 	yes;

+definition: a direction (called d) is weird-viable:
+	if d is weird and d is viable, yes;
+	no;
+
+definition: a direction (called d) is visit-viable:
+	if d is weird and the room d of location of player is not circle-visited, yes;
+	no;
+
+definition: a direction (called d) is visit-nonviable:
+	if d is weird and the room d of location of player is circle-visited, yes;
+	no;
+
+definition: a direction (called d) is normal-viable:
+	if d is normal and d is viable, yes;
+	no;
+
 section going nowhere

 check going nowhere:
@@ -166,7 +192,7 @@ after printing the locale description when need-to-hurry is true:
 		else:
 			say "You hear familiar moans. Your summoned compatriot[if number of placed pieces > 1]s have[else] has[end if] grown impatient. The whole operation was based on stealth, which you did not have this time.";
 		say "[line break]You did not succeed in your quest, and your king and queen will not be pleased ... unless we pretend this was just a practice run you planned in your head before the real thing. Yes, yes, let's do that. That's how it is.";
-		reset-the-board;
+		fail-and-reset;
 	continue the action;

 after printing the locale description when quest-index is 1:
@@ -178,7 +204,7 @@ after printing the locale description when quest-index is 1:
 section circle-visited

 after going to a circle-visited room:
-	say "A groan goes up. You've been here before. Your triumphant tour is cut short.";
+	say "A groan goes up. You've been here before. Your triumphant tour is cut short. [if number of circle-visited cornery rooms > 0]You seemed to get trapped in the corner squares[else if number of circle-visited rooms < 10]Perhaps a bit of planning might help you get more places[else]You wonder if starting from the end -- any end -- might help you find a path through. You note that since c3 is a light square, and you move from light to dark squares and back, you will have to end on a light square after 24 moves--maybe cutting down the possibilities by starting on a less accessible light square would help[end if].";
 	reset-the-board;

 chapter direction info
@@ -255,9 +281,18 @@ xness of north is 0. yness of north is 1. xness of south is 0. yness of south is

 volume rooms

+to decide which number is edge-count of (r - a room):
+	let temp be 0;
+	if x of r is 4 or y of r is 4, increment temp;
+	if x of r is 0 or y of r is 0, increment temp;
+	decide on temp;
+
 definition: a room (called r) is edgy:
-	if x of r is 4 or y of r is 4, yes;
-	if x of r is 0 or y of r is 0, yes;
+	if edge-count of r > 0, yes;
+	no;
+
+definition: a room (called r) is cornery:
+	if edge-count of r is 2, yes;
 	no;

 a1 is a room. x of a1 is 0. y of a1 is 0. room-edge-text is "at the relatively inaccessible southwest corner".
@@ -397,11 +432,11 @@ definition: a piece (called p) is offensive:
 	if p is irrelevant, no;
 	yes;

-the friendly king is a piece. understand "k" and "k1" and "fk" as friendly king. short-text of friendly king is "K".
+the friendly king is a piece. understand "k" and "k1" and "fk" as friendly king. short-text of friendly king is "K". understand "my king" as friendly king.

 summon-list of friendly king is { false, true, true, false }.

-the enemy king is a piece. understand "k" and "k2" and "ek" as enemy king. short-text of enemy king is "K".
+the enemy king is a piece. understand "k" and "k2" and "ek" as enemy king. short-text of enemy king is "K". understand "their king" as enemy king.

 summon-list of enemy king is { true, true, true, false }.

@@ -478,7 +513,7 @@ carry out calling:
 	if noun is irrelevant:
 		say "Right now [the noun] is not part of your maneuver." instead;
 	if number of pieces in location of player > 0:
-		say "That would make things too crowded here. You already called [the random piece in location of player] here." instead;
+		say "That would make things too crowded here at [location of player], since [the random piece in location of player] is already present." instead;
 	if noun is enemy king:
 		abide by the enemy-placement rule;
 	say "You call [the noun] to [location of player].";
@@ -490,7 +525,8 @@ carry out calling:
 	if number of reserved pieces > 0, the rule succeeds;
 	consider the takeit processing rule;
 	if the rule succeeded:
-		reset-the-board instead;
+		fail-and-reset instead;
+		reset-the-board;
 	consider the stalemate processing rule;
 	if the rule succeeded:
 		quest-conclusion;
@@ -499,7 +535,7 @@ carry out calling:
 	if the rule failed:
 		if location of enemy king is not edgy:
 			say "The enemy king had a lot of places to run. Maybe you should've summoned him to an edge, instead.";
-		reset-the-board instead;
+		fail-and-reset instead;
 	if the rule succeeded:
 		quest-conclusion;
 	the rule succeeds.
@@ -616,7 +652,6 @@ to setup-next-puzzle:
 			now preferred-rook is queenside rook;
 		else:
 			now preferred-rook is kingside rook;
-		say "[preferred-rook].";

 max-turns-after-placing is a number that varies.

@@ -624,6 +659,15 @@ current-turns-after-placing is a number that varies.

 need-to-hurry is a truth state that varies.

+to show-failure:
+	say "[line break]        [b]* * * * LET'S TRY AGAIN * * * *[r][paragraph break]";
+
+to fail-and-reset:
+	show-failure;
+	reset-the-board;
+
+past-intro is a truth state that varies.
+
 to reset-the-board:
 	now all pieces are off-stage;
 	now all placed pieces are reserved;
@@ -631,11 +675,17 @@ to reset-the-board:
 	now max-turns-after-placing is entry quest-index of max-wait-times;
 	now current-turns-after-placing is 0;
 	now need-to-hurry is false;
-	if location of player is not c3:
-		move player to c3;
 	if quest-index is 4:
 		now all rooms are not circle-visited;
 		now c3 is circle-visited;
+	if past-intro is true:
+		if location of player is not c3:
+			say "You go back to c3 in the center to start again.";
+		else:
+			say "You're already at c3 in the center, so that saves time starting again.";
+		move player to c3;
+	else:
+		now past-intro is true;

 this is the takeit processing rule:
 	let ek be the location of the enemy king;
@@ -1031,16 +1081,23 @@ when play begins:

 chapter stupid stuff

+test q1f with "call rook/nnw/call rook/ssw/call king".
 test q1 with "ssw/nnw/see/see/call kingside/nww/call queenside/sww/call king".
 test q1s with "nnw/call kingside/ssw/see/call queenside/sww/call king".

+test q2f with "call queen/nnw/call king/ssw/call king".
 test q2n with "ssw/nee/call queen/sww/nne/call king/sse/call king".
 test q2 with "sse/call queen/nnw/ssw/nnw/call friendly king/sse/call enemy king".
 test q2s with "nne/call friendly king/sww/sse/call queen/sww/call king".

+test a2 with "test q1/test q2".
+
+test q3f with "call rook/nnw/call king/ssw/call king".
 test q3 with "sww/see/call rook/nnw/call friendly king/ssw/call enemy king".
 test q3s with "sww/call rook/see/call friendly king/nne/sse/call enemy king".

+test a3 with "test q1/test q2/test q3".
+
 test q4 with "nnw/ssw/sse/nee/nne/nww/sww/sse/see/nne/nnw/sww/ssw/see/nee/nnw/sww/nnw/see/nee/ssw/sse/nww/sww".

 test win1 with "test q1/test q2/test q3/test q4".
diff --git a/walkthrough.txt b/walkthrough.txt
index 3e6510d..f053996 100644
--- a/walkthrough.txt
+++ b/walkthrough.txt
@@ -59,7 +59,23 @@ But this is the one that you want:
 |Q| |k| | |
 +-+-+-+-+-+

-Note that this could also have each piece shifted over one column.
+Note that this could also have each piece shifted to the right one column, but the more visible mate, with just your king shifted left, would not be possible with your knight moves.
+
+Note that you get an extra move for King and Queen vs. King, because you need the special alternate solution.
+
+King and rook vs king is trickier. The only way to get him in the corner with three moves is as follows. It is one of the rejected mates above for the queen -- the one they want to save for later, for a surprise.
+
++-+-+-+-+-+
+| | | | | |
++-+-+-+-+-+
+| | | | | |
++-+-+-+-+-+
+| | | |K| |
++-+-+-+-+-+
+| | | | | |
++-+-+-+-+-+
+| | |R| |k|
++-+-+-+-+-+

 The final quest is a traversal. You need to touch all the squares without going over one twice. This seems like there are so many possibilities, but process of elimination helps.

commit 1e14883080b43468941d41703a891a26125da31b
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Thu Jun 24 12:48:50 2021 -0500

    tutorial implemented fully

diff --git a/story.ni b/story.ni
index 67ac40b..bf9a4c2 100644
--- a/story.ni
+++ b/story.ni
@@ -255,6 +255,11 @@ xness of north is 0. yness of north is 1. xness of south is 0. yness of south is

 volume rooms

+definition: a room (called r) is edgy:
+	if x of r is 4 or y of r is 4, yes;
+	if x of r is 0 or y of r is 0, yes;
+	no;
+
 a1 is a room. x of a1 is 0. y of a1 is 0. room-edge-text is "at the relatively inaccessible southwest corner".

 b1 is a room. x of b1 is 1. y of b1 is 0. room-edge-text is "on the south edge and near the west edge".
@@ -491,20 +496,23 @@ carry out calling:
 		quest-conclusion;
 		the rule succeeds;
 	consider the checkmate processing rule;
-	if the rule failed, reset-the-board instead;
+	if the rule failed:
+		if location of enemy king is not edgy:
+			say "The enemy king had a lot of places to run. Maybe you should've summoned him to an edge, instead.";
+		reset-the-board instead;
 	if the rule succeeded:
 		quest-conclusion;
 	the rule succeeds.

 to update-guarded:
 	now all rooms are not guarded;
-	if friendly king is placed:
+	if friendly king is placed and in-tutorial is false:
 		place-king;
-	if queenside rook is placed:
+	if queenside rook is placed or in-tutorial is true:
 		place-range queenside rook and list of all cardinal directions;
-	if kingside rook is placed:
+	if kingside rook is placed and in-tutorial is false:
 		place-range kingside rook and list of all cardinal directions;
-	if queen is placed:
+	if queen is placed or in-tutorial is true:
 		place-range queen and list of all planar directions;

 to place-range (p - a piece) and (myl - a list of directions):
@@ -541,7 +549,7 @@ to quest-conclusion:
 	setup-next-puzzle;

 to show-the-board:
-	say "STRATEGIC MAP OF FIVEBYFIVIA SO FAR:[line break]";
+	if in-tutorial is false, say "STRATEGIC MAP OF FIVEBYFIVIA SO FAR:[line break]";
 	say "[fixed letter spacing]  a b c d e[line break]";
 	say "5[pie of a5][pie of b5][pie of c5][pie of d5][pie of e5] 5[line break]";
 	say "4[pie of a4][pie of b4][pie of c4][pie of d4][pie of e4] 4[line break]";
@@ -549,7 +557,10 @@ to show-the-board:
 	say "2[pie of a2][pie of b2][pie of c2][pie of d2][pie of e2] 2[line break]";
 	say "1[pie of a1][pie of b1][pie of c1][pie of d1][pie of e1] 1[line break]";
 	say "  a b c d e[variable letter spacing][paragraph break]";
-	say "* = you, + = square is guarded[if friendly king is not irrelevant], K = your king[end if][if queenside rook is not irrelevant or kingside rook is not irrelevant], R = rook[end if][if queen is not irrelevant], Q = queen[end if], k = enemy king.";
+	if in-tutorial is true:
+		say "Q = queen, R = queenside rook, k = enemy king, + = guarded square.";
+		continue the action;
+	say "[if in-tutorial is false]* = you, [end if]+ = square is guarded[if friendly king is not irrelevant], K = your king[end if][if queenside rook is not irrelevant or kingside rook is not irrelevant], R = rook[end if][if queen is not irrelevant], Q = queen[end if], k = enemy king.";

 to say pie of (r - a room):
 	say " ";
@@ -850,6 +861,8 @@ understand "h" as helping.

 carry out helping:
 	say "This game should come with a walkthrough. However, if you need a refresher on your quest, simply [b]X[r] [delenda] or just [b]X[r]. It's a bit short on details -- of course it is! Royalty tends to delegate like that.";
+	if quest-index is 1:
+		say "[line break]There is, however, the option for help with [b]TUT[r] for the first quest.";
 	the rule succeeds.

 chapter reviewing
@@ -944,21 +957,27 @@ carry out tuting:
 	repeat with X running through pieces:
 		now cached-position of X is location of X;
 		move X to offsite;
+	let my-row be 0;
 	repeat through table of tutorial stuff:
+		increment my-row;
 		move queen to queen-pos entry;
 		move queenside rook to rook-pos entry;
 		move enemy king to king-pos entry;
 		update-guarded;
-		say "[blather entry]";
+		show-the-board;
+		say "[blather entry][line break]";
+		say "Type any key to continue[if my-row < 4] or Q to quit[end if].";
+		let Q be the chosen letter;
+		if Q is 81 or Q is 113, the rule succeeds;
 	now in-tutorial is false;
 	the rule succeeds.

 table of tutorial stuff
 queen-pos	rook-pos	king-pos	blather
-a5	b4	b1	"Blather."
-c5	b4	c1	"Blather."
-c5	d4	d1	"Blather."
-e5	d4	e1	"Blather."
+a5	b4	b1	"Here the rook attacks the king, who has to move to the c-file."
+c5	b4	c1	"Here the rook attacks the king, who has to move to the d-file."
+c5	d4	d1	"Again the rook attacks the king, who has to move to the e-file."
+e5	d4	e1	"The enemy king is trapped, since it can't move over. Maybe you can do the same with [if quest-index is 1]the two rooks[else]less material, but with the idea of pushing the enemy king against the edge."

 chapter verbsing

@@ -979,7 +998,10 @@ carry out verbsing:
 	say "General meta-commands include [b]ABOUT[r]/[b]A[r] and [b]CREDITS[r] for general game information and thanks.";
 	say "You also have the option of toggling abbreviations of long directions with [b]ABB[r].";
 	say "If you want a rules refresher, [b]CHESS[r] or [b]CH[r] will teach you all you need to know. Don't worry--you won't be quizzed on en passant!";
-	if quest-index > 1, say "You can also [b]REVIEW[r] or [b]R[r] what you've done so far, though that's more for general chess endgame knowledge.";
+	if quest-index > 1:
+		say "You can also [b]REVIEW[r] or [b]R[r] what you've done so far, though that's more for general chess endgame knowledge.";
+	else:
+		say "[b]TUT[r] provides a tutorial on how pieces move and how a queen and rook can trap the king, which may help you.";
 	say "And of course, there's this command, too: [b]VERBS[r]/[b]VERB[r]/[b]V[r].";
 	say "[line break]While this is more nouns than vertbs, note you can often use abbreviations for nouns, e.g. [b]CALL Q[r] for the queen or [b]CALL KR[r] for the kingside rook or [b]CALL K[r] for the king.";
 	the rule succeeds.
commit 999635a56a7fc010b35e5600a13b43cd60697c5c
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Thu Jun 24 12:19:07 2021 -0500

    first swipe at tutorial

diff --git a/story.ni b/story.ni
index b660e10..67ac40b 100644
--- a/story.ni
+++ b/story.ni
@@ -53,12 +53,13 @@ FIVEBYFIVIA DELENDA EST is a thing. the player carries FIVEBYFIVIA DELENDA EST.
 printed name of DELENDA is "[i]FIVEBYFIVIA DELENDA EST[r]".

 understand "fde" as DELENDA.
+understand "dfe" as DELENDA.
 understand "est" as DELENDA.
 understand "del" as DELENDA.
 understand "scroll" as DELENDA.

 after examining DELENDA for the first time:
-	say "You may wish to shorten typing [delenda]'s long name to [b]DFE[r], [b]EST[r], or [b]DEL[r]. Or you can just type [b]X[r]. You're an ambitious knight, not some boring old scribe who shows off writing fancy words out. You have much more exciting ways to show off!"
+	say "You may wish to shorten typing [delenda]'s long name to [b]FDE[r], [b]EST[r], or [b]DEL[r]. Or you can just type [b]X[r]. You're an ambitious knight, not some boring old scribe who shows off writing fancy words out. You have much more exciting ways to show off!"

 to say current-quest-text:
 	if quest-index is 4:
@@ -371,7 +372,11 @@ quest-quick-desc is a list of text variable. quest-quick-desc is { "R & R", "K &

 chapter pieces

-a piece is a kind of person. a piece can be reserved, irrelevant, or placed. a piece is usually irrelevant. a piece has a list of truth state called summon-list. a piece has text called short-text.
+a piece is a kind of person. a piece can be reserved, irrelevant or placed. a piece is usually irrelevant. a piece has a list of truth state called summon-list. a piece has text called short-text.
+
+a piece has a room called cached-position.
+
+a piece can be tutorial-held. a piece is usually not tutorial-held.

 description of a piece is usually "Right now, [the item described] looks ready to go chase an enemy king. But they may not wait too long. Better [if number of reserved pieces is 1]call your other allies and then [end if]call the enemy king soon."

@@ -811,7 +816,7 @@ understand the command "credits" as something new.
 understand "credits" as creditsing.

 carry out creditsing:
-	say "Thanks to Wade Clarke and Arthur DiBianca for testing.";
+	say "Thanks to Wade Clarke and Arthur DiBianca and Garry Francis for testing.";
 	say "[line break]Thanks to chessgames.com, chess.com and lichess.org for all the chess fun and puzzles and opponents from all over the globe. This all was especially nice during the pandemic.";
 	the rule succeeds.

@@ -863,9 +868,10 @@ understand "r" as reviewing.

 carry out reviewing:
 	if quest-index is 1, say "Nothing to review yet." instead;
-	say "Here's what you've got so far:[paragraph break]";
+	say "Here's what you've got so far:[line break]";
 	repeat with x running from 1 to quest-index - 1:
 		choose row x in table of notes;
+		say "[line break]";
 		if entry x in stalemated is true:
 			say "You stalemated the enemy king with [stalemate-notes entry].";
 		else:
@@ -874,7 +880,7 @@ carry out reviewing:

 table of notes
 stalemate-notes	checkmate-notes
-"two rooks--in practical play, the most likely stalemate is one rook being diagonal from the corner, guarded by the other rook"	"You pinned the enemy king into the corner using the two rooks: one covering the side, one covering the row/column next to it. The process of cornering a king is known as a rook roll--the rooks start at . Once you learn it, you're never gonna give it up."
+"two rooks--in practical play, the most likely stalemate is one rook being diagonal from the corner, guarded by the other rook"	"You pinned the enemy king into the corner using the two rooks: one covering the side, one covering the row/column next to it. The process of cornering a king is known as a rook roll--the rooks start in adjacent rows, then one moves two over across the other, and so forth to the edge. Once you learn it, you're never gonna give it up."
 "king and queen--there are so many ways to do this! The queen can force the king in the corner, or you don't move the king the right way"	"You trapped the enemy king with a queen and king. In practical play, the queen alone can drive the enemy king into the corner where he only has two squares to move, then your king walks in. Your queen just sits three squares up and one square left (or some rotation/mirroring) from the corner."
 "king and rook--in practical play you probably won't see the position you got, and the only likely way is to have the rook, guarded by a king, diagonal from the corner"	"You trapped the king in the corner with your own king and rook. It's possible to trap the king on the side--your king is two squares away, off the edge, and the rook gives check. It's trickier for the king and rook to corner an enemy king, though. You have to make semi-waiting moves to slowly make the enemy king's rectangle smaller and smaller."

@@ -921,6 +927,39 @@ after printing the name of a reserved piece (called p) when statsing:
 	say " ([b][short-text of p][r])";
 	continue the action;

+chapter tuting
+
+in-tutorial is a truth state that varies.
+
+tuting is an action applying to nothing.
+
+understand the command "tut" as something new.
+
+understand "tut" as tuting.
+
+carry out tuting:
+	now in-tutorial is true;
+	now queenside rook is tutorial-held;
+	now queen is tutorial-held;
+	repeat with X running through pieces:
+		now cached-position of X is location of X;
+		move X to offsite;
+	repeat through table of tutorial stuff:
+		move queen to queen-pos entry;
+		move queenside rook to rook-pos entry;
+		move enemy king to king-pos entry;
+		update-guarded;
+		say "[blather entry]";
+	now in-tutorial is false;
+	the rule succeeds.
+
+table of tutorial stuff
+queen-pos	rook-pos	king-pos	blather
+a5	b4	b1	"Blather."
+c5	b4	c1	"Blather."
+c5	d4	d1	"Blather."
+e5	d4	e1	"Blather."
+
 chapter verbsing

 verbsing is an action out of world.
@@ -938,7 +977,7 @@ carry out verbsing:
 	say "You can also [b]C[r]/[b]CALL[r] or [b]P[r]/[b]PLACE[r] allies or the [5b]n king. These are all the commands you need to win. [b]X[r] [delenda] for your current quest.";
 	say "[line break]But there are also meta-commands. Of these, [b]M[r] or [b]MAP[r] to see the map at any time is likely to be the most useful. It shows you where your allies are and what they are guarding. [b]B[r] or [b]BOARD[r] also works.";
 	say "General meta-commands include [b]ABOUT[r]/[b]A[r] and [b]CREDITS[r] for general game information and thanks.";
-	say "You also have the option of toggling abbrevation of long directions with [b]ABB[r].";
+	say "You also have the option of toggling abbreviations of long directions with [b]ABB[r].";
 	say "If you want a rules refresher, [b]CHESS[r] or [b]CH[r] will teach you all you need to know. Don't worry--you won't be quizzed on en passant!";
 	if quest-index > 1, say "You can also [b]REVIEW[r] or [b]R[r] what you've done so far, though that's more for general chess endgame knowledge.";
 	say "And of course, there's this command, too: [b]VERBS[r]/[b]VERB[r]/[b]V[r].";
commit 7c9524ea3bf329a0a422764d0f81c8a641d33b76
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Tue Jun 22 19:50:43 2021 -0500

    moved BOARD verb to release

diff --git a/story.ni b/story.ni
index ee681af..b660e10 100644
--- a/story.ni
+++ b/story.ni
@@ -763,6 +763,25 @@ carry out abouting:
 	say "This game was originally written for ParserComp 2021.[paragraph break]I'd always sort of had an idea to write up a game about chess, especially after playing Zork Zero, but I never quite found one that could be simple enough for people who didn't play and worthwhile enough for those who did. And even if it did balance these, where was the story?[paragraph break]I wasn't expecting one to pop up. The resurgence of chess online with COVID, along with tournaments like PogChamps, reminded me that there was a lot more to chess than twenty-move-deep theoretical slogs.[paragraph break]But one evening, something came into form. And as ParserComp's deadline came up, my bigger plan had stalled, so why not bail out?[paragraph break]I like parser games with weird directions. So I tried to make one.[paragraph break]Thankfully, I was able to find something that worked, technically, and it had the shell of a story, too. And I hope you enjoy this, too, whether or not you play chess.";
 	the rule succeeds.

+chapter boarding
+
+boarding is an action applying to nothing.
+
+understand the command "board" as something new.
+understand the command "b" as something new.
+understand the command "map" as something new.
+understand the command "m" as something new.
+
+understand "board" as boarding.
+understand "b" as boarding.
+understand "map" as boarding.
+understand "m" as boarding.
+
+carry out boarding:
+	if quest-index is 4, try statsing instead;
+	show-the-board;
+	the rule succeeds.
+
 chapter chessing

 chessing is an action out of world.
@@ -941,26 +960,7 @@ volume beta testing - not for release

 when play begins:
 	now in-beta is true;
-	say "This is just a check for myself that this is, indeed, the beta version. It won't appear in the release.";
-
-chapter boarding
-
-boarding is an action applying to nothing.
-
-understand the command "board" as something new.
-understand the command "b" as something new.
-understand the command "map" as something new.
-understand the command "m" as something new.
-
-understand "board" as boarding.
-understand "b" as boarding.
-understand "map" as boarding.
-understand "m" as boarding.
-
-carry out boarding:
-	if quest-index is 4, try statsing instead;
-	show-the-board;
-	the rule succeeds.
+	say "This is just a check for myself that this is, indeed, the beta version. It won't appear in the release. There may not actually be anything special in the Beta. But it is still there,";

 volume testing - not for release

commit 9cc5d4536bae93751d7004be1fd2884bc48c9586
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Tue Jun 22 19:05:07 2021 -0500

    more tweaks plus move-by-move walkthrough

diff --git a/story.ni b/story.ni
index 091f480..ee681af 100644
--- a/story.ni
+++ b/story.ni
@@ -171,7 +171,7 @@ after printing the locale description when need-to-hurry is true:
 after printing the locale description when quest-index is 1:
 	increment moves-this-quest;
 	if remainder after dividing moves-this-quest by 7 is 0:
-		say "You're still looking around for the best square to [b]CALL[r] or [b]PLACE[r] allies. It's worth scouting around, but just so you know, more than one square works for the first piece, and even if you mess up, this quest will reset, and you can retry. It's worth experimenting.";
+		say "You're still looking around for the best square to [b]CALL[r] or [b]PLACE[r] allies. It's worth scouting around, but just so you know, more than one square works for the first piece, and even if you mess up, this quest will reset, and you can retry. It's worth experimenting.[paragraph break]Oh, and if you want to seriously plan things out, every other square is reachable in four moves from the center.";
 	continue the action;

 section circle-visited
@@ -653,7 +653,7 @@ this is the checkmate processing rule:
 		let qx be absval of (x of location of queen - x of location of enemy king);
 		let qy be absval of (y of location of queen - y of location of enemy king);
 		if qx < 2 and qy < 2:
-			say "Alas, a kink in your plans! The queen refuses, REFUSES to get close to that horrid enemy king. You thought you had things planned out well, but--well, maybe there is another way to get people together. But not too close.";
+			say "Alas, a kink in your plans! The queen refuses, REFUSES to get close to that horrid enemy king. You thought you had things planned out well, but--well, maybe there is another way to get people together. But not too close. Perhaps using your horse's quick movements will help find a properly spacious arrangement.";
 			the rule fails;
 		if location of enemy king is cornery:
 			say "Before you can summon the enemy king over, though, your allies call you by. That's a good formation, but maybe you will use it better in the future. It won't be a surprise if you use it twice. You take notes.";
diff --git a/walkthrough.txt b/walkthrough.txt
index 2388486..3e6510d 100644
--- a/walkthrough.txt
+++ b/walkthrough.txt
@@ -1,4 +1,8 @@
-The solution is not meant to be hard. However, non-chessplayers may find some trickery. Note that you also have to be reasonably quick about checkmating your opponent. You only have three turns from placing the first piece to placing the opponent's king.
+The solution is not meant to be hard. However, non-chessplayers may find things tricky. Note that you also have to be reasonably quick about checkmating your opponent. You only have three turns from placing the first piece to placing the opponent's king.
+
+You may also note there is more than one solution. Every other solution should be a rotation or mirroring of the ones listed below.
+
+I've included, first, diagrams, then move-by-move solutions.

 Here is one solution for two rooks:

@@ -55,6 +59,8 @@ But this is the one that you want:
 |Q| |k| | |
 +-+-+-+-+-+

+Note that this could also have each piece shifted over one column.
+
 The final quest is a traversal. You need to touch all the squares without going over one twice. This seems like there are so many possibilities, but process of elimination helps.

 Also notice movement from and to the corner squares is restricted. Note that the only way to reach a1, s5, e1, or e5 (corner squares,) you must be on c2, b3, c4 or d3 first.
@@ -92,3 +98,58 @@ Square number 2 doesn't really matter. You can always rotate or flip the chessbo
  a b c d e

 From "h" you can then jump to d3 and then clean out the corner squares.
+
+===================================================================
+
+Here are the move-by-move solutions, with whitespace, so they're not spoiled.
+
+
+
+
+
+
+
+
+
+
+
+
+SSE.NNE.SWW.SEE.CALL ROOK (it doesn't matter which).NWW.CALL ROOK.SWW.CALL KING
+
+
+
+
+
+
+
+
+
+
+
+SSE.CALL QUEEN.NNW.SSW.NNW.CALL KING (if you can summon your own king, the game gives him preference).SSE.CALL KING
+
+
+
+
+
+
+
+
+
+
+
+SWW.SEE.CALL ROOK.NNW.CALL KING.SSW.CALL KING
+
+
+
+
+
+
+
+
+
+
+
+NNE.SSE.SSW.NWW.NNW.NEE.SEE.SSW.SWW.NNW.NNE.SEE.SSE.SWW.NWW.NNE (all but the corners and corner-adjacent points done).SEE.SSE.NWW.SWW.NNE.NNW.SEE.NEE
+
+Congratulations! You have won.
\ No newline at end of file
commit 6ae4ac14f325773c55d25771612618accadca7db
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Tue Jun 22 18:56:18 2021 -0500

    bugs fixed with REVIEW

diff --git a/story.ni b/story.ni
index 0de0b9d..091f480 100644
--- a/story.ni
+++ b/story.ni
@@ -171,7 +171,7 @@ after printing the locale description when need-to-hurry is true:
 after printing the locale description when quest-index is 1:
 	increment moves-this-quest;
 	if remainder after dividing moves-this-quest by 7 is 0:
-		say "You're still looking around for the best square to [b]CALL[r] or [b]PLACE[r] allies. But just so you know, more than one square works for the first piece, and even if you mess up, this quest will reset, and you can retry.";
+		say "You're still looking around for the best square to [b]CALL[r] or [b]PLACE[r] allies. It's worth scouting around, but just so you know, more than one square works for the first piece, and even if you mess up, this quest will reset, and you can retry. It's worth experimenting.";
 	continue the action;

 section circle-visited
@@ -527,7 +527,7 @@ to place-king:
 to quest-conclusion:
 	say "[line break]";
 	if quest-index is 1:
-		say "The old king is dead! Long live the middle-aged king. He's going to be a bit sneakier. And he knows his father died in a corner -- so you may not be able to sucker him there. However, he makes indications he wants a diplomatic meeting with your king and queen.";
+		say "The old king is dead! Long live the middle-aged king. He's going to be a bit sneakier. And he knows his father died in a corner -- so you may not be able to sucker him there. However, he makes indications he wants a diplomatic meeting with your king and queen.[paragraph break]NOTE: you will be able to see technical details of completed quest with [b]R[r] or [b]REVIEW[r].";
 	 else if quest-index is 2:
 		say "The king is dead, cut down in his prime! Long live the young king. Any show of overwhelming force is likely to intimidate him, but etiquette demands he meet with your king -- and perhaps one of your rooks will trail along. You wonder what you can do with that.";
 	else if quest-index is 3:
@@ -571,9 +571,10 @@ to decide which number is stalemate-count:

 after printing the locale description when quest-index is 4:
 	now location of player is circle-visited;
-	say "[number of circle-visited rooms] vs [number of not circle-visited rooms].";
-	if number of not circle-visited rooms < 5:
-		say "[list of not circle-visited rooms].";
+	if debug-state is true:
+		say "(DEBUG) [number of circle-visited rooms] visited, [number of not circle-visited rooms] unvisited.";
+		if number of not circle-visited rooms < 5:
+			say "(DEBUG) [list of not circle-visited rooms].";
 	if number of circle-visited rooms is 25:
 		say "Horns blare! Voices soar to the sky! You have trampled all of [5b], literally and figuratively! Now is time for your reward!";
 		let t be stalemate-count;
@@ -827,6 +828,37 @@ carry out helping:
 	say "This game should come with a walkthrough. However, if you need a refresher on your quest, simply [b]X[r] [delenda] or just [b]X[r]. It's a bit short on details -- of course it is! Royalty tends to delegate like that.";
 	the rule succeeds.

+chapter reviewing
+
+reviewing is an action applying to nothing.
+
+understand the command "review" as something new.
+understand the command "rev" as something new.
+understand the command "re" as something new.
+understand the command "r" as something new.
+
+understand "review" as reviewing.
+understand "rev" as reviewing.
+understand "re" as reviewing.
+understand "r" as reviewing.
+
+carry out reviewing:
+	if quest-index is 1, say "Nothing to review yet." instead;
+	say "Here's what you've got so far:[paragraph break]";
+	repeat with x running from 1 to quest-index - 1:
+		choose row x in table of notes;
+		if entry x in stalemated is true:
+			say "You stalemated the enemy king with [stalemate-notes entry].";
+		else:
+			say "[checkmate-notes entry].";
+	the rule succeeds.
+
+table of notes
+stalemate-notes	checkmate-notes
+"two rooks--in practical play, the most likely stalemate is one rook being diagonal from the corner, guarded by the other rook"	"You pinned the enemy king into the corner using the two rooks: one covering the side, one covering the row/column next to it. The process of cornering a king is known as a rook roll--the rooks start at . Once you learn it, you're never gonna give it up."
+"king and queen--there are so many ways to do this! The queen can force the king in the corner, or you don't move the king the right way"	"You trapped the enemy king with a queen and king. In practical play, the queen alone can drive the enemy king into the corner where he only has two squares to move, then your king walks in. Your queen just sits three squares up and one square left (or some rotation/mirroring) from the corner."
+"king and rook--in practical play you probably won't see the position you got, and the only likely way is to have the rook, guarded by a king, diagonal from the corner"	"You trapped the king in the corner with your own king and rook. It's possible to trap the king on the side--your king is two squares away, off the edge, and the rook gives check. It's trickier for the king and rook to corner an enemy king, though. You have to make semi-waiting moves to slowly make the enemy king's rectangle smaller and smaller."
+
 chapter statsing

 statsing is an action applying to nothing.
@@ -889,8 +921,9 @@ carry out verbsing:
 	say "General meta-commands include [b]ABOUT[r]/[b]A[r] and [b]CREDITS[r] for general game information and thanks.";
 	say "You also have the option of toggling abbrevation of long directions with [b]ABB[r].";
 	say "If you want a rules refresher, [b]CHESS[r] or [b]CH[r] will teach you all you need to know. Don't worry--you won't be quizzed on en passant!";
-	say "Of course, there's this command, too: [b]VERBS[r]/[b]VERB[r]/[b]V[r].";
-	say "[line break]Also, you can often use abbreviations for nouns, e.g. [b]CALL Q[r] for the queen or [b]CALL KR[r] for the kingside rook.";
+	if quest-index > 1, say "You can also [b]REVIEW[r] or [b]R[r] what you've done so far, though that's more for general chess endgame knowledge.";
+	say "And of course, there's this command, too: [b]VERBS[r]/[b]VERB[r]/[b]V[r].";
+	say "[line break]While this is more nouns than vertbs, note you can often use abbreviations for nouns, e.g. [b]CALL Q[r] for the queen or [b]CALL KR[r] for the kingside rook or [b]CALL K[r] for the king.";
 	the rule succeeds.

 chapter xyzzying
commit db22d4f82b1b6d8a46024b9672146a2c6c8bbe90
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Tue Jun 22 18:32:18 2021 -0500

    switched up KQK quest and fixed runtime errror and added clarifications/test case for KQK

diff --git a/story.ni b/story.ni
index bdad71e..0de0b9d 100644
--- a/story.ni
+++ b/story.ni
@@ -24,6 +24,14 @@ moves-this-quest is a number that varies. moves-this-quest is 0.

 description of the player is "Spiffy and knightly indeed."

+a thing can be examined. a thing is usually not examined.
+
+after examining a thing (called th):
+	now th is examined;
+	continue the action;
+
+got-rook-for-queen is a truth state that varies.
+
 chapter rooms

 a room can be circle-visited. a room is usually not circle-visited.
@@ -54,7 +62,7 @@ after examining DELENDA for the first time:

 to say current-quest-text:
 	if quest-index is 4:
-		say "Trample around all twenty-five precincts of [5b] without repeating twice";
+		say "trample around all twenty-five precincts of [5b] without repeating twice";
 		continue the action;
 	say "entrap the [age-of] king of [5b] with [the list of offensive pieces]"

@@ -73,7 +81,7 @@ your horse is a backdrop. Your horse is everywhere. understand "steed" as horse.
 instead of doing something with your horse:
 	if the current action is examining, continue the action;
 	say "You can really only ride your horse in one of eight directions. To get a refresher on that, type [b]DIRS[r]."
-
+
 chapter i6

 section char nums
@@ -355,7 +363,7 @@ volume people and quests

 chapter general lists

-max-wait-times is a list of numbers variable. max-wait-times is { 3, 3, 3, 0 }.
+max-wait-times is a list of numbers variable. max-wait-times is { 3, 4, 3, 0 }.

 stalemated is a list of truth states variable. stalemated is { False, False, False, False }.

@@ -369,7 +377,7 @@ description of a piece is usually "Right now, [the item described] looks ready t

 check taking a piece:
 	say "No, you put [the noun] here. But don't worry, if you did things wrong, you can try again." instead;
-
+
 preferred-rook is a piece that varies.

 does the player mean calling preferred-rook when quest-index is 1: it is likely.
@@ -475,12 +483,12 @@ carry out calling:
 		reset-the-board instead;
 	consider the stalemate processing rule;
 	if the rule succeeded:
-		quest-prologue;
+		quest-conclusion;
 		the rule succeeds;
 	consider the checkmate processing rule;
 	if the rule failed, reset-the-board instead;
 	if the rule succeeded:
-		quest-prologue;
+		quest-conclusion;
 	the rule succeeds.

 to update-guarded:
@@ -513,14 +521,15 @@ to place-king:
 	let myx be x of location of friendly king;
 	let myy be y of location of friendly king;
 	repeat with mydir running through planar directions:
-		let rm be room_of (x + xness of mydir) and (y + yness of mydir);
+		let rm be room_of (myx + xness of mydir) and (myy + yness of mydir);
 		now rm is guarded;

-to quest-prologue:
+to quest-conclusion:
+	say "[line break]";
 	if quest-index is 1:
 		say "The old king is dead! Long live the middle-aged king. He's going to be a bit sneakier. And he knows his father died in a corner -- so you may not be able to sucker him there. However, he makes indications he wants a diplomatic meeting with your king and queen.";
 	 else if quest-index is 2:
-		say "The king in the prime of his life is dead! Long live the young king. Any show of overwhelming force is likely to intimidate him, but etiquette demands he meet with your king -- and perhaps one of your rooks will trail along. You wonder what you can do with that.";
+		say "The king is dead, cut down in his prime! Long live the young king. Any show of overwhelming force is likely to intimidate him, but etiquette demands he meet with your king -- and perhaps one of your rooks will trail along. You wonder what you can do with that.";
 	else if quest-index is 3:
 		say "The young king is dead! The last of his line. All that remains for you to do is the traditional dance of victory and domination over a weaker country. It is time to walk over each of Fivebyfivia's twenty-five counties without repeating, to show your kingdom's efficiency in both conquering and providing vital constituent services. Okay, mostly conquering.";
 	increment quest-index;
@@ -576,7 +585,7 @@ after printing the locale description when quest-index is 4:

 does the player mean calling a reserved piece: it is very likely.

-does the player mean calling the friendly king when friendly king is reserved: it is likely.
+does the player mean calling the enemy king when friendly king is reserved: it is very unlikely.

 to setup-next-puzzle:
 	reset-the-board;
@@ -599,17 +608,17 @@ current-turns-after-placing is a number that varies.
 need-to-hurry is a truth state that varies.

 to reset-the-board:
-	if location of player is not c3:
-		move player to c3;
 	now all pieces are off-stage;
 	now all placed pieces are reserved;
 	now all rooms are not guarded;
+	now max-turns-after-placing is entry quest-index of max-wait-times;
+	now current-turns-after-placing is 0;
+	now need-to-hurry is false;
+	if location of player is not c3:
+		move player to c3;
 	if quest-index is 4:
 		now all rooms are not circle-visited;
 		now c3 is circle-visited;
-	now max-turns-after-placing is entry quest-index of max-wait-times;
-	now current-turns-after-placing is 0;
-	now need-to-hurry is false.

 this is the takeit processing rule:
 	let ek be the location of the enemy king;
@@ -643,10 +652,11 @@ this is the checkmate processing rule:
 		let qx be absval of (x of location of queen - x of location of enemy king);
 		let qy be absval of (y of location of queen - y of location of enemy king);
 		if qx < 2 and qy < 2:
-			say "Alas, a kink in your plans! The queen refuses, REFUSES to get close to that horrid enemy king. You thought you had things planned out well, but--well, you didn't. You'll have to try another way to get people together.";
+			say "Alas, a kink in your plans! The queen refuses, REFUSES to get close to that horrid enemy king. You thought you had things planned out well, but--well, maybe there is another way to get people together. But not too close.";
 			the rule fails;
 		if location of enemy king is cornery:
 			say "Before you can summon the enemy king over, though, your allies call you by. That's a good formation, but maybe you will use it better in the future. It won't be a surprise if you use it twice. You take notes.";
+			now got-rook-for-queen is true;
 			the rule fails;
 	say "The enemy king looks around, then runs one way, then another. Slowly it dawns on him. He is trapped! The end is not pretty.";
 	the rule succeeds;
@@ -712,7 +722,7 @@ rule for printing a parser error when the latest parser error is the only unders
 section inventory trivia

 check taking inventory:
-	say "You don't have much on you other than [delenda]. Your horse is built for speed and not for hauling stuff.[paragraph break][if delenda is unexamined]You probably want to [b]X[r] [delenda][else]If you need a refresher, no shame in trying to [b]X[r] [delenda] again." instead;
+	say "You don't have much on you other than [delenda]. Your horse is built for speed and not for hauling stuff.[paragraph break][if delenda is not examined]You probably want to [b]X[r] [delenda][else]If you need a refresher, no shame in trying to [b]X[r] [delenda] again." instead;

 section score trivia

@@ -848,6 +858,8 @@ carry out statsing:
 	else:
 		say "Reserved pieces to (C)all: [list of reserved pieces].";
 		say "Pieces out on the board: [list of placed pieces].";
+	if quest-index is 3 and got-rook-for-queen is true:
+		say "[line break]You remember how you almost trapped the enemy king before: him in the corner, your king a knight-move away, your queen another knight-move away. That would work here, too.";
 	the rule succeeds.

 after printing the name of a placed piece (called p) when statsing:
@@ -928,7 +940,8 @@ chapter stupid stuff
 test q1 with "ssw/nnw/see/see/call kingside/nww/call queenside/sww/call king".
 test q1s with "nnw/call kingside/ssw/see/call queenside/sww/call king".

-test q2 with "sse/call queen/nnw/ssw/call friendly king/nnw/call enemy king".
+test q2n with "ssw/nee/call queen/sww/nne/call king/sse/call king".
+test q2 with "sse/call queen/nnw/ssw/nnw/call friendly king/sse/call enemy king".
 test q2s with "nne/call friendly king/sww/sse/call queen/sww/call king".

 test q3 with "sww/see/call rook/nnw/call friendly king/ssw/call enemy king".
commit a51b88a4c65cf7a07ca40f39c8900ab204118724
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Tue Jun 22 17:33:32 2021 -0500

    Wade Clarke transcript: describing pieces, dummy pieces, PUSH, general help

diff --git a/story.ni b/story.ni
index 21c6491..bdad71e 100644
--- a/story.ni
+++ b/story.ni
@@ -50,7 +50,7 @@ understand "del" as DELENDA.
 understand "scroll" as DELENDA.

 after examining DELENDA for the first time:
-	say "You may wish to shorten typing [delenda]'s long name to [b]DFE[r], [b]EST[r], or [b]DEL[r]. Or you can just [b]X[r]. Pedantically proper typing of long words is no quick way to fame and glory for an ambitious knight such as yourself!"
+	say "You may wish to shorten typing [delenda]'s long name to [b]DFE[r], [b]EST[r], or [b]DEL[r]. Or you can just type [b]X[r]. You're an ambitious knight, not some boring old scribe who shows off writing fancy words out. You have much more exciting ways to show off!"

 to say current-quest-text:
 	if quest-index is 4:
@@ -60,7 +60,7 @@ to say current-quest-text:

 to say age-of:
 	say "[if quest-index is 1]old[else if quest-index is 2]middle-aged[else]young[end if]"
-
+
 check dropping DELENDA:
 	say "And let such a valuable document fall into the wrong hands? Certainly not!" instead;

@@ -73,7 +73,7 @@ your horse is a backdrop. Your horse is everywhere. understand "steed" as horse.
 instead of doing something with your horse:
 	if the current action is examining, continue the action;
 	say "You can really only ride your horse in one of eight directions. To get a refresher on that, type [b]DIRS[r]."
-
+
 chapter i6

 section char nums
@@ -244,8 +244,6 @@ section for posterity

 xness of north is 0. yness of north is 1. xness of south is 0. yness of south is -1. xness of east is 1. yness of east is 0. xness of west is -1. yness of west is 0. xness of northwest is -1. yness of northwest is 1. xness of northeast is 1. yness of northeast is 1. xness of southwest is -1. yness of southwest is -1. xness of southeast is 1. yness of southeast is -1.

-chapter direction verbs
-
 volume rooms

 a1 is a room. x of a1 is 0. y of a1 is 0. room-edge-text is "at the relatively inaccessible southwest corner".
@@ -367,6 +365,8 @@ chapter pieces

 a piece is a kind of person. a piece can be reserved, irrelevant, or placed. a piece is usually irrelevant. a piece has a list of truth state called summon-list. a piece has text called short-text.

+description of a piece is usually "Right now, [the item described] looks ready to go chase an enemy king. But they may not wait too long. Better [if number of reserved pieces is 1]call your other allies and then [end if]call the enemy king soon."
+
 check taking a piece:
 	say "No, you put [the noun] here. But don't worry, if you did things wrong, you can try again." instead;

@@ -399,6 +399,16 @@ the queenside rook is a neuter piece. understand "qr" as queenside rook. underst

 summon-list of queenside rook is { true, false, false, false }.

+section bogus pices
+
+a quasipiece is a kind of thing.
+
+the pawn is a quasipiece. understand "p" as pawn.
+
+the bishop is a quasipiece. understand "b/kb/qb" as bishop.
+
+the knight is a quasipiece. understand "n/kn/qn" as knight.
+
 chapter calling

 calling is an action applying to one visible thing.
@@ -408,10 +418,10 @@ understand the command "c" as something new.
 understand the command "place" as something new.
 understand the command "p" as something new.

-understand "call [any piece]" as calling.
-understand "c [any piece]" as calling.
-understand "place [any piece]" as calling.
-understand "p [any piece]" as calling.
+understand "call [any thing]" as calling.
+understand "c [any thing]" as calling.
+understand "place [any thing]" as calling.
+understand "p [any thing]" as calling.

 understand "call" as calling.
 understand "c" as calling.
@@ -442,6 +452,9 @@ this is the enemy-placement rule:

 carry out calling:
 	if quest-index is 4, say "You're on your own now." instead;
+	if noun is a quasipiece, say "You don't need to sumomon [the noun] in [5b]. Only kings, queens and rooks." instead;
+	if noun is horse or noun is delenda or noun is the player, say "You're already here, with your horse and [delenda]." instead;
+	if noun is not a piece, say "You can only summon (other) chess pieces." instead;
 	if noun is placed:
 		say "You already placed [the noun] at [location of the noun]." instead;
 	if noun is irrelevant:
@@ -677,13 +690,21 @@ definition: a room (called r) is surrounded:
 		no;
 	yes;

+volume regular verbs to reject
+
+check pushing: say "You're not some boring old woodpusher who sits crouched over a board for hours on end. Besides, your allies can push themselves well enough. They're motivated enough." instead;
+
+check pulling: say "You already pulled [the noun] away." instead;
+
 volume meta

+to say verbs: say "[b]V[r] or [b]VERB[r] or [b]VERBS[r]"
+
 rule for printing a parser error:
-	say "I didn't recognize that command. Type [b]V[r] or [b]VERB[r] or [b]VERBS[r] to see the full list of commands. If you're confused what to do, [b]X[r] [delenda] again, or refer to the game [b]MAP[r]."
+	say "I didn't recognize that command. Type [verbs] to see the full list of commands. If you're confused what to do, [b]X[r] [delenda] again, or refer to the game [b]MAP[r]."

 rule for printing a parser error when the latest parser error is the noun did not make sense in that context error:
-	say "The verb was okay, but I didn't understand the noun in that sentence. Please try again, or type [b]V[r] to see the list of commands."
+	say "The verb was okay, but I didn't understand the noun in that sentence. You can type [verbs] to see how to use verbs with a subject."

 rule for printing a parser error when the latest parser error is the only understood as far as error:
 	say "You only needed the first word of that command. You can use the up arrow and backspace so you don't have to retype."
@@ -691,7 +712,7 @@ rule for printing a parser error when the latest parser error is the only unders
 section inventory trivia

 check taking inventory:
-	say "You don't have much on you other than [delenda]. Your horse is built for speed and not for hauling stuff.";
+	say "You don't have much on you other than [delenda]. Your horse is built for speed and not for hauling stuff.[paragraph break][if delenda is unexamined]You probably want to [b]X[r] [delenda][else]If you need a refresher, no shame in trying to [b]X[r] [delenda] again." instead;

 section score trivia

@@ -760,7 +781,7 @@ understand the command "credits" as something new.
 understand "credits" as creditsing.

 carry out creditsing:
-	say "Thanks to Arthur DiBianca for testing.";
+	say "Thanks to Wade Clarke and Arthur DiBianca for testing.";
 	say "[line break]Thanks to chessgames.com, chess.com and lichess.org for all the chess fun and puzzles and opponents from all over the globe. This all was especially nice during the pandemic.";
 	the rule succeeds.

commit aa34c3cae4ee1b6b76597a422246099141dee786
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Tue Jun 22 05:35:44 2021 -0500

    more trivial responses to default verbs

diff --git a/story.ni b/story.ni
index 041e751..21c6491 100644
--- a/story.ni
+++ b/story.ni
@@ -68,11 +68,11 @@ instead of doing something with DELENDA:
 	if the current action is examining, continue the action;
 	say "You can really only examine [DELENDA].";

-your horse is a backdrop. Your horse is everywhere. understand "steed" as horse. description is "It has a zigzag-patterned coat. Like it was tiled with checkmarks. There are few like it.[paragraph break]You can't see this so well when it moves. To see which ways it can move, type [b]DIRS[r]."
+your horse is a backdrop. Your horse is everywhere. understand "steed" as horse. description is "It has a zigzag-patterned coat. Like it was tiled with checkmarks. There are few like it.[paragraph break]You don't really notice the zigzags when you move. It really bucks around. To see which ways it can move, type [b]DIRS[r]."

 instead of doing something with your horse:
 	if the current action is examining, continue the action;
-	say "You can really only ride your horse in one of eight directions. To get a refresher on that, type DIRS."
+	say "You can really only ride your horse in one of eight directions. To get a refresher on that, type [b]DIRS[r]."

 chapter i6

@@ -123,7 +123,7 @@ to say room-detail:
 	if location of player is c3:
 		say "From here, your horse can bolt in any of the eight crazy directions it likes to zoom off. Hooray, freedom! Well, for you, not for [5b]";
 		continue the action;
-	say "You can go [list of viable directions]";
+	say "You can go [list of viable directions][if number of placed pieces is 0] to search for the best place to CALL your first allies[end if]";

 definition: a direction (called d) is viable:
 	if d is normal, no;
@@ -367,6 +367,9 @@ chapter pieces

 a piece is a kind of person. a piece can be reserved, irrelevant, or placed. a piece is usually irrelevant. a piece has a list of truth state called summon-list. a piece has text called short-text.

+check taking a piece:
+	say "No, you put [the noun] here. But don't worry, if you did things wrong, you can try again." instead;
+
 preferred-rook is a piece that varies.

 does the player mean calling preferred-rook when quest-index is 1: it is likely.
@@ -677,7 +680,7 @@ definition: a room (called r) is surrounded:
 volume meta

 rule for printing a parser error:
-	say "I didn't recognize that command. Type [b]V[r] or [b]VERB[r] or [b]VERBS[r] to see the list of commands."
+	say "I didn't recognize that command. Type [b]V[r] or [b]VERB[r] or [b]VERBS[r] to see the full list of commands. If you're confused what to do, [b]X[r] [delenda] again, or refer to the game [b]MAP[r]."

 rule for printing a parser error when the latest parser error is the noun did not make sense in that context error:
 	say "The verb was okay, but I didn't understand the noun in that sentence. Please try again, or type [b]V[r] to see the list of commands."
@@ -685,6 +688,11 @@ rule for printing a parser error when the latest parser error is the noun did no
 rule for printing a parser error when the latest parser error is the only understood as far as error:
 	say "You only needed the first word of that command. You can use the up arrow and backspace so you don't have to retype."

+section inventory trivia
+
+check taking inventory:
+	say "You don't have much on you other than [delenda]. Your horse is built for speed and not for hauling stuff.";
+
 section score trivia

 check requesting the score:
@@ -843,12 +851,13 @@ understand "v" as verbsing.

 carry out verbsing:
 	say "The main verbs you can use are about going places. You have 8 different diagonal directions, which you can see in detail with [b]DIRS[r].";
-	say "You can also [b]C[r]/[b]CALL[r] or [b]P[r]/[b]PLACE[r] allies or the [5b]n king.";
-	say "There's also this one, [b]VERBS[r], of course, and you can type [b]ABOUT[r]/[b]A[r] and [b]CREDITS[r] for general game information and thanks.";
+	say "You can also [b]C[r]/[b]CALL[r] or [b]P[r]/[b]PLACE[r] allies or the [5b]n king. These are all the commands you need to win. [b]X[r] [delenda] for your current quest.";
+	say "[line break]But there are also meta-commands. Of these, [b]M[r] or [b]MAP[r] to see the map at any time is likely to be the most useful. It shows you where your allies are and what they are guarding. [b]B[r] or [b]BOARD[r] also works.";
+	say "General meta-commands include [b]ABOUT[r]/[b]A[r] and [b]CREDITS[r] for general game information and thanks.";
 	say "You also have the option of toggling abbrevation of long directions with [b]ABB[r].";
 	say "If you want a rules refresher, [b]CHESS[r] or [b]CH[r] will teach you all you need to know. Don't worry--you won't be quizzed on en passant!";
-	say "You can also say [b]M[r] or [b]MAP[r] to see the map at any time, withe all the squares your allies are guarding. [b]B[r] or [b]BOARD[r] also works.";
-	say "Also, you can often use abbreviations for nouns, e.g. [b]CALL Q[r] for the queen or [b]CALL KR[r] for the kingside rook.";
+	say "Of course, there's this command, too: [b]VERBS[r]/[b]VERB[r]/[b]V[r].";
+	say "[line break]Also, you can often use abbreviations for nouns, e.g. [b]CALL Q[r] for the queen or [b]CALL KR[r] for the kingside rook.";
 	the rule succeeds.

 chapter xyzzying
@@ -866,6 +875,7 @@ volume beta testing - not for release

 when play begins:
 	now in-beta is true;
+	say "This is just a check for myself that this is, indeed, the beta version. It won't appear in the release.";

 chapter boarding

commit 7ad9a97b1c1ac7d42f1c20ad229094eaf1e8c9ec
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Sun Jun 20 14:01:51 2021 -0500

    calling disambiguiation for kr/qr

diff --git a/story.ni b/story.ni
index 1cf5699..041e751 100644
--- a/story.ni
+++ b/story.ni
@@ -150,7 +150,7 @@ section timed-going

 after printing the locale description when need-to-hurry is true:
 	increment current-turns-after-placing;
-	if debug-state is true, say "[current-turns-after-placing] of [max-turns-after-placing].";
+	if debug-state is true, say "DEBUG turn count track: [current-turns-after-placing] of [max-turns-after-placing].";
 	if current-turns-after-placing > max-turns-after-placing:
 		if enemy king is placed:
 			say "You hear a noise and look around. The enemy king, disgusted at having his time wasted without meeting anyone, retreats. Perhaps he suspects something. Perhaps he does not.";
@@ -367,6 +367,10 @@ chapter pieces

 a piece is a kind of person. a piece can be reserved, irrelevant, or placed. a piece is usually irrelevant. a piece has a list of truth state called summon-list. a piece has text called short-text.

+preferred-rook is a piece that varies.
+
+does the player mean calling preferred-rook when quest-index is 1: it is likely.
+
 definition: a piece (called p) is offensive:
 	if p is enemy king, no;
 	if p is irrelevant, no;
@@ -406,6 +410,26 @@ understand "c [any piece]" as calling.
 understand "place [any piece]" as calling.
 understand "p [any piece]" as calling.

+understand "call" as calling.
+understand "c" as calling.
+understand "place" as calling.
+understand "p" as calling.
+
+definition: a piece (called p) is not-last:
+	if p is enemy king, no;
+	if p is reserved, yes;
+
+rule for supplying a missing noun when calling:
+	if number of not-last pieces is 1:
+		now noun is a random not-last piece;
+	else if number of reserved pieces is 1:
+		now noun is a random reserved piece;
+	else if quest-index is 1:
+		now noun is preferred-rook;
+	else:
+		say "You need to specify which ally to summon of [the list of not-last pieces].";
+		reject the player's command.
+
 this is the enemy-placement rule:
 	if number of reserved pieces > 1:
 		say "You probably don't want to summon the enemy king until last. He'd get really suspicious if you just made him wait around." instead;
@@ -475,7 +499,6 @@ to place-king:
 	repeat with mydir running through planar directions:
 		let rm be room_of (x + xness of mydir) and (y + yness of mydir);
 		now rm is guarded;
-

 to quest-prologue:
 	if quest-index is 1:
@@ -546,6 +569,12 @@ to setup-next-puzzle:
 			now P is reserved;
 		else:
 			now P is irrelevant;
+	if quest-index is 1:
+		if a random chance of 1 in 2 succeeds:
+			now preferred-rook is queenside rook;
+		else:
+			now preferred-rook is kingside rook;
+		say "[preferred-rook].";

 max-turns-after-placing is a number that varies.

commit 43e008588206f1b0959186e17ee49eefb20b1c1b
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Sun Jun 20 11:19:55 2021 -0500

    credits and verbs tweaks

diff --git a/story.ni b/story.ni
index f99183a..1cf5699 100644
--- a/story.ni
+++ b/story.ni
@@ -40,7 +40,7 @@ when play begins:

 chapter FIVEBYFIVIA DELENDA EST

-FIVEBYFIVIA DELENDA EST is a thing. the player carries FIVEBYFIVIA DELENDA EST. description of DELENDA is "[DELENDA] contains the instructions for your current quest. Right now, it seems you need to [current-quest-text].".
+FIVEBYFIVIA DELENDA EST is a thing. the player carries FIVEBYFIVIA DELENDA EST. description of DELENDA is "[DELENDA] contains the instructions for your current quest. Right now, it seems you need to [current-quest-text].[paragraph break]There are also some general notes about not calling the enemy king until your allies are all set, or he'll get suspicious.".

 printed name of DELENDA is "[i]FIVEBYFIVIA DELENDA EST[r]".

@@ -723,7 +723,8 @@ understand the command "credits" as something new.
 understand "credits" as creditsing.

 carry out creditsing:
-	say "<fill in later>";
+	say "Thanks to Arthur DiBianca for testing.";
+	say "[line break]Thanks to chessgames.com, chess.com and lichess.org for all the chess fun and puzzles and opponents from all over the globe. This all was especially nice during the pandemic.";
 	the rule succeeds.

 chapter dirsing
@@ -813,8 +814,8 @@ understand "v" as verbsing.

 carry out verbsing:
 	say "The main verbs you can use are about going places. You have 8 different diagonal directions, which you can see in detail with [b]DIRS[r].";
-	say "You can also [b]CALL[r] or [b]P[r]/[b]PLACE[r] allies or the [5b]n king.";
-	say "There's also this one, [b]VERBS[r], of course, and you can type [b]ABOUT[r]/[b]A[r] and [b]CREDITS[r]/[b]C[r] for general game information and thanks.";
+	say "You can also [b]C[r]/[b]CALL[r] or [b]P[r]/[b]PLACE[r] allies or the [5b]n king.";
+	say "There's also this one, [b]VERBS[r], of course, and you can type [b]ABOUT[r]/[b]A[r] and [b]CREDITS[r] for general game information and thanks.";
 	say "You also have the option of toggling abbrevation of long directions with [b]ABB[r].";
 	say "If you want a rules refresher, [b]CHESS[r] or [b]CH[r] will teach you all you need to know. Don't worry--you won't be quizzed on en passant!";
 	say "You can also say [b]M[r] or [b]MAP[r] to see the map at any time, withe all the squares your allies are guarding. [b]B[r] or [b]BOARD[r] also works.";
commit 134b17f6ec3744ccec063bc918c77b5955b9fa44
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Sun Jun 20 10:24:18 2021 -0500

    the board now gives output about what squares are guarded

diff --git a/story.ni b/story.ni
index 3659861..f99183a 100644
--- a/story.ni
+++ b/story.ni
@@ -20,8 +20,18 @@ max-quests is a number that varies. max-quests is 4.

 quest-index is a number that varies. quest-index is 1.

+moves-this-quest is a number that varies. moves-this-quest is 0.
+
 description of the player is "Spiffy and knightly indeed."

+chapter rooms
+
+a room can be circle-visited. a room is usually not circle-visited.
+
+a room can be guarded. a room is usually not guarded.
+
+to reset-guard: now all rooms are not guarded.
+
 chapter start of play

 when play begins:
@@ -150,9 +160,13 @@ after printing the locale description when need-to-hurry is true:
 		reset-the-board;
 	continue the action;

-section circle-visited
+after printing the locale description when quest-index is 1:
+	increment moves-this-quest;
+	if remainder after dividing moves-this-quest by 7 is 0:
+		say "You're still looking around for the best square to [b]CALL[r] or [b]PLACE[r] allies. But just so you know, more than one square works for the first piece, and even if you mess up, this quest will reset, and you can retry.";
+	continue the action;

-a room can be circle-visited. a room is usually not circle-visited.
+section circle-visited

 after going to a circle-visited room:
 	say "A groan goes up. You've been here before. Your triumphant tour is cut short.";
@@ -208,6 +222,24 @@ understand "nee" and "ene" and "een" as northeasteast.

 for printing the name of a weird direction (called d) when show-short-dirs is true: say "[vh-abbrev of d]"

+section for seeing what's attacking who
+
+xness of northwest is -1. yness of northwest is 1.
+
+xness of northeast is 1. yness of northeast is 1.
+
+xness of southwest is -1. yness of southwest is -1.
+
+xness of southeast is 1. yness of southeast is -1.
+
+xness of east is 1. yness of east is 0.
+
+xness of west is -1. yness of west is 0.
+
+xness of north is 0. yness of north is 1.
+
+xness of south is 0. yness of south is -1.
+
 section for posterity

 xness of north is 0. yness of north is 1. xness of south is 0. yness of south is -1. xness of east is 1. yness of east is 0. xness of west is -1. yness of west is 0. xness of northwest is -1. yness of northwest is 1. xness of northeast is 1. yness of northeast is 1. xness of southwest is -1. yness of southwest is -1. xness of southeast is 1. yness of southeast is -1.
@@ -290,6 +322,13 @@ when play begins:
 			let re1 be room_of xval + 1 and yval;
 			let rn1 be room_of xval and yval + 1;
 			if r0 is offsite, next; [ shouldn't happen, but ... ]
+			let rne be room_of xval + 1 and yval + 1;
+			if rne is not offsite: [northeast]
+				now rne is mapped northeast of r0;
+				now r0 is mapped southwest of rne;
+			if re1 is not offsite and rn1 is not offsite: [northwest]
+				now rn1 is mapped northwest of re1;
+				now re1 is mapped southeast of rn1;
 			if re1 is not offsite:
 				now r0 is mapped west of re1;
 				now re1 is mapped east of r0;
@@ -388,20 +427,56 @@ carry out calling:
 	now need-to-hurry is true;
 	now noun is placed;
 	move noun to location of player;
-	if in-beta is true:
-		say "(for beta testers) full position...";
-		show-the-board;
+	if noun is not enemy king, update-guarded;
+	show-the-board;
 	if number of reserved pieces > 0, the rule succeeds;
+	consider the takeit processing rule;
+	if the rule succeeded:
+		reset-the-board instead;
 	consider the stalemate processing rule;
 	if the rule succeeded:
 		quest-prologue;
 		the rule succeeds;
 	consider the checkmate processing rule;
-	if the rule failed, reset-the-board;
+	if the rule failed, reset-the-board instead;
 	if the rule succeeded:
 		quest-prologue;
 	the rule succeeds.

+to update-guarded:
+	now all rooms are not guarded;
+	if friendly king is placed:
+		place-king;
+	if queenside rook is placed:
+		place-range queenside rook and list of all cardinal directions;
+	if kingside rook is placed:
+		place-range kingside rook and list of all cardinal directions;
+	if queen is placed:
+		place-range queen and list of all planar directions;
+
+to place-range (p - a piece) and (myl - a list of directions):
+	let myx be x of location of p;
+	let myy be y of location of p;
+	repeat with dir running through myl:
+		let temp-x be myx;
+		let temp-y be myy;
+		while 1 is 1:
+			increase temp-x by xness of dir;
+			increase temp-y by yness of dir;
+			if temp-x > 4 or temp-x < 0, break;
+			if temp-y > 4 or temp-y < 0, break;
+			let myrm be room_of temp-x and temp-y;
+			now myrm is guarded;
+			if number of pieces in myrm > 0, break;
+
+to place-king:
+	let myx be x of location of friendly king;
+	let myy be y of location of friendly king;
+	repeat with mydir running through planar directions:
+		let rm be room_of (x + xness of mydir) and (y + yness of mydir);
+		now rm is guarded;
+
+
 to quest-prologue:
 	if quest-index is 1:
 		say "The old king is dead! Long live the middle-aged king. He's going to be a bit sneakier. And he knows his father died in a corner -- so you may not be able to sucker him there. However, he makes indications he wants a diplomatic meeting with your king and queen.";
@@ -413,14 +488,15 @@ to quest-prologue:
 	setup-next-puzzle;

 to show-the-board:
-	say "(BETA FEATURE ONLY) WHAT'S ON THE BOARD:[line break]";
+	say "STRATEGIC MAP OF FIVEBYFIVIA SO FAR:[line break]";
 	say "[fixed letter spacing]  a b c d e[line break]";
 	say "5[pie of a5][pie of b5][pie of c5][pie of d5][pie of e5] 5[line break]";
 	say "4[pie of a4][pie of b4][pie of c4][pie of d4][pie of e4] 4[line break]";
 	say "3[pie of a3][pie of b3][pie of c3][pie of d3][pie of e3] 3[line break]";
 	say "2[pie of a2][pie of b2][pie of c2][pie of d2][pie of e2] 2[line break]";
 	say "1[pie of a1][pie of b1][pie of c1][pie of d1][pie of e1] 1[line break]";
-	say "  a b c d e[variable letter spacing][line break]";
+	say "  a b c d e[variable letter spacing][paragraph break]";
+	say "* = you, + = square is guarded[if friendly king is not irrelevant], K = your king[end if][if queenside rook is not irrelevant or kingside rook is not irrelevant], R = rook[end if][if queen is not irrelevant], Q = queen[end if], k = enemy king.";

 to say pie of (r - a room):
 	say " ";
@@ -434,6 +510,8 @@ to say pie of (r - a room):
 		say "k";
 	else if r is location of player:
 		say "*";
+	else if r is guarded:
+		say "+";
 	else:
 		say "-"

@@ -476,19 +554,27 @@ current-turns-after-placing is a number that varies.
 need-to-hurry is a truth state that varies.

 to reset-the-board:
-	say "begin reset.";
 	if location of player is not c3:
 		move player to c3;
 	now all pieces are off-stage;
 	now all placed pieces are reserved;
+	now all rooms are not guarded;
 	if quest-index is 4:
 		now all rooms are not circle-visited;
 		now c3 is circle-visited;
 	now max-turns-after-placing is entry quest-index of max-wait-times;
 	now current-turns-after-placing is 0;
-	say "end reset.";
 	now need-to-hurry is false.

+this is the takeit processing rule:
+	let ek be the location of the enemy king;
+	repeat with mydir running through planar directions:
+		let newrm be the room mydir of ek;
+		if newrm is nowhere, next;
+		if newrm is not guarded and number of pieces in newrm > 0:
+			say "Oh dear! The enemy king walks up to [the random piece in newrm] on [mydir] and gives it a good thwacking. Looks like your plans failed somewhere.[paragraph break]Oops. But don't worry. We'll pretend that never happened. For [12b]. And, yes, your own health and standing there.";
+			the rule succeeds;
+
 this is the stalemate processing rule:
 	unless the location of the enemy king is not checked and the location of the enemy king is surrounded, the rule fails;
 	say "The enemy king looks around. He sighs in relief, safe at the moment. But he is a busy man! He needs to get up and do things. Every which way he looks, though, he realize he's being watched. He quickly looks from left to right but surrenders.[paragraph break]Since nobody was directly attacking him, nobody gets the kill. He's taken prisoner. Everyone else looks at you funny.";
commit 5046ef6e5bf2386c34a9436190625bf708d60106
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Sun Jun 20 06:32:00 2021 -0500

    changes from AdB first transcript

diff --git a/story.ni b/story.ni
index 21bca7c..3659861 100644
--- a/story.ni
+++ b/story.ni
@@ -66,8 +66,36 @@ instead of doing something with your horse:

 chapter i6

+section char nums
+
 To say character number (N - a number): (- print (char) {N}; -)

+section what did you mean to
+
+volume i6 modification(s)
+
+section What Do You Want to X
+
+Include (-
+Replace LanguageVerb;
+-) after "Definitions.i6t".
+
+Include (-
+[ LanguageVerb i;
+	switch (i) {
+	'i//','inv','inventory': print "take inventory";
+	'l//':   print "look";
+	'x//':   print "examine";
+	'z//':   print "wait";
+	'about':  print "see info about the game";
+	'c//', 'credit', 'credits': print "see the credits";
+	'c//', 'p//', 'call', 'place': print "place";
+	default: rfalse;
+	}
+	rtrue;
+];
+-) after "Language.i6t".
+
 chapter room info

 a room has a number called x. a room has a number called y.
@@ -110,15 +138,15 @@ to decide which number is square of (d - a direction):

 section timed-going

-after going when need-to-hurry is true:
+after printing the locale description when need-to-hurry is true:
 	increment current-turns-after-placing;
 	if debug-state is true, say "[current-turns-after-placing] of [max-turns-after-placing].";
 	if current-turns-after-placing > max-turns-after-placing:
 		if enemy king is placed:
 			say "You hear a noise and look around. The enemy king, disgusted at having his time wasted without meeting anyone, retreats. Perhaps he suspects something. Perhaps he does not.";
 		else:
-			say "You hear familiar moans. Your summoned compatriot [if number of placed pieces > 1]s have[else]has[end if] grown impatient. The whole operation was based on stealth, which you did not have this time.";
-		say "[line break]You have failed in your quest, and your king and queen will not be pleased ... unless we pretend this was just a practice run you planned in your head before the real thing. Yes, yes, let's do that. That's how it is.";
+			say "You hear familiar moans. Your summoned compatriot[if number of placed pieces > 1]s have[else] has[end if] grown impatient. The whole operation was based on stealth, which you did not have this time.";
+		say "[line break]You did not succeed in your quest, and your king and queen will not be pleased ... unless we pretend this was just a practice run you planned in your head before the real thing. Yes, yes, let's do that. That's how it is.";
 		reset-the-board;
 	continue the action;

@@ -218,9 +246,9 @@ d3 is a room. x of d3 is 3. y of d3 is 2. room-edge-text is "just east of the ce

 e3 is a room. x of e3 is 4. y of e3 is 2. room-edge-text is "at the center of the east edge".

-a4 is a room. x of a4 is 0. y of a4 is 3. room-edge-text is "on the west edge and near the south edge".
+a4 is a room. x of a4 is 0. y of a4 is 3. room-edge-text is "on the west edge and near the north edge".

-b4 is a room. x of b4 is 1. y of b4 is 3. room-edge-text is "in a southeast-ish area".
+b4 is a room. x of b4 is 1. y of b4 is 3. room-edge-text is "in a northwest-ish area".

 c4 is a room. x of c4 is 2. y of c4 is 3. room-edge-text is "just north of the center".

@@ -353,7 +381,7 @@ carry out calling:
 	if noun is irrelevant:
 		say "Right now [the noun] is not part of your maneuver." instead;
 	if number of pieces in location of player > 0:
-		say "That would make things too crowded here. You already called [random piece in location of player] here." instead;
+		say "That would make things too crowded here. You already called [the random piece in location of player] here." instead;
 	if noun is enemy king:
 		abide by the enemy-placement rule;
 	say "You call [the noun] to [location of player].";
@@ -448,6 +476,7 @@ current-turns-after-placing is a number that varies.
 need-to-hurry is a truth state that varies.

 to reset-the-board:
+	say "begin reset.";
 	if location of player is not c3:
 		move player to c3;
 	now all pieces are off-stage;
@@ -457,6 +486,7 @@ to reset-the-board:
 		now c3 is circle-visited;
 	now max-turns-after-placing is entry quest-index of max-wait-times;
 	now current-turns-after-placing is 0;
+	say "end reset.";
 	now need-to-hurry is false.

 this is the stalemate processing rule:
@@ -571,6 +601,7 @@ abouting is an action out of world.
 understand the command "about" as something new.
 understand the command "a" as something new.

+understand "about" as abouting.
 understand "a" as abouting.

 carry out abouting:
@@ -638,7 +669,7 @@ understand "help" as helping.
 understand "h" as helping.

 carry out helping:
-	say "This game should come with a walkthrough.";
+	say "This game should come with a walkthrough. However, if you need a refresher on your quest, simply [b]X[r] [delenda] or just [b]X[r]. It's a bit short on details -- of course it is! Royalty tends to delegate like that.";
 	the rule succeeds.

 chapter statsing
@@ -700,9 +731,8 @@ carry out verbsing:
 	say "There's also this one, [b]VERBS[r], of course, and you can type [b]ABOUT[r]/[b]A[r] and [b]CREDITS[r]/[b]C[r] for general game information and thanks.";
 	say "You also have the option of toggling abbrevation of long directions with [b]ABB[r].";
 	say "If you want a rules refresher, [b]CHESS[r] or [b]CH[r] will teach you all you need to know. Don't worry--you won't be quizzed on en passant!";
-	if in-beta is true:
-		say "Beta testers also have the option to see the [b]BOARD[r] at any time.";
-	say "Also, you can often use abbreviations for nouns, e.g. [b]Q[r] for the queen or [b]KR[r] for the kingside rook.";
+	say "You can also say [b]M[r] or [b]MAP[r] to see the map at any time, withe all the squares your allies are guarding. [b]B[r] or [b]BOARD[r] also works.";
+	say "Also, you can often use abbreviations for nouns, e.g. [b]CALL Q[r] for the queen or [b]CALL KR[r] for the kingside rook.";
 	the rule succeeds.

 chapter xyzzying
@@ -714,7 +744,7 @@ understand the command "xyzzy" as something new.
 understand "xyzzy" as xyzzying.

 carry out xyzzying:
-	say "On the very east side of the world lie such repositories of hooliganism and pointless chance-taking as Backgammonton, Pokersfield or, worse, Yahtzeeburg. You dream of helping conquer them one day, but it is only a dream.";
+	say "On the very east side of the world lie such repositories of hooliganism and pointless chance-taking as Backgammonton, Pokersfield or, worse, Yahtzeeburg. You dream of helping conquer them one day, but it is only a dream. A too-risky one at that.";

 volume beta testing - not for release

@@ -727,9 +757,13 @@ boarding is an action applying to nothing.

 understand the command "board" as something new.
 understand the command "b" as something new.
+understand the command "map" as something new.
+understand the command "m" as something new.

 understand "board" as boarding.
 understand "b" as boarding.
+understand "map" as boarding.
+understand "m" as boarding.

 carry out boarding:
 	if quest-index is 4, try statsing instead;
commit a1fb87f6a2c3de7b06fb4902f2afa53e535a207e
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Sat Jun 19 08:23:38 2021 -0500

    pre-beta trivial fixes

diff --git a/story.ni b/story.ni
index 7b880ec..21bca7c 100644
--- a/story.ni
+++ b/story.ni
@@ -1,12 +1,12 @@
 "Fivebyfivia Delenda Est" by Andrew Schultz

-the story headline is "Just Horsing Around".
+the story headline is "Flagrant Horsing Around".

 the story description is "Less impossible than beating Stockfish".

 volume basics and definitions

-include trivial niceties by Andrew Schultz
+include Trivial Niceties by Andrew Schultz.

 in-beta is a truth state that varies.

@@ -30,7 +30,9 @@ when play begins:

 chapter FIVEBYFIVIA DELENDA EST

-FIVEBYFIVIA DELENDA EST is a thing. the player carries FIVEBYFIVIA DELENDA EST. description of DELENDA is "FIVEBYFIVIA DELENDA EST contains the instructions for your current quest. Right now, it seems you need to [current-quest-text].".
+FIVEBYFIVIA DELENDA EST is a thing. the player carries FIVEBYFIVIA DELENDA EST. description of DELENDA is "[DELENDA] contains the instructions for your current quest. Right now, it seems you need to [current-quest-text].".
+
+printed name of DELENDA is "[i]FIVEBYFIVIA DELENDA EST[r]".

 understand "fde" as DELENDA.
 understand "est" as DELENDA.
@@ -38,7 +40,7 @@ understand "del" as DELENDA.
 understand "scroll" as DELENDA.

 after examining DELENDA for the first time:
-	say "You may wish to shorten typing a long name for [delenda] with [b]DFE[r], [b]EST[r], or [b]DEL[r]. Or you can just [b]X[r]. Save your thinking cells for the tough parts."
+	say "You may wish to shorten typing [delenda]'s long name to [b]DFE[r], [b]EST[r], or [b]DEL[r]. Or you can just [b]X[r]. Pedantically proper typing of long words is no quick way to fame and glory for an ambitious knight such as yourself!"

 to say current-quest-text:
 	if quest-index is 4:
@@ -364,16 +366,24 @@ carry out calling:
 	if number of reserved pieces > 0, the rule succeeds;
 	consider the stalemate processing rule;
 	if the rule succeeded:
-		increment quest-index;
-		setup-next-puzzle;
+		quest-prologue;
 		the rule succeeds;
 	consider the checkmate processing rule;
 	if the rule failed, reset-the-board;
 	if the rule succeeded:
-		increment quest-index;
-		setup-next-puzzle;
+		quest-prologue;
 	the rule succeeds.

+to quest-prologue:
+	if quest-index is 1:
+		say "The old king is dead! Long live the middle-aged king. He's going to be a bit sneakier. And he knows his father died in a corner -- so you may not be able to sucker him there. However, he makes indications he wants a diplomatic meeting with your king and queen.";
+	 else if quest-index is 2:
+		say "The king in the prime of his life is dead! Long live the young king. Any show of overwhelming force is likely to intimidate him, but etiquette demands he meet with your king -- and perhaps one of your rooks will trail along. You wonder what you can do with that.";
+	else if quest-index is 3:
+		say "The young king is dead! The last of his line. All that remains for you to do is the traditional dance of victory and domination over a weaker country. It is time to walk over each of Fivebyfivia's twenty-five counties without repeating, to show your kingdom's efficiency in both conquering and providing vital constituent services. Okay, mostly conquering.";
+	increment quest-index;
+	setup-next-puzzle;
+
 to show-the-board:
 	say "(BETA FEATURE ONLY) WHAT'S ON THE BOARD:[line break]";
 	say "[fixed letter spacing]  a b c d e[line break]";
@@ -584,7 +594,7 @@ carry out chessing:
 	say "Queens can move vertically or horizontally or diagonally until there is an obstruction.";
 	say "Kings can move one square adjacent, vertically or horizontally or diagonally, unless there is an obstruction.";
 	say "Check occurs when one piece is attacking your king.";
-	say "Checkmate is when you attack the enemy's king and he has no safe squares.";
+	say "Checkmate is when you attack the enemy's king and he has no safe square nearby to flee to.";
 	the rule succeeds.

 chapter creditsing
@@ -611,8 +621,8 @@ understand "dir" as dirsing.

 carry out dirsing:
 	say "The eight directions your horse can travel are, clockwise from north, northnortheast, northeasteast, southeasteast, southsoutheast, southsouthwest, southwestwest, northwestwest and northnorthwest.";
-	say "That's a bit long, so you can abbreviate them [b]NNE, NEE, SEE, SSE, SSW, SWW, NWW NNW[r] or any possible permutations. The game will treat all similar permutations as identical, e.g. there is no practical difference between [b]NNE[r], [b]NEN[r] and [b]ENN[r].";
-	say "You can toggle how the directions appear (long or short) in room descriptions with ABB.";
+	say "That's a bit long, so you can abbreviate them [b]NNE[r], [b] NEE[r], [b] SEE[r], [b] SSE[r], [b] SSW[r], [b] SWW[r], [b]NWW[r], [b]NNW[r] or any possible permutations. The game will treat all similar permutations as identical, e.g. there is no practical difference between [b]NNE[r], [b]NEN[r] and [b]ENN[r].";
+	say "You can toggle how the directions appear (long or short) in room descriptions with [b]ABB[r].";
 	the rule succeeds.

 chapter helping
@@ -686,13 +696,13 @@ understand "v" as verbsing.

 carry out verbsing:
 	say "The main verbs you can use are about going places. You have 8 different diagonal directions, which you can see in detail with [b]DIRS[r].";
-	say "You can also [b]CALL[r] allies or the [5b]n king.";
+	say "You can also [b]CALL[r] or [b]P[r]/[b]PLACE[r] allies or the [5b]n king.";
 	say "There's also this one, [b]VERBS[r], of course, and you can type [b]ABOUT[r]/[b]A[r] and [b]CREDITS[r]/[b]C[r] for general game information and thanks.";
 	say "You also have the option of toggling abbrevation of long directions with [b]ABB[r].";
 	say "If you want a rules refresher, [b]CHESS[r] or [b]CH[r] will teach you all you need to know. Don't worry--you won't be quizzed on en passant!";
 	if in-beta is true:
 		say "Beta testers also have the option to see the [b]BOARD[r] at any time.";
-	say "Also, you can often use abbreviations for nouns, e.g. Q for the queen or KR for the kingside rook.";
+	say "Also, you can often use abbreviations for nouns, e.g. [b]Q[r] for the queen or [b]KR[r] for the kingside rook.";
 	the rule succeeds.

 chapter xyzzying
commit ee155d19598646bfb94e5df78614b26b338c0e43
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Sat Jun 19 06:18:51 2021 -0500

    fixed bug in adjacent-king code, added regression test

diff --git a/story.ni b/story.ni
index cb49f54..7b880ec 100644
--- a/story.ni
+++ b/story.ni
@@ -38,7 +38,7 @@ understand "del" as DELENDA.
 understand "scroll" as DELENDA.

 after examining DELENDA for the first time:
-	say "You may wish to shorten typing a long name for [delenda] with [b]DFE[r], [b]EST[r], or [b]DEL[r]. Save your thinking cells for the tough parts."
+	say "You may wish to shorten typing a long name for [delenda] with [b]DFE[r], [b]EST[r], or [b]DEL[r]. Or you can just [b]X[r]. Save your thinking cells for the tough parts."

 to say current-quest-text:
 	if quest-index is 4:
@@ -340,8 +340,9 @@ understand "p [any piece]" as calling.
 this is the enemy-placement rule:
 	if number of reserved pieces > 1:
 		say "You probably don't want to summon the enemy king until last. He'd get really suspicious if you just made him wait around." instead;
+	if enemy king is off-stage, continue the action;
 	if absval of (x of location of enemy king - x of location of enemy king) < 2 and absval of (y of location of enemy king - y of location of enemy king) < 2:
-		say "Wait, no, you can't put the enemy kings adjacent to each other, not even diagonally. Well, you could, but your king would be at risk, somehow." instead;
+		say "Wait, no, you can't put the enemy kings adjacent to each other, not even diagonally. They operate through intermediaries, apparently." instead;

 carry out calling:
 	if quest-index is 4, say "You're on your own now." instead;
@@ -744,7 +745,8 @@ test q3s with "sww/call rook/see/call friendly king/nne/sse/call enemy king".

 test q4 with "nnw/ssw/sse/nee/nne/nww/sww/sse/see/nne/nnw/sww/ssw/see/nee/nnw/sww/nnw/see/nee/ssw/sse/nww/sww".

-test full with "test q1/test q2/test q3/test q4".
+test win1 with "test q1/test q2/test q3/test q4".
+test win2 with "test q1s/test q2s/test q3s/test q4".

 chapter trying

commit 4136e51bcd3a5c756a1e418adfb9812cbecffa44
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 08:56:34 2021 -0500

    moved todo's to new todo file, also put parentheses in stats supplemental text

diff --git a/story.ni b/story.ni
index 9fe3f34..cb49f54 100644
--- a/story.ni
+++ b/story.ni
@@ -1,10 +1,5 @@
 "Fivebyfivia Delenda Est" by Andrew Schultz

-[?? random rook placed for 1st]
-[??note kingside/queenside rook the same]
-[?? random rook for final?]
-[?? what if random flight square, a piece is on it. Have a capture.]
-
 the story headline is "Just Horsing Around".

 the story description is "Less impossible than beating Stockfish".
@@ -669,11 +664,11 @@ carry out statsing:
 	the rule succeeds.

 after printing the name of a placed piece (called p) when statsing:
-	say " ([location of p])";
+	say " ([b][location of p][r])";
 	continue the action;

 after printing the name of a reserved piece (called p) when statsing:
-	say " ([short-text of p])";
+	say " ([b][short-text of p][r])";
 	continue the action;

 chapter verbsing
diff --git a/todo.txt b/todo.txt
new file mode 100644
index 0000000..13c5e98
--- /dev/null
+++ b/todo.txt
@@ -0,0 +1,8 @@
+TO DO LIST:
+
+[??rook roll pun]
+[?? random rook placed for 1st]
+[??note kingside/queenside rook the same]
+[?? random rook for final?]
+[?? what if random flight square, a piece is on it. Have a capture.]
+
commit 9e5f52e0a0fdf964a411c3c3389320b9a8ba1830
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 08:52:37 2021 -0500

    2 bugs fixed: dont print board position til after dropping piece, and parentheses after printing piece when statsing

diff --git a/story.ni b/story.ni
index 7f69068..9fe3f34 100644
--- a/story.ni
+++ b/story.ni
@@ -1,5 +1,10 @@
 "Fivebyfivia Delenda Est" by Andrew Schultz

+[?? random rook placed for 1st]
+[??note kingside/queenside rook the same]
+[?? random rook for final?]
+[?? what if random flight square, a piece is on it. Have a capture.]
+
 the story headline is "Just Horsing Around".

 the story description is "Less impossible than beating Stockfish".
@@ -296,30 +301,30 @@ quest-quick-desc is a list of text variable. quest-quick-desc is { "R & R", "K &

 chapter pieces

-a piece is a kind of person. a piece can be reserved, irrelevant, or placed. a piece is usually irrelevant. a piece has a list of truth state called summon-list.
+a piece is a kind of person. a piece can be reserved, irrelevant, or placed. a piece is usually irrelevant. a piece has a list of truth state called summon-list. a piece has text called short-text.

 definition: a piece (called p) is offensive:
 	if p is enemy king, no;
 	if p is irrelevant, no;
 	yes;

-the friendly king is a piece. understand "k" and "k1" and "fk" as friendly king.
+the friendly king is a piece. understand "k" and "k1" and "fk" as friendly king. short-text of friendly king is "K".

 summon-list of friendly king is { false, true, true, false }.

-the enemy king is a piece. understand "k" and "k2" and "ek" as enemy king.
+the enemy king is a piece. understand "k" and "k2" and "ek" as enemy king. short-text of enemy king is "K".

 summon-list of enemy king is { true, true, true, false }.

-the queen is a female piece. understand "q" as queen.
+the queen is a female piece. understand "q" as queen. short-text of queen is "Q".

 summon-list of queen is { false, true, false, false }.

-the kingside rook is a neuter piece. understand "kr" as kingside rook. understand "r" as kingside rook.
+the kingside rook is a neuter piece. understand "kr" as kingside rook. understand "r" as kingside rook. short-text of kingside rook is "KR/R".

 summon-list of kingside rook is { true, false, true, false }.

-the queenside rook is a neuter piece. understand "qr" as queenside rook. understand "r" as queenside rook.
+the queenside rook is a neuter piece. understand "qr" as queenside rook. understand "r" as queenside rook. short-text of queenside rook is "QR/R".

 summon-list of queenside rook is { true, false, false, false }.

@@ -354,12 +359,12 @@ carry out calling:
 	if noun is enemy king:
 		abide by the enemy-placement rule;
 	say "You call [the noun] to [location of player].";
-	if in-beta is true:
-		say "(for beta testers) full position...";
-		show-the-board;
 	now need-to-hurry is true;
 	now noun is placed;
 	move noun to location of player;
+	if in-beta is true:
+		say "(for beta testers) full position...";
+		show-the-board;
 	if number of reserved pieces > 0, the rule succeeds;
 	consider the stalemate processing rule;
 	if the rule succeeded:
@@ -664,7 +669,12 @@ carry out statsing:
 	the rule succeeds.

 after printing the name of a placed piece (called p) when statsing:
-	say "[location of p]"
+	say " ([location of p])";
+	continue the action;
+
+after printing the name of a reserved piece (called p) when statsing:
+	say " ([short-text of p])";
+	continue the action;

 chapter verbsing

commit 9dfccc0148ec79c2cd0c1f3bb363c171f82ecabc
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 08:51:12 2021 -0500

    random input tweaks

diff --git a/story.ni b/story.ni
index 1af86ea..7f69068 100644
--- a/story.ni
+++ b/story.ni
@@ -38,7 +38,7 @@ understand "del" as DELENDA.
 understand "scroll" as DELENDA.

 after examining DELENDA for the first time:
-	say "You may wish to shorten typing a long name for [delenda] with DFE, EST, or DEL. Save your thinking cells for the tough parts."
+	say "You may wish to shorten typing a long name for [delenda] with [b]DFE[r], [b]EST[r], or [b]DEL[r]. Save your thinking cells for the tough parts."

 to say current-quest-text:
 	if quest-index is 4:
@@ -56,9 +56,10 @@ instead of doing something with DELENDA:
 	if the current action is examining, continue the action;
 	say "You can really only examine [DELENDA].";

-your horse is a backdrop. Your horse is everywhere. understand "steed" as horse.
+your horse is a backdrop. Your horse is everywhere. understand "steed" as horse. description is "It has a zigzag-patterned coat. Like it was tiled with checkmarks. There are few like it.[paragraph break]You can't see this so well when it moves. To see which ways it can move, type [b]DIRS[r]."

 instead of doing something with your horse:
+	if the current action is examining, continue the action;
 	say "You can really only ride your horse in one of eight directions. To get a refresher on that, type DIRS."

 chapter i6
@@ -248,7 +249,7 @@ to decide which room is room_of (n1 - a number) and (n2 - a number):
 check going a normal direction:
 	if noun is up, say "Your horse can fly across ground but not over it." instead;
 	if noun is down, say "Your horse isn't built for that." instead;
-	say "Your horse doesn't go in normal directions. It goes in diagonal ones. But not normal ones like southeast (SE). Southsoutheast (SSE, ESS, SES) and, well, 7 others. DIRS gives a full rundown." instead;
+	say "Your horse doesn't go in normal directions. It goes in diagonal ones. But not normal ones like southeast ([b]SE[r]). There's southsoutheast ([b]SSE, ESS, SES[r]) and, well, 7 others you may be able to extrapolate.[paragraph break][b]DIRS[r] gives a full rundown." instead;

 volume initialization

@@ -373,7 +374,7 @@ carry out calling:
 	the rule succeeds.

 to show-the-board:
-	say "WHAT'S ON THE BOARD:[line break]";
+	say "(BETA FEATURE ONLY) WHAT'S ON THE BOARD:[line break]";
 	say "[fixed letter spacing]  a b c d e[line break]";
 	say "5[pie of a5][pie of b5][pie of c5][pie of d5][pie of e5] 5[line break]";
 	say "4[pie of a4][pie of b4][pie of c4][pie of d4][pie of e4] 4[line break]";
@@ -478,8 +479,6 @@ this is the checkmate processing rule:
 	say "The enemy king looks around, then runs one way, then another. Slowly it dawns on him. He is trapped! The end is not pretty.";
 	the rule succeeds;

-[?? what if random flight square, a piece is on it]
-
 definition: a room (called r) is cornery:
 	unless x of r is 4 or x of r is 0, no;
 	unless y of r is 4 or y of r is 0, no;
@@ -533,7 +532,7 @@ rule for printing a parser error when the latest parser error is the only unders
 section score trivia

 check requesting the score:
-	say "This game doesn't keep track of scores, but you're on quest [quest-index] of [max-quests] right now." instead;
+	say "This game doesn't keep track of scores, but to give you an idea of your progress, you're on quest [quest-index] of [max-quests] right now." instead;

 The print final score rule is not listed in the for printing the player's obituary rulebook.

@@ -610,8 +609,8 @@ understand "dirs" as dirsing.
 understand "dir" as dirsing.

 carry out dirsing:
-	say "The eight directions are, clockwise from north, northnortheast, northeasteast, southeasteast, southsoutheast, southsouthwest, southwestwest, northwestwest and northnorthwest.";
-	say "That's a bit long, so you can abbreviate them NNE, NEE, SEE, SSE, SSW, SWW, NWW NNW or any possible permutations. The game will recognize them.";
+	say "The eight directions your horse can travel are, clockwise from north, northnortheast, northeasteast, southeasteast, southsoutheast, southsouthwest, southwestwest, northwestwest and northnorthwest.";
+	say "That's a bit long, so you can abbreviate them [b]NNE, NEE, SEE, SSE, SSW, SWW, NWW NNW[r] or any possible permutations. The game will treat all similar permutations as identical, e.g. there is no practical difference between [b]NNE[r], [b]NEN[r] and [b]ENN[r].";
 	say "You can toggle how the directions appear (long or short) in room descriptions with ABB.";
 	the rule succeeds.

commit d715e6b9bc19b420f1a161698633adb5597cb963
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 08:39:33 2021 -0500

    headline and description added, actions changed to out of world

diff --git a/story.ni b/story.ni
index 5783e39..1af86ea 100644
--- a/story.ni
+++ b/story.ni
@@ -1,5 +1,9 @@
 "Fivebyfivia Delenda Est" by Andrew Schultz

+the story headline is "Just Horsing Around".
+
+the story description is "Less impossible than beating Stockfish".
+
 volume basics and definitions

 include trivial niceties by Andrew Schultz
@@ -535,7 +539,7 @@ The print final score rule is not listed in the for printing the player's obitua

 chapter abbing

-abbing is an action applying to nothing.
+abbing is an action out of world.

 understand the command "abbrev" as something new.
 understand the command "abb" as something new.
@@ -552,7 +556,7 @@ show-short-dirs is a truth state that varies.

 chapter abouting

-abouting is an action applying to nothing.
+abouting is an action out of world.

 understand the command "about" as something new.
 understand the command "a" as something new.
@@ -565,7 +569,7 @@ carry out abouting:

 chapter chessing

-chessing is an action applying to nothing.
+chessing is an action out of world.

 understand the command "chess" as something new.
 understand the command "ch" as something new.
@@ -585,7 +589,7 @@ carry out chessing:

 chapter creditsing

-creditsing is an action applying to nothing.
+creditsing is an action out of world.

 understand the command "credits" as something new.

@@ -597,7 +601,7 @@ carry out creditsing:

 chapter dirsing

-dirsing is an action applying to nothing.
+dirsing is an action out of world.

 understand the command "dirs" as something new.
 understand the command "dir" as something new.
@@ -613,7 +617,7 @@ carry out dirsing:

 chapter helping

-helping is an action applying to nothing.
+helping is an action out of world.

 understand the command "help" as something new.
 understand the command "hint" as something new.
@@ -665,7 +669,7 @@ after printing the name of a placed piece (called p) when statsing:

 chapter verbsing

-verbsing is an action applying to nothing.
+verbsing is an action out of world.

 understand the command "verbs" as something new.
 understand the command "verb" as something new.
commit 1f7aadefe337480cd7c7da300571e47c12ed3c22
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 08:37:42 2021 -0500

    xyzzy function added

diff --git a/story.ni b/story.ni
index c2f5d32..5783e39 100644
--- a/story.ni
+++ b/story.ni
@@ -686,6 +686,17 @@ carry out verbsing:
 	say "Also, you can often use abbreviations for nouns, e.g. Q for the queen or KR for the kingside rook.";
 	the rule succeeds.

+chapter xyzzying
+
+xyzzying is an action out of world.
+
+understand the command "xyzzy" as something new.
+
+understand "xyzzy" as xyzzying.
+
+carry out xyzzying:
+	say "On the very east side of the world lie such repositories of hooliganism and pointless chance-taking as Backgammonton, Pokersfield or, worse, Yahtzeeburg. You dream of helping conquer them one day, but it is only a dream.";
+
 volume beta testing - not for release

 when play begins:
commit c32da692980262e8ae7de65c7ae7076ce5e0e963
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 08:17:51 2021 -0500

    HELP trivial verb added

diff --git a/story.ni b/story.ni
index 6ca5a7c..c2f5d32 100644
--- a/story.ni
+++ b/story.ni
@@ -16,6 +16,8 @@ max-quests is a number that varies. max-quests is 4.

 quest-index is a number that varies. quest-index is 1.

+description of the player is "Spiffy and knightly indeed."
+
 chapter start of play

 when play begins:
@@ -368,13 +370,13 @@ carry out calling:

 to show-the-board:
 	say "WHAT'S ON THE BOARD:[line break]";
-	say "[fixed letter spacing]   a b c d e[line break]";
+	say "[fixed letter spacing]  a b c d e[line break]";
 	say "5[pie of a5][pie of b5][pie of c5][pie of d5][pie of e5] 5[line break]";
 	say "4[pie of a4][pie of b4][pie of c4][pie of d4][pie of e4] 4[line break]";
 	say "3[pie of a3][pie of b3][pie of c3][pie of d3][pie of e3] 3[line break]";
 	say "2[pie of a2][pie of b2][pie of c2][pie of d2][pie of e2] 2[line break]";
 	say "1[pie of a1][pie of b1][pie of c1][pie of d1][pie of e1] 1[line break]";
-	say "   a b c d e[variable letter spacing][line break]";
+	say "  a b c d e[variable letter spacing][line break]";

 to say pie of (r - a room):
 	say " ";
@@ -609,6 +611,22 @@ carry out dirsing:
 	say "You can toggle how the directions appear (long or short) in room descriptions with ABB.";
 	the rule succeeds.

+chapter helping
+
+helping is an action applying to nothing.
+
+understand the command "help" as something new.
+understand the command "hint" as something new.
+understand the command "h" as something new.
+
+understand "hint" as helping.
+understand "help" as helping.
+understand "h" as helping.
+
+carry out helping:
+	say "This game should come with a walkthrough.";
+	the rule succeeds.
+
 chapter statsing

 statsing is an action applying to nothing.
@@ -629,13 +647,13 @@ to say vis of (r - a room):
 carry out statsing:
 	if quest-index is 4:
 		say "VISITED SO FAR:[line break]";
-		say "[fixed letter spacing]   a b c d e[line break]";
+		say "[fixed letter spacing]  a b c d e[line break]";
 		say "5[vis of a5][vis of b5][vis of c5][vis of d5][vis of e5] 5[line break]";
 		say "4[vis of a4][vis of b4][vis of c4][vis of d4][vis of e4] 4[line break]";
 		say "3[vis of a3][vis of b3][vis of c3][vis of d3][vis of e3] 3[line break]";
 		say "2[vis of a2][vis of b2][vis of c2][vis of d2][vis of e2] 2[line break]";
 		say "1[vis of a1][vis of b1][vis of c1][vis of d1][vis of e1] 1[line break]";
-		say "   a b c d e[variable letter spacing][line break]";
+		say "  a b c d e[variable letter spacing][line break]";
 		say "You've visited [number of circle-visited rooms] of [5b]'s twenty-five precincts.";
 	else:
 		say "Reserved pieces to (C)all: [list of reserved pieces].";
@@ -672,7 +690,6 @@ volume beta testing - not for release

 when play begins:
 	now in-beta is true;
-	say "(DEBUG ONLY NOTE: in-beta is true. The RR command may save time for the three machines.)[paragraph break]";

 chapter boarding

@@ -692,6 +709,7 @@ carry out boarding:
 volume testing - not for release

 when play begins:
+	say "This should not show up in beta mode. It is a rule to toggle the debug-state truth state.";
 	now debug-state is true;

 chapter stupid stuff
commit acb4bfe26d0833114aa35c07a960472b1786f6a1
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 06:29:04 2021 -0500

    add exceptions for ways I don't want the player to win

diff --git a/story.ni b/story.ni
index e9c5aa7..6ca5a7c 100644
--- a/story.ni
+++ b/story.ni
@@ -330,6 +330,12 @@ understand "c [any piece]" as calling.
 understand "place [any piece]" as calling.
 understand "p [any piece]" as calling.

+this is the enemy-placement rule:
+	if number of reserved pieces > 1:
+		say "You probably don't want to summon the enemy king until last. He'd get really suspicious if you just made him wait around." instead;
+	if absval of (x of location of enemy king - x of location of enemy king) < 2 and absval of (y of location of enemy king - y of location of enemy king) < 2:
+		say "Wait, no, you can't put the enemy kings adjacent to each other, not even diagonally. Well, you could, but your king would be at risk, somehow." instead;
+
 carry out calling:
 	if quest-index is 4, say "You're on your own now." instead;
 	if noun is placed:
@@ -338,8 +344,8 @@ carry out calling:
 		say "Right now [the noun] is not part of your maneuver." instead;
 	if number of pieces in location of player > 0:
 		say "That would make things too crowded here. You already called [random piece in location of player] here." instead;
-	if noun is enemy king and number of reserved pieces > 1:
-		say "You probably don't want to summon the enemy king until last. He'd get really suspicious if you just made him wait around." instead;
+	if noun is enemy king:
+		abide by the enemy-placement rule;
 	say "You call [the noun] to [location of player].";
 	if in-beta is true:
 		say "(for beta testers) full position...";
@@ -454,9 +460,25 @@ this is the checkmate processing rule:
 	if the location of the enemy king is not surrounded:
 		say "The enemy king regards you suspiciously. He knows something is up. But then he runs away via [a random king-escape room]!";
 		the rule fails;
+	if quest-index is 2:
+		let qx be absval of (x of location of queen - x of location of enemy king);
+		let qy be absval of (y of location of queen - y of location of enemy king);
+		if qx < 2 and qy < 2:
+			say "Alas, a kink in your plans! The queen refuses, REFUSES to get close to that horrid enemy king. You thought you had things planned out well, but--well, you didn't. You'll have to try another way to get people together.";
+			the rule fails;
+		if location of enemy king is cornery:
+			say "Before you can summon the enemy king over, though, your allies call you by. That's a good formation, but maybe you will use it better in the future. It won't be a surprise if you use it twice. You take notes.";
+			the rule fails;
 	say "The enemy king looks around, then runs one way, then another. Slowly it dawns on him. He is trapped! The end is not pretty.";
 	the rule succeeds;

+[?? what if random flight square, a piece is on it]
+
+definition: a room (called r) is cornery:
+	unless x of r is 4 or x of r is 0, no;
+	unless y of r is 4 or y of r is 0, no;
+	yes;
+
 to decide which number is absval of (n - a number):
 	if n > 0, decide on n;
 	decide on 0 - n;
commit 1cbc94c29558bbcc6264ff7a0e5dfbf27dce3594
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 06:28:33 2021 -0500

    CHESS verb

diff --git a/story.ni b/story.ni
index 1545c24..e9c5aa7 100644
--- a/story.ni
+++ b/story.ni
@@ -539,6 +539,26 @@ carry out abouting:
 	say "This game was originally written for ParserComp 2021.[paragraph break]I'd always sort of had an idea to write up a game about chess, especially after playing Zork Zero, but I never quite found one that could be simple enough for people who didn't play and worthwhile enough for those who did. And even if it did balance these, where was the story?[paragraph break]I wasn't expecting one to pop up. The resurgence of chess online with COVID, along with tournaments like PogChamps, reminded me that there was a lot more to chess than twenty-move-deep theoretical slogs.[paragraph break]But one evening, something came into form. And as ParserComp's deadline came up, my bigger plan had stalled, so why not bail out?[paragraph break]I like parser games with weird directions. So I tried to make one.[paragraph break]Thankfully, I was able to find something that worked, technically, and it had the shell of a story, too. And I hope you enjoy this, too, whether or not you play chess.";
 	the rule succeeds.

+chapter chessing
+
+chessing is an action applying to nothing.
+
+understand the command "chess" as something new.
+understand the command "ch" as something new.
+
+understand "chess" as chessing.
+understand "ch" as chessing.
+
+carry out chessing:
+	say "Pawns and bishops do not appear in this game, so don't worry about them.";
+	say "Knights (that's you) move one square vertically and two squares horizontally.";
+	say "Rooks can move vertically or horizontally until there is an obstruction.";
+	say "Queens can move vertically or horizontally or diagonally until there is an obstruction.";
+	say "Kings can move one square adjacent, vertically or horizontally or diagonally, unless there is an obstruction.";
+	say "Check occurs when one piece is attacking your king.";
+	say "Checkmate is when you attack the enemy's king and he has no safe squares.";
+	the rule succeeds.
+
 chapter creditsing

 creditsing is an action applying to nothing.
@@ -620,6 +640,7 @@ carry out verbsing:
 	say "You can also [b]CALL[r] allies or the [5b]n king.";
 	say "There's also this one, [b]VERBS[r], of course, and you can type [b]ABOUT[r]/[b]A[r] and [b]CREDITS[r]/[b]C[r] for general game information and thanks.";
 	say "You also have the option of toggling abbrevation of long directions with [b]ABB[r].";
+	say "If you want a rules refresher, [b]CHESS[r] or [b]CH[r] will teach you all you need to know. Don't worry--you won't be quizzed on en passant!";
 	if in-beta is true:
 		say "Beta testers also have the option to see the [b]BOARD[r] at any time.";
 	say "Also, you can often use abbreviations for nouns, e.g. Q for the queen or KR for the kingside rook.";
commit 9b74f7dde488b97a5c2337d50efa9f03de36ba0c
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 05:27:14 2021 -0500

    more shortcuts

diff --git a/story.ni b/story.ni
index 6398f19..1545c24 100644
--- a/story.ni
+++ b/story.ni
@@ -1,4 +1,4 @@
-"Fivebyfivia Delanda Est" by Andrew Schultz
+"Fivebyfivia Delenda Est" by Andrew Schultz

 volume basics and definitions

@@ -19,19 +19,20 @@ quest-index is a number that varies. quest-index is 1.
 chapter start of play

 when play begins:
-	say "Peace treaties get old and boring and stuffy after a while, y'know? They don't exactly keep up with the times. History changes. Perhaps the wimps who got a CLEAR bargain from the peace treaty don't deserve it any more.[paragraph break]That's definitely the case with [5b]. They've had fun for long enough. Besides, [12b] was called Elshapium when the treaty was signed, and now annexing [5b] would just about make a nice new square tidy country, pleasing to look at on a map.[paragraph break]Besides, if [12b] doesn't annex [5b], some far less civilized nation will. It's for their own good. Especially since gold and precious metals were discovered.[paragraph break]Thankfully, the [12b] spy ministry has devised a cunning plan to make sure things go as well as they can for [5b]. And you, a knight with a crazy (and crazy fast) horse, are just the person to help execute it! The old [5b]n king will never suspect you.[paragraph break]A solemn minister hands you a scroll entitled [FIVEBYFIVIA DELANDA EST]. And you're off!";
+	say "Peace treaties get old and boring and stuffy after a while, y'know? They don't exactly keep up with the times. History changes. Perhaps the wimps who got a CLEAR bargain from the peace treaty don't deserve it any more.[paragraph break]That's definitely the case with [5b]. They've had fun for long enough. Besides, [12b] was called Elshapium when the treaty was signed, and now annexing [5b] would just about make a nice new square tidy country, pleasing to look at on a map.[paragraph break]Besides, if [12b] doesn't annex [5b], some far less civilized nation will. It's for their own good. Especially since gold and precious metals were discovered.[paragraph break]Thankfully, the [12b] spy ministry has devised a cunning plan to make sure things go as well as they can for [5b]. And you, a knight with a crazy (and crazy fast) horse, are just the person to help execute it! The old [5b]n king will never suspect you.[paragraph break]A solemn minister hands you a scroll entitled [FIVEBYFIVIA DELENDA EST]. And you're off!";
 	now right hand status line is "[entry quest-index of quest-quick-desc]";

-chapter FIVEBYFIVIA DELANDA EST
+chapter FIVEBYFIVIA DELENDA EST

-FIVEBYFIVIA DELANDA EST is a thing. the player carries FIVEBYFIVIA DELANDA EST. description of DELANDA is "FIVEBYFIVIA DELANDA EST contains the instructions for your current quest. Right now, it seems you need to [current-quest-text].".
+FIVEBYFIVIA DELENDA EST is a thing. the player carries FIVEBYFIVIA DELENDA EST. description of DELENDA is "FIVEBYFIVIA DELENDA EST contains the instructions for your current quest. Right now, it seems you need to [current-quest-text].".

-understand "dfe" as delanda.
-understand "est" as delanda.
-understand "del" as delanda.
+understand "fde" as DELENDA.
+understand "est" as DELENDA.
+understand "del" as DELENDA.
+understand "scroll" as DELENDA.

-after examining DELANDA for the first time:
-	say "You may wish to shorten typing a long name for [delanda] with DFE, EST, or DEL. Save your thinking cells for the tough parts."
+after examining DELENDA for the first time:
+	say "You may wish to shorten typing a long name for [delenda] with DFE, EST, or DEL. Save your thinking cells for the tough parts."

 to say current-quest-text:
 	if quest-index is 4:
@@ -42,14 +43,12 @@ to say current-quest-text:
 to say age-of:
 	say "[if quest-index is 1]old[else if quest-index is 2]middle-aged[else]young[end if]"

-understand "scroll" as DELANDA. understand "def" as DELANDA.
-
-check dropping DELANDA:
+check dropping DELENDA:
 	say "And let such a valuable document fall into the wrong hands? Certainly not!" instead;

-instead of doing something with DELANDA:
+instead of doing something with DELENDA:
 	if the current action is examining, continue the action;
-	say "You can really only examine [DELANDA].";
+	say "You can really only examine [DELENDA].";

 your horse is a backdrop. Your horse is everywhere. understand "steed" as horse.

@@ -297,23 +296,23 @@ definition: a piece (called p) is offensive:
 	if p is irrelevant, no;
 	yes;

-the friendly king is a piece. understand "k" and "k1" as friendly king.
+the friendly king is a piece. understand "k" and "k1" and "fk" as friendly king.

 summon-list of friendly king is { false, true, true, false }.

-the enemy king is a piece. understand "k" and "k2" as enemy king.
+the enemy king is a piece. understand "k" and "k2" and "ek" as enemy king.

 summon-list of enemy king is { true, true, true, false }.

-the queen is a female piece.
+the queen is a female piece. understand "q" as queen.

 summon-list of queen is { false, true, false, false }.

-the kingside rook is a neuter piece.
+the kingside rook is a neuter piece. understand "kr" as kingside rook. understand "r" as kingside rook.

 summon-list of kingside rook is { true, false, true, false }.

-the queenside rook is a neuter piece.
+the queenside rook is a neuter piece. understand "qr" as queenside rook. understand "r" as queenside rook.

 summon-list of queenside rook is { true, false, false, false }.

@@ -500,10 +499,13 @@ rule for printing a parser error:
 rule for printing a parser error when the latest parser error is the noun did not make sense in that context error:
 	say "The verb was okay, but I didn't understand the noun in that sentence. Please try again, or type [b]V[r] to see the list of commands."

+rule for printing a parser error when the latest parser error is the only understood as far as error:
+	say "You only needed the first word of that command. You can use the up arrow and backspace so you don't have to retype."
+
 section score trivia

 check requesting the score:
-	say "You're on quest [quest-index] of [max-quests] right now." instead;
+	say "This game doesn't keep track of scores, but you're on quest [quest-index] of [max-quests] right now." instead;

 The print final score rule is not listed in the for printing the player's obituary rulebook.

@@ -554,8 +556,10 @@ chapter dirsing
 dirsing is an action applying to nothing.

 understand the command "dirs" as something new.
+understand the command "dir" as something new.

 understand "dirs" as dirsing.
+understand "dir" as dirsing.

 carry out dirsing:
 	say "The eight directions are, clockwise from north, northnortheast, northeasteast, southeasteast, southsoutheast, southsouthwest, southwestwest, northwestwest and northnorthwest.";
@@ -614,8 +618,11 @@ understand "v" as verbsing.
 carry out verbsing:
 	say "The main verbs you can use are about going places. You have 8 different diagonal directions, which you can see in detail with [b]DIRS[r].";
 	say "You can also [b]CALL[r] allies or the [5b]n king.";
-	say "There's also this one, [b]VERBS[r], of course, and you can type [b]ABOUT[r] and [b]CREDITS[r] for general game information and thanks.";
+	say "There's also this one, [b]VERBS[r], of course, and you can type [b]ABOUT[r]/[b]A[r] and [b]CREDITS[r]/[b]C[r] for general game information and thanks.";
 	say "You also have the option of toggling abbrevation of long directions with [b]ABB[r].";
+	if in-beta is true:
+		say "Beta testers also have the option to see the [b]BOARD[r] at any time.";
+	say "Also, you can often use abbreviations for nouns, e.g. Q for the queen or KR for the kingside rook.";
 	the rule succeeds.

 volume beta testing - not for release
commit a3b086d9a37f788c9a7706562273bdf961caecb3
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 05:19:37 2021 -0500

    add beta-debugging/board-showing

diff --git a/story.ni b/story.ni
index 0d2bf3c..6398f19 100644
--- a/story.ni
+++ b/story.ni
@@ -4,6 +4,8 @@ volume basics and definitions

 include trivial niceties by Andrew Schultz

+in-beta is a truth state that varies.
+
 debug-state is a truth state that varies.

 to say 12b: say "Twelvebytwelvia"
@@ -340,6 +342,9 @@ carry out calling:
 	if noun is enemy king and number of reserved pieces > 1:
 		say "You probably don't want to summon the enemy king until last. He'd get really suspicious if you just made him wait around." instead;
 	say "You call [the noun] to [location of player].";
+	if in-beta is true:
+		say "(for beta testers) full position...";
+		show-the-board;
 	now need-to-hurry is true;
 	now noun is placed;
 	move noun to location of player;
@@ -356,6 +361,31 @@ carry out calling:
 		setup-next-puzzle;
 	the rule succeeds.

+to show-the-board:
+	say "WHAT'S ON THE BOARD:[line break]";
+	say "[fixed letter spacing]   a b c d e[line break]";
+	say "5[pie of a5][pie of b5][pie of c5][pie of d5][pie of e5] 5[line break]";
+	say "4[pie of a4][pie of b4][pie of c4][pie of d4][pie of e4] 4[line break]";
+	say "3[pie of a3][pie of b3][pie of c3][pie of d3][pie of e3] 3[line break]";
+	say "2[pie of a2][pie of b2][pie of c2][pie of d2][pie of e2] 2[line break]";
+	say "1[pie of a1][pie of b1][pie of c1][pie of d1][pie of e1] 1[line break]";
+	say "   a b c d e[variable letter spacing][line break]";
+
+to say pie of (r - a room):
+	say " ";
+	if kingside rook is in r or queenside rook is in r:
+		say "R";
+	else if queen is in r:
+		say "Q";
+	else if friendly king is in r:
+		say "K";
+	else if enemy king is in r:
+		say "k";
+	else if r is location of player:
+		say "*";
+	else:
+		say "-"
+
 to decide which number is stalemate-count:
 	let temp be 0;
 	repeat with S running through stalemated:
@@ -560,7 +590,7 @@ carry out statsing:
 		say "2[vis of a2][vis of b2][vis of c2][vis of d2][vis of e2] 2[line break]";
 		say "1[vis of a1][vis of b1][vis of c1][vis of d1][vis of e1] 1[line break]";
 		say "   a b c d e[variable letter spacing][line break]";
-		say "The count, then, is [number of circle-visited rooms] square[if location of player is not c3]s[end if].";
+		say "You've visited [number of circle-visited rooms] of [5b]'s twenty-five precincts.";
 	else:
 		say "Reserved pieces to (C)all: [list of reserved pieces].";
 		say "Pieces out on the board: [list of placed pieces].";
@@ -588,6 +618,27 @@ carry out verbsing:
 	say "You also have the option of toggling abbrevation of long directions with [b]ABB[r].";
 	the rule succeeds.

+volume beta testing - not for release
+
+when play begins:
+	now in-beta is true;
+	say "(DEBUG ONLY NOTE: in-beta is true. The RR command may save time for the three machines.)[paragraph break]";
+
+chapter boarding
+
+boarding is an action applying to nothing.
+
+understand the command "board" as something new.
+understand the command "b" as something new.
+
+understand "board" as boarding.
+understand "b" as boarding.
+
+carry out boarding:
+	if quest-index is 4, try statsing instead;
+	show-the-board;
+	the rule succeeds.
+
 volume testing - not for release

 when play begins:
commit 74cfe8c750bde9314108adf320f0973b1a451639
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 05:11:14 2021 -0500

    new "better" ending programmed

diff --git a/story.ni b/story.ni
index 1757314..0d2bf3c 100644
--- a/story.ni
+++ b/story.ni
@@ -1,4 +1,4 @@
-"Delanda Fivebyfivia Est" by Andrew Schultz
+"Fivebyfivia Delanda Est" by Andrew Schultz

 volume basics and definitions

@@ -17,12 +17,12 @@ quest-index is a number that varies. quest-index is 1.
 chapter start of play

 when play begins:
-	say "Peace treaties get old and boring and stuffy after a while, y'know? They don't exactly keep up with the times. History changes. Perhaps the wimps who got a CLEAR bargain from the peace treaty don't deserve it any more.[paragraph break]That's definitely the case with [5b]. They've had fun for long enough. Besides, [12b] was called Elshapium when the treaty was signed, and now annexing [5b] would just about make a nice new square tidy country, pleasing to look at on a map.[paragraph break]Besides, if [12b] doesn't annex [5b], some far less civilized nation will. It's for their own good. Especially since gold and precious metals were discovered.[paragraph break]Thankfully, the [12b] spy ministry has devised a cunning plan to make sure things go as well as they can for [5b].  And you, a knight with a crazy (and crazy fast) horse, are just the person to help execute it! The old [5b]n king will never suspect you.[paragraph break]A solemn minister hands you a scroll entitled [DELANDA FIVEBYFIVIA EST]. And you're off!";
+	say "Peace treaties get old and boring and stuffy after a while, y'know? They don't exactly keep up with the times. History changes. Perhaps the wimps who got a CLEAR bargain from the peace treaty don't deserve it any more.[paragraph break]That's definitely the case with [5b]. They've had fun for long enough. Besides, [12b] was called Elshapium when the treaty was signed, and now annexing [5b] would just about make a nice new square tidy country, pleasing to look at on a map.[paragraph break]Besides, if [12b] doesn't annex [5b], some far less civilized nation will. It's for their own good. Especially since gold and precious metals were discovered.[paragraph break]Thankfully, the [12b] spy ministry has devised a cunning plan to make sure things go as well as they can for [5b]. And you, a knight with a crazy (and crazy fast) horse, are just the person to help execute it! The old [5b]n king will never suspect you.[paragraph break]A solemn minister hands you a scroll entitled [FIVEBYFIVIA DELANDA EST]. And you're off!";
 	now right hand status line is "[entry quest-index of quest-quick-desc]";

-chapter DELANDA FIVEBYFIVIA EST
+chapter FIVEBYFIVIA DELANDA EST

-DELANDA FIVEBYFIVIA EST is a thing. the player carries DELANDA FIVEBYFIVIA EST. description of DELANDA is "DELANDA FIVEBYFIVIA EST contains the instructions for your current quest. Right now, it seems you need to [current-quest-text].".
+FIVEBYFIVIA DELANDA EST is a thing. the player carries FIVEBYFIVIA DELANDA EST. description of DELANDA is "FIVEBYFIVIA DELANDA EST contains the instructions for your current quest. Right now, it seems you need to [current-quest-text].".

 understand "dfe" as delanda.
 understand "est" as delanda.
@@ -73,7 +73,7 @@ to say room-color:

 to say room-detail:
 	if location of player is c3:
-		say "From here, your horse can bolt in any of the crazy directions it likes to zoom off. Hooray, freedom! Well, for you, not for [5b]";
+		say "From here, your horse can bolt in any of the eight crazy directions it likes to zoom off. Hooray, freedom! Well, for you, not for [5b]";
 		continue the action;
 	say "You can go [list of viable directions]";

@@ -102,7 +102,7 @@ section timed-going

 after going when need-to-hurry is true:
 	increment current-turns-after-placing;
-	if debug-state is true, say  "[current-turns-after-placing] of [max-turns-after-placing].";
+	if debug-state is true, say "[current-turns-after-placing] of [max-turns-after-placing].";
 	if current-turns-after-placing > max-turns-after-placing:
 		if enemy king is placed:
 			say "You hear a noise and look around. The enemy king, disgusted at having his time wasted without meeting anyone, retreats. Perhaps he suspects something. Perhaps he does not.";
@@ -284,7 +284,6 @@ max-wait-times is a list of numbers variable. max-wait-times is { 3, 3, 3, 0 }.

 stalemated is a list of truth states variable. stalemated is { False, False, False, False }.

-
 quest-quick-desc is a list of text variable. quest-quick-desc is { "R & R", "K & Q vs K", "K & R vs K", "Tour" }

 chapter pieces
@@ -344,21 +343,37 @@ carry out calling:
 	now need-to-hurry is true;
 	now noun is placed;
 	move noun to location of player;
-	if number of reserved pieces is 0:
-		consider the checkmate processing rule;
+	if number of reserved pieces > 0, the rule succeeds;
+	consider the stalemate processing rule;
+	if the rule succeeded:
+		increment quest-index;
+		setup-next-puzzle;
+		the rule succeeds;
+	consider the checkmate processing rule;
 	if the rule failed, reset-the-board;
 	if the rule succeeded:
 		increment quest-index;
 		setup-next-puzzle;
 	the rule succeeds.

+to decide which number is stalemate-count:
+	let temp be 0;
+	repeat with S running through stalemated:
+		if S is True, increment temp;
+	decide on temp;
+
 after printing the locale description when quest-index is 4:
 	now location of player is circle-visited;
 	say "[number of circle-visited rooms] vs [number of not circle-visited rooms].";
 	if number of not circle-visited rooms < 5:
 		say "[list of not circle-visited rooms].";
 	if number of circle-visited rooms is 25:
-		say "You win! Sort of.";
+		say "Horns blare! Voices soar to the sky! You have trampled all of [5b], literally and figuratively! Now is time for your reward!";
+		let t be stalemate-count;
+		if stalemate-count is 3:
+			say "Because of the lack of blood, other nations shake their head at [12b]'s annexation of [5b], but what can they do? Your discretion went above and beyond what the king and queen required of you. They delegate you to plan annexation of west, central and east Twelvebyfouria to the south. Each requires a slightly different solution: first, you take two knights, which people say couldn't be done -- but you did it! While they are shaking their heads in disbelief, you sweep in with a bishop and up-and-comer knight, then two bishops.[paragraph break]You grow old and fat and wise and powerful enough so nobody has the courage to mention you are too old and fat to ride your super-fast horse. Besides, they don't have the time, because they're always mentioning how powerful you are.";
+		else:
+			say "But the blood is traced back to you. Even if it was the royalty that did the work. Somehow, a blood-soaked garment ... you are turned over to an intenational medieval crime court as a sacrifice. Somehow, the royal family convinced everyone you and your crazy-moving horse acted on its own, before they could dissuade you. But on the bright side, your day of martyry is a national holiday every year.";
 		end the story;

 does the player mean calling a reserved piece: it is very likely.
@@ -391,16 +406,24 @@ to reset-the-board:
 	now current-turns-after-placing is 0;
 	now need-to-hurry is false.

+this is the stalemate processing rule:
+	unless the location of the enemy king is not checked and the location of the enemy king is surrounded, the rule fails;
+	say "The enemy king looks around. He sighs in relief, safe at the moment. But he is a busy man! He needs to get up and do things. Every which way he looks, though, he realize he's being watched. He quickly looks from left to right but surrenders.[paragraph break]Since nobody was directly attacking him, nobody gets the kill. He's taken prisoner. Everyone else looks at you funny.";
+	now entry quest-index in stalemated is True;
+	the rule succeeds;
+
+definition: a room (called rm) is king-escape:
+	if (absval of x of rm - x of location of enemy king) > 1, no;
+	if (absval of y of rm - y of location of enemy king) > 1, no;
+	if rm is checked, no;
+	yes;
+
 this is the checkmate processing rule:
-	let b1 be whether or not the location of the enemy king is checked;
-	let b2 be whether or not the location of the enemy king is surrounded;
-	if b1 is false:
-		if b2 is true:
-			say "Stalemate!";
-			say "The enemy king looks around and flees, unharmed.";
+	if the location of the enemy king is not checked:
+		say "The enemy king looks at you funny. What did you bring him here for? Time's a-wasting. He shuffles off back to his palace.";
 		the rule fails;
-	if b2 is false:
-		say "The enemy king looks around, panicked. He realizes he's in a bit of trouble, but he manages to flee.";
+	if the location of the enemy king is not surrounded:
+		say "The enemy king regards you suspiciously. He knows something is up. But then he runs away via [a random king-escape room]!";
 		the rule fails;
 	say "The enemy king looks around, then runs one way, then another. Slowly it dawns on him. He is trapped! The end is not pretty.";
 	the rule succeeds;
@@ -442,7 +465,7 @@ definition: a room (called r) is surrounded:
 volume meta

 rule for printing a parser error:
-	say "I didn't recognize that command. Type [b]V[r] to see the list of commands."
+	say "I didn't recognize that command. Type [b]V[r] or [b]VERB[r] or [b]VERBS[r] to see the list of commands."

 rule for printing a parser error when the latest parser error is the noun did not make sense in that context error:
 	say "The verb was okay, but I didn't understand the noun in that sentence. Please try again, or type [b]V[r] to see the list of commands."
@@ -481,7 +504,7 @@ understand the command "a" as something new.
 understand "a" as abouting.

 carry out abouting:
-	say "This game was originally written for ParserComp 2021.[paragraph break]I'd always sort of had an idea to write up a game about chess, especially after playing Zork Zero, but I never quite found one that could be simple enough for people who didn't play and worthwhile enough for those who did. And even if it did balance these, where was the story?[paragraph break]I wasn't expecting one to pop up. The resurgence of chess online with COVID, along with tournaments like PogChamps, reminded me that there was a lot more to chess than twenty-move-deep theoretical slogs.[paragraph break]But one evening, something came into form. And as ParserComp's deadline came up, my bigger plan had stalled, so why not bail out?[paragraph break]I like parser games with weird directions. So I tried to make one.[paragraph break]Thankfully, I was able to find something that worked, technically, and it had the shell of a story, too.  And I hope you enjoy this, too, whether or not you play chess.";
+	say "This game was originally written for ParserComp 2021.[paragraph break]I'd always sort of had an idea to write up a game about chess, especially after playing Zork Zero, but I never quite found one that could be simple enough for people who didn't play and worthwhile enough for those who did. And even if it did balance these, where was the story?[paragraph break]I wasn't expecting one to pop up. The resurgence of chess online with COVID, along with tournaments like PogChamps, reminded me that there was a lot more to chess than twenty-move-deep theoretical slogs.[paragraph break]But one evening, something came into form. And as ParserComp's deadline came up, my bigger plan had stalled, so why not bail out?[paragraph break]I like parser games with weird directions. So I tried to make one.[paragraph break]Thankfully, I was able to find something that worked, technically, and it had the shell of a story, too. And I hope you enjoy this, too, whether or not you play chess.";
 	the rule succeeds.

 chapter creditsing
@@ -552,9 +575,11 @@ verbsing is an action applying to nothing.

 understand the command "verbs" as something new.
 understand the command "verb" as something new.
+understand the command "v" as something new.

 understand "verbs" as verbsing.
 understand "verb" as verbsing.
+understand "v" as verbsing.

 carry out verbsing:
 	say "The main verbs you can use are about going places. You have 8 different diagonal directions, which you can see in detail with [b]DIRS[r].";
commit fe739e48504c71ae019a2c147be66ebdaf340d2c
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 04:39:21 2021 -0500

    stalemate testing plus a few bugs fixed from more aggressive playtesting

diff --git a/story.ni b/story.ni
index 35cb7f3..1757314 100644
--- a/story.ni
+++ b/story.ni
@@ -35,7 +35,7 @@ to say current-quest-text:
 	if quest-index is 4:
 		say "Trample around all twenty-five precincts of [5b] without repeating twice";
 		continue the action;
-	say "Entrap the [age-of] king of [5b] with [list of offensive pieces]"
+	say "entrap the [age-of] king of [5b] with [the list of offensive pieces]"

 to say age-of:
 	say "[if quest-index is 1]old[else if quest-index is 2]middle-aged[else]young[end if]"
@@ -101,14 +101,16 @@ to decide which number is square of (d - a direction):
 section timed-going

 after going when need-to-hurry is true:
-	increment current-max-wait;
-	if this-quest-wait > current-max-wait:
+	increment current-turns-after-placing;
+	if debug-state is true, say  "[current-turns-after-placing] of [max-turns-after-placing].";
+	if current-turns-after-placing > max-turns-after-placing:
 		if enemy king is placed:
 			say "You hear a noise and look around. The enemy king, disgusted at having his time wasted without meeting anyone, retreats. Perhaps he suspects something. Perhaps he does not.";
 		else:
 			say "You hear familiar moans. Your summoned compatriot [if number of placed pieces > 1]s have[else]has[end if] grown impatient. The whole operation was based on stealth, which you did not have this time.";
 		say "[line break]You have failed in your quest, and your king and queen will not be pleased ... unless we pretend this was just a practice run you planned in your head before the real thing. Yes, yes, let's do that. That's how it is.";
 		reset-the-board;
+	continue the action;

 section circle-visited

@@ -278,7 +280,10 @@ volume people and quests

 chapter general lists

-max-wait-times is a list of numbers variable. max-wait-times is { 2, 3, 2, 0 }.
+max-wait-times is a list of numbers variable. max-wait-times is { 3, 3, 3, 0 }.
+
+stalemated is a list of truth states variable. stalemated is { False, False, False, False }.
+

 quest-quick-desc is a list of text variable. quest-quick-desc is { "R & R", "K & Q vs K", "K & R vs K", "Tour" }

@@ -333,8 +338,10 @@ carry out calling:
 		say "Right now [the noun] is not part of your maneuver." instead;
 	if number of pieces in location of player > 0:
 		say "That would make things too crowded here. You already called [random piece in location of player] here." instead;
+	if noun is enemy king and number of reserved pieces > 1:
+		say "You probably don't want to summon the enemy king until last. He'd get really suspicious if you just made him wait around." instead;
 	say "You call [the noun] to [location of player].";
-	now need-to-hurry is false;
+	now need-to-hurry is true;
 	now noun is placed;
 	move noun to location of player;
 	if number of reserved pieces is 0:
@@ -356,6 +363,8 @@ after printing the locale description when quest-index is 4:

 does the player mean calling a reserved piece: it is very likely.

+does the player mean calling the friendly king when friendly king is reserved: it is likely.
+
 to setup-next-puzzle:
 	reset-the-board;
 	repeat with P running through pieces:
@@ -364,9 +373,9 @@ to setup-next-puzzle:
 		else:
 			now P is irrelevant;

-current-max-wait is a number that varies.
+max-turns-after-placing is a number that varies.

-this-quest-wait is a number that varies.
+current-turns-after-placing is a number that varies.

 need-to-hurry is a truth state that varies.

@@ -377,8 +386,9 @@ to reset-the-board:
 	now all placed pieces are reserved;
 	if quest-index is 4:
 		now all rooms are not circle-visited;
-	now current-max-wait is entry quest-index of max-wait-times;
-	now this-quest-wait is 0;
+		now c3 is circle-visited;
+	now max-turns-after-placing is entry quest-index of max-wait-times;
+	now current-turns-after-placing is 0;
 	now need-to-hurry is false.

 this is the checkmate processing rule:
@@ -387,7 +397,6 @@ this is the checkmate processing rule:
 	if b1 is false:
 		if b2 is true:
 			say "Stalemate!";
-		else:
 			say "The enemy king looks around and flees, unharmed.";
 		the rule fails;
 	if b2 is false:
@@ -412,23 +421,21 @@ definition: a room (called r) is checked:
 		let xdelt be absval of x1 - x0;
 		let ydelt be absval of y1 - y0;
 		if q is friendly king:
-			if xdelt > 1 or ydelt > 1, yes;
+			if xdelt <= 1 and ydelt <= 1, yes;
 			next;
 		if q is kingside rook or q is queenside rook:
-			if xdelt > 0 or ydelt > 0, yes;
+			if xdelt is 0 or ydelt is 0, yes;
 			next;
 		if q is queen:
-			if xdelt is 0 or ydelt is 0, next;
-			if absval of xdelt is absval of ydelt, next;
-			no;
-		next;
+			if xdelt is 0 or ydelt is 0, yes;
+			if absval of xdelt is absval of ydelt, yes;
+			next;
 	no;
-	yes;

 definition: a room (called r) is surrounded:
 	repeat with D running through not weird directions:
 		if the room D of r is nothing, next;
-		if the room north of r is checked, next;
+		if the room D of r is checked, next;
 		no;
 	yes;

@@ -564,8 +571,14 @@ when play begins:
 chapter stupid stuff

 test q1 with "ssw/nnw/see/see/call kingside/nww/call queenside/sww/call king".
+test q1s with "nnw/call kingside/ssw/see/call queenside/sww/call king".
+
 test q2 with "sse/call queen/nnw/ssw/call friendly king/nnw/call enemy king".
+test q2s with "nne/call friendly king/sww/sse/call queen/sww/call king".
+
 test q3 with "sww/see/call rook/nnw/call friendly king/ssw/call enemy king".
+test q3s with "sww/call rook/see/call friendly king/nne/sse/call enemy king".
+
 test q4 with "nnw/ssw/sse/nee/nne/nww/sww/sse/see/nne/nnw/sww/ssw/see/nee/nnw/sww/nnw/see/nee/ssw/sse/nww/sww".

 test full with "test q1/test q2/test q3/test q4".
commit 6508c99fae455eb173a6099a56c5e2f7cb30e088
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 02:24:52 2021 -0500

    meta verbs filled in, bugs fixed

diff --git a/story.ni b/story.ni
index c330f22..35cb7f3 100644
--- a/story.ni
+++ b/story.ni
@@ -22,18 +22,24 @@ when play begins:

 chapter DELANDA FIVEBYFIVIA EST

-DELANDA FIVEBYFIVIA EST is a thing. the player carries DELANDA FIVEBYFIVIA EST. "DELANDA FIVEBYFIVIA EST contains the instructions for your current quest. Right now, it seems you need to [current-quest-text]."
+DELANDA FIVEBYFIVIA EST is a thing. the player carries DELANDA FIVEBYFIVIA EST. description of DELANDA is "DELANDA FIVEBYFIVIA EST contains the instructions for your current quest. Right now, it seems you need to [current-quest-text].".
+
+understand "dfe" as delanda.
+understand "est" as delanda.
+understand "del" as delanda.
+
+after examining DELANDA for the first time:
+	say "You may wish to shorten typing a long name for [delanda] with DFE, EST, or DEL. Save your thinking cells for the tough parts."

 to say current-quest-text:
 	if quest-index is 4:
 		say "Trample around all twenty-five precincts of [5b] without repeating twice";
-	else if quest-index is 3:
-		say "Entrap the young king of [5b] with your king and his rook";
-	else if quest-index is 2:
-		say "Entrap the middle-aged king of [5b] with your king and your queen";
-	else if quest-index is 1:
-		say "Entrap the old king of [5b] with the kingside and queenside rooks";
+		continue the action;
+	say "Entrap the [age-of] king of [5b] with [list of offensive pieces]"

+to say age-of:
+	say "[if quest-index is 1]old[else if quest-index is 2]middle-aged[else]young[end if]"
+
 understand "scroll" as DELANDA. understand "def" as DELANDA.

 check dropping DELANDA:
@@ -280,6 +286,11 @@ chapter pieces

 a piece is a kind of person. a piece can be reserved, irrelevant, or placed. a piece is usually irrelevant. a piece has a list of truth state called summon-list.

+definition: a piece (called p) is offensive:
+	if p is enemy king, no;
+	if p is irrelevant, no;
+	yes;
+
 the friendly king is a piece. understand "k" and "k1" as friendly king.

 summon-list of friendly king is { false, true, true, false }.
@@ -305,10 +316,14 @@ chapter calling
 calling is an action applying to one visible thing.

 understand the command "call" as something new.
+understand the command "c" as something new.
 understand the command "place" as something new.
+understand the command "p" as something new.

 understand "call [any piece]" as calling.
+understand "c [any piece]" as calling.
 understand "place [any piece]" as calling.
+understand "p [any piece]" as calling.

 carry out calling:
 	if quest-index is 4, say "You're on your own now." instead;
@@ -419,6 +434,12 @@ definition: a room (called r) is surrounded:

 volume meta

+rule for printing a parser error:
+	say "I didn't recognize that command. Type [b]V[r] to see the list of commands."
+
+rule for printing a parser error when the latest parser error is the noun did not make sense in that context error:
+	say "The verb was okay, but I didn't understand the noun in that sentence. Please try again, or type [b]V[r] to see the list of commands."
+
 section score trivia

 check requesting the score:
@@ -453,6 +474,7 @@ understand the command "a" as something new.
 understand "a" as abouting.

 carry out abouting:
+	say "This game was originally written for ParserComp 2021.[paragraph break]I'd always sort of had an idea to write up a game about chess, especially after playing Zork Zero, but I never quite found one that could be simple enough for people who didn't play and worthwhile enough for those who did. And even if it did balance these, where was the story?[paragraph break]I wasn't expecting one to pop up. The resurgence of chess online with COVID, along with tournaments like PogChamps, reminded me that there was a lot more to chess than twenty-move-deep theoretical slogs.[paragraph break]But one evening, something came into form. And as ParserComp's deadline came up, my bigger plan had stalled, so why not bail out?[paragraph break]I like parser games with weird directions. So I tried to make one.[paragraph break]Thankfully, I was able to find something that worked, technically, and it had the shell of a story, too.  And I hope you enjoy this, too, whether or not you play chess.";
 	the rule succeeds.

 chapter creditsing
@@ -460,12 +482,11 @@ chapter creditsing
 creditsing is an action applying to nothing.

 understand the command "credits" as something new.
-understand the command "c" as something new.

 understand "credits" as creditsing.
-understand "c" as creditsing.

 carry out creditsing:
+	say "<fill in later>";
 	the rule succeeds.

 chapter dirsing
@@ -523,8 +544,10 @@ chapter verbsing
 verbsing is an action applying to nothing.

 understand the command "verbs" as something new.
+understand the command "verb" as something new.

 understand "verbs" as verbsing.
+understand "verb" as verbsing.

 carry out verbsing:
 	say "The main verbs you can use are about going places. You have 8 different diagonal directions, which you can see in detail with [b]DIRS[r].";
commit bca850a7a84c567c5a6c3ca60a3a0cc56bcf4933
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 01:57:59 2021 -0500

    walkthrough first draft

diff --git a/walkthrough.txt b/walkthrough.txt
new file mode 100644
index 0000000..2388486
--- /dev/null
+++ b/walkthrough.txt
@@ -0,0 +1,94 @@
+The solution is not meant to be hard. However, non-chessplayers may find some trickery. Note that you also have to be reasonably quick about checkmating your opponent. You only have three turns from placing the first piece to placing the opponent's king.
+
+Here is one solution for two rooks:
+
++-+-+-+-+-+
+| | | | | |
++-+-+-+-+-+
+| | | | | |
++-+-+-+-+-+
+| | | | | |
++-+-+-+-+-+
+| | |R| | |
++-+-+-+-+-+
+|k| | | |R|
++-+-+-+-+-+
+
+For the queen, there are several possibilities. But 1) she doesn't like getting too close to the opponent's king and 2) if you do things a certain way, it disrupts the next plan.
+
+So this is chessically correct but wrong for the game:
++-+-+-+-+-+
+| | | | | |
++-+-+-+-+-+
+| | | | | |
++-+-+-+-+-+
+| | | |K| |
++-+-+-+-+-+
+| | |Q| | |
++-+-+-+-+-+
+| | |k| | |
++-+-+-+-+-+
+
+So is this:
++-+-+-+-+-+
+| | | | | |
++-+-+-+-+-+
+| | | | | |
++-+-+-+-+-+
+| | | |K| |
++-+-+-+-+-+
+| | | | | |
++-+-+-+-+-+
+| | |Q| |k|
++-+-+-+-+-+
+
+But this is the one that you want:
++-+-+-+-+-+
+| | | | | |
++-+-+-+-+-+
+| | | | | |
++-+-+-+-+-+
+| | | |K| |
++-+-+-+-+-+
+| | | | | |
++-+-+-+-+-+
+|Q| |k| | |
++-+-+-+-+-+
+
+The final quest is a traversal. You need to touch all the squares without going over one twice. This seems like there are so many possibilities, but process of elimination helps.
+
+Also notice movement from and to the corner squares is restricted. Note that the only way to reach a1, s5, e1, or e5 (corner squares,) you must be on c2, b3, c4 or d3 first.
+
+If you go from c2/d3/c4/b3 to a non-corner square, then, you won't be able to visit all the corner squares. But even if you do, the fourth corner square will have no way out.
+
+That simplifies our map a bit. We only have 17 squares to traverse now.
+
++-+-+-+-+-+
+|x| | |2|x|5
++-+-+-+-+-+
+| | |x| | |4
++-+-+-+-+-+
+| |x|1|x| |3
++-+-+-+-+-+
+| | |x| | |2
++-+-+-+-+-+
+|x| | | |x|1
++-+-+-+-+-+
+ a b c d e
+
+Square number 2 doesn't really matter. You can always rotate or flip the chessboard so 2 winds up at d5. From there the only viable squares are b4 and e3. Both work, but with e3, there's an interesting circular whirly motion as all further moves are, in fact, forced.
+
++-+-+-+-+-+
+|x|c|7|2|x|5
++-+-+-+-+-+
+|6|h|x|d|8|4
++-+-+-+-+-+
+|b|x|1|x|3|3
++-+-+-+-+-+
+|g|5|x|9|e|2
++-+-+-+-+-+
+|x|a|f|4|x|1
++-+-+-+-+-+
+ a b c d e
+
+From "h" you can then jump to d3 and then clean out the corner squares.
commit ef2330f51ecf95fe57272c39b6e425cb645c0ed2
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 01:12:44 2021 -0500

    score/progress display trivia

diff --git a/story.ni b/story.ni
index 38b226a..c330f22 100644
--- a/story.ni
+++ b/story.ni
@@ -2,16 +2,23 @@

 volume basics and definitions

+include trivial niceties by Andrew Schultz
+
 debug-state is a truth state that varies.

 to say 12b: say "Twelvebytwelvia"

 to say 5b: say "Fivebyfivia"

+max-quests is a number that varies. max-quests is 4.
+
+quest-index is a number that varies. quest-index is 1.
+
 chapter start of play

 when play begins:
-	say "Peace treaties get old and boring and stuffy after a while, y'know? They don't exactly keep up with the times. History changes. Perhaps the wimps who got a CLEAR bargain from the peace treaty don't deserve it any more.[paragraph break]That's definitely the case with [5b]. They've had fun for long enough. Besides, [12b] was called Elshapium when the treaty was signed, and now annexing [5b] would just about make a nice new square tidy country, pleasing to look at on a map.[paragraph break]Besides, if [12b] doesn't annex [5b], some far less civilized nation will. It's for their own good. Especially since gold and precious metals were discovered.[paragraph break]Thankfully, the [12b] spy ministry has devised a cunning plan to make sure things go as well as they can for [5b].  And you, a knight with a crazy (and crazy fast) horse, are just the person to help execute it! The old [5b]n king will never suspect you.[paragraph break]A solemn minister hands you a scroll entitled [DELANDA FIVEBYFIVIA EST]. And you're off!"
+	say "Peace treaties get old and boring and stuffy after a while, y'know? They don't exactly keep up with the times. History changes. Perhaps the wimps who got a CLEAR bargain from the peace treaty don't deserve it any more.[paragraph break]That's definitely the case with [5b]. They've had fun for long enough. Besides, [12b] was called Elshapium when the treaty was signed, and now annexing [5b] would just about make a nice new square tidy country, pleasing to look at on a map.[paragraph break]Besides, if [12b] doesn't annex [5b], some far less civilized nation will. It's for their own good. Especially since gold and precious metals were discovered.[paragraph break]Thankfully, the [12b] spy ministry has devised a cunning plan to make sure things go as well as they can for [5b].  And you, a knight with a crazy (and crazy fast) horse, are just the person to help execute it! The old [5b]n king will never suspect you.[paragraph break]A solemn minister hands you a scroll entitled [DELANDA FIVEBYFIVIA EST]. And you're off!";
+	now right hand status line is "[entry quest-index of quest-quick-desc]";

 chapter DELANDA FIVEBYFIVIA EST

@@ -263,6 +270,14 @@ when play begins:

 volume people and quests

+chapter general lists
+
+max-wait-times is a list of numbers variable. max-wait-times is { 2, 3, 2, 0 }.
+
+quest-quick-desc is a list of text variable. quest-quick-desc is { "R & R", "K & Q vs K", "K & R vs K", "Tour" }
+
+chapter pieces
+
 a piece is a kind of person. a piece can be reserved, irrelevant, or placed. a piece is usually irrelevant. a piece has a list of truth state called summon-list.

 the friendly king is a piece. understand "k" and "k1" as friendly king.
@@ -285,10 +300,6 @@ the queenside rook is a neuter piece.

 summon-list of queenside rook is { true, false, false, false }.

-quest-index is a number that varies. quest-index is 1.
-
-max-wait-times is a list of numbers variable. max-wait-times is { 2, 3, 2, 0 }.
-
 chapter calling

 calling is an action applying to one visible thing.
@@ -408,6 +419,13 @@ definition: a room (called r) is surrounded:

 volume meta

+section score trivia
+
+check requesting the score:
+	say "You're on quest [quest-index] of [max-quests] right now." instead;
+
+The print final score rule is not listed in the for printing the player's obituary rulebook.
+
 chapter abbing

 abbing is an action applying to nothing.
commit e38da7745f5788ba78289a586c8d78c2ce0c4f63
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 01:11:54 2021 -0500

    show short dirs

diff --git a/story.ni b/story.ni
index 9f1d0a4..38b226a 100644
--- a/story.ni
+++ b/story.ni
@@ -107,13 +107,13 @@ after going to a circle-visited room:

 chapter direction info

-a direction can be normal or weird. a direction is usually normal.
+a direction can be normal or weird. a direction is usually normal. a direction has text called vh-abbrev.

 a direction has a number called yness. yness of a direction is usually 0.

 a direction has a number called xness. xness of a direction is usually 0.

-southsoutheast is a direction. it is weird. northnorthwest is a direction. it is weird.
+southsoutheast is a direction. it is weird. vh-abbrev is "SSE". northnorthwest is a direction. it is weird. vh-abbrev is "NNW".

 xness of southsoutheast is 1. yness of southsoutheast is -2. xness of northnorthwest is -1. yness of northnorthwest is 2.

@@ -123,7 +123,7 @@ understand "sse" and "ses" and "ess" as southsoutheast.

 understand "nnw" and "nwn" and "wnn" as northnorthwest.

-southeasteast is a direction. it is weird. northwestwest is a direction. it is weird.
+southeasteast is a direction. it is weird. vh-abbrev is "SEE". northwestwest is a direction. it is weird. vh-abbrev is "NWW".

 xness of southeasteast is 2. yness of southeasteast is -1. xness of northwestwest is -2. yness of northwestwest is 1.

@@ -133,7 +133,7 @@ understand "see" and "ese" and "ees" as southeasteast.

 understand "nww" and "wnw" and "wwn" as northwestwest.

-southsouthwest is a direction. it is weird. northnortheast is a direction. it is weird.
+southsouthwest is a direction. it is weird. vh-abbrev is "SSW". northnortheast is a direction. it is weird. vh-abbrev is "NNE".

 xness of southsouthwest is -1. yness of southsouthwest is -2. xness of northnortheast is 1. yness of northnortheast is 2.

@@ -143,7 +143,7 @@ understand "ssw" and "sws" and "wss" as southsouthwest.

 understand "nne" and "nen" and "enn" as northnortheast.

-southwestwest is a direction. it is weird. northeasteast is a direction. it is weird.
+southwestwest is a direction. it is weird. vh-abbrev is "SWW". northeasteast is a direction. it is weird. vh-abbrev is "NEE".

 xness of southwestwest is -2. yness of southwestwest is -1. xness of northeasteast is 2. yness of northeasteast is 1.

@@ -153,6 +153,8 @@ understand "sww" and "wsw" and "wws" as southwestwest.

 understand "nee" and "ene" and "een" as northeasteast.

+for printing the name of a weird direction (called d) when show-short-dirs is true: say "[vh-abbrev of d]"
+
 section for posterity

 xness of north is 0. yness of north is 1. xness of south is 0. yness of south is -1. xness of east is 1. yness of east is 0. xness of west is -1. yness of west is 0. xness of northwest is -1. yness of northwest is 1. xness of northeast is 1. yness of northeast is 1. xness of southwest is -1. yness of southwest is -1. xness of southeast is 1. yness of southeast is -1.
@@ -417,8 +419,12 @@ understand "abbrev" as abbing.
 understand "abb" as abbing.

 carry out abbing:
+	now show-short-dirs is whether or not show-short-dirs is false;
+	say "Showing short directions is now [on-off of show-short-dirs].";
 	the rule succeeds.

+show-short-dirs is a truth state that varies.
+
 chapter abouting

 abouting is an action applying to nothing.
commit 95e42fbdeac508bb8aee05b13c03a83f25753ad7
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 00:56:56 2021 -0500

    basic meta-verb sorting-out

diff --git a/story.ni b/story.ni
index 3e7e9e4..9f1d0a4 100644
--- a/story.ni
+++ b/story.ni
@@ -8,6 +8,11 @@ to say 12b: say "Twelvebytwelvia"

 to say 5b: say "Fivebyfivia"

+chapter start of play
+
+when play begins:
+	say "Peace treaties get old and boring and stuffy after a while, y'know? They don't exactly keep up with the times. History changes. Perhaps the wimps who got a CLEAR bargain from the peace treaty don't deserve it any more.[paragraph break]That's definitely the case with [5b]. They've had fun for long enough. Besides, [12b] was called Elshapium when the treaty was signed, and now annexing [5b] would just about make a nice new square tidy country, pleasing to look at on a map.[paragraph break]Besides, if [12b] doesn't annex [5b], some far less civilized nation will. It's for their own good. Especially since gold and precious metals were discovered.[paragraph break]Thankfully, the [12b] spy ministry has devised a cunning plan to make sure things go as well as they can for [5b].  And you, a knight with a crazy (and crazy fast) horse, are just the person to help execute it! The old [5b]n king will never suspect you.[paragraph break]A solemn minister hands you a scroll entitled [DELANDA FIVEBYFIVIA EST]. And you're off!"
+
 chapter DELANDA FIVEBYFIVIA EST

 DELANDA FIVEBYFIVIA EST is a thing. the player carries DELANDA FIVEBYFIVIA EST. "DELANDA FIVEBYFIVIA EST contains the instructions for your current quest. Right now, it seems you need to [current-quest-text]."
@@ -31,7 +36,7 @@ instead of doing something with DELANDA:
 	if the current action is examining, continue the action;
 	say "You can really only examine [DELANDA].";

-your horse is a backdrop. Your horse is everywhere.
+your horse is a backdrop. Your horse is everywhere. understand "steed" as horse.

 instead of doing something with your horse:
 	say "You can really only ride your horse in one of eight directions. To get a refresher on that, type DIRS."
@@ -399,7 +404,59 @@ definition: a room (called r) is surrounded:
 		no;
 	yes;

-volume status
+volume meta
+
+chapter abbing
+
+abbing is an action applying to nothing.
+
+understand the command "abbrev" as something new.
+understand the command "abb" as something new.
+
+understand "abbrev" as abbing.
+understand "abb" as abbing.
+
+carry out abbing:
+	the rule succeeds.
+
+chapter abouting
+
+abouting is an action applying to nothing.
+
+understand the command "about" as something new.
+understand the command "a" as something new.
+
+understand "a" as abouting.
+
+carry out abouting:
+	the rule succeeds.
+
+chapter creditsing
+
+creditsing is an action applying to nothing.
+
+understand the command "credits" as something new.
+understand the command "c" as something new.
+
+understand "credits" as creditsing.
+understand "c" as creditsing.
+
+carry out creditsing:
+	the rule succeeds.
+
+chapter dirsing
+
+dirsing is an action applying to nothing.
+
+understand the command "dirs" as something new.
+
+understand "dirs" as dirsing.
+
+carry out dirsing:
+	say "The eight directions are, clockwise from north, northnortheast, northeasteast, southeasteast, southsoutheast, southsouthwest, southwestwest, northwestwest and northnorthwest.";
+	say "That's a bit long, so you can abbreviate them NNE, NEE, SEE, SSE, SSW, SWW, NWW NNW or any possible permutations. The game will recognize them.";
+	say "You can toggle how the directions appear (long or short) in room descriptions with ABB.";
+	the rule succeeds.

 chapter statsing

@@ -428,16 +485,29 @@ carry out statsing:
 		say "2[vis of a2][vis of b2][vis of c2][vis of d2][vis of e2] 2[line break]";
 		say "1[vis of a1][vis of b1][vis of c1][vis of d1][vis of e1] 1[line break]";
 		say "   a b c d e[variable letter spacing][line break]";
-		say "Visited so far: [number of circle-visited rooms] square[if location of player is not c3]s[end if].";
-	say "Reserved pieces to (C)all: [list of reserved pieces].";
-	say "Pieces out on the board: [list of placed pieces].";
+		say "The count, then, is [number of circle-visited rooms] square[if location of player is not c3]s[end if].";
+	else:
+		say "Reserved pieces to (C)all: [list of reserved pieces].";
+		say "Pieces out on the board: [list of placed pieces].";
 	the rule succeeds.

 after printing the name of a placed piece (called p) when statsing:
 	say "[location of p]"

-when play begins:
-	say "Peace treaties get old and boring and stuffy after a while, y'know? They don't exactly keep up with the times. History changes. Perhaps the wimps who got a CLEAR bargain from the peace treaty don't deserve it any more.[paragraph break]That's definitely the case with [5b]. They've had fun for long enough. Besides, [12b] was called Elshapium when the treaty was signed, and now annexing [5b] would just about make a nice new square tidy country, pleasing to look at on a map.[paragraph break]Besides, if [12b] doesn't annex [5b], some far less civilized nation will. It's for their own good. Especially since gold and precious metals were discovered.[paragraph break]Thankfully, the [12b] spy ministry has devised a cunning plan to make sure things go as well as they can for [5b].  And you, a knight with a crazy (and crazy fast) horse, are just the person to help execute it! The old [5b]n king will never suspect you.[paragraph break]A solemn minister hands you a scroll entitled [DELANDA FIVEBYFIVIA EST]. And you're off!"
+chapter verbsing
+
+verbsing is an action applying to nothing.
+
+understand the command "verbs" as something new.
+
+understand "verbs" as verbsing.
+
+carry out verbsing:
+	say "The main verbs you can use are about going places. You have 8 different diagonal directions, which you can see in detail with [b]DIRS[r].";
+	say "You can also [b]CALL[r] allies or the [5b]n king.";
+	say "There's also this one, [b]VERBS[r], of course, and you can type [b]ABOUT[r] and [b]CREDITS[r] for general game information and thanks.";
+	say "You also have the option of toggling abbrevation of long directions with [b]ABB[r].";
+	the rule succeeds.

 volume testing - not for release

commit 50e71cca17cadff8f4b4458795c1964bda9ebfd3
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 00:44:16 2021 -0500

    DELANDA as item

diff --git a/story.ni b/story.ni
index 69cfb65..3e7e9e4 100644
--- a/story.ni
+++ b/story.ni
@@ -10,7 +10,31 @@ to say 5b: say "Fivebyfivia"

 chapter DELANDA FIVEBYFIVIA EST

-DELANDA FIVEBYFIVIA EST is a thing. the player carries DELANDA FIVEBYFIVIA EST.
+DELANDA FIVEBYFIVIA EST is a thing. the player carries DELANDA FIVEBYFIVIA EST. "DELANDA FIVEBYFIVIA EST contains the instructions for your current quest. Right now, it seems you need to [current-quest-text]."
+
+to say current-quest-text:
+	if quest-index is 4:
+		say "Trample around all twenty-five precincts of [5b] without repeating twice";
+	else if quest-index is 3:
+		say "Entrap the young king of [5b] with your king and his rook";
+	else if quest-index is 2:
+		say "Entrap the middle-aged king of [5b] with your king and your queen";
+	else if quest-index is 1:
+		say "Entrap the old king of [5b] with the kingside and queenside rooks";
+
+understand "scroll" as DELANDA. understand "def" as DELANDA.
+
+check dropping DELANDA:
+	say "And let such a valuable document fall into the wrong hands? Certainly not!" instead;
+
+instead of doing something with DELANDA:
+	if the current action is examining, continue the action;
+	say "You can really only examine [DELANDA].";
+
+your horse is a backdrop. Your horse is everywhere.
+
+instead of doing something with your horse:
+	say "You can really only ride your horse in one of eight directions. To get a refresher on that, type DIRS."

 chapter i6

@@ -413,7 +437,7 @@ after printing the name of a placed piece (called p) when statsing:
 	say "[location of p]"

 when play begins:
-	say "Peace treaties get old and boring and stuffy after a while, y'know? They don't exactly keep up with the times. History changes. Perhaps the wimps who got a CLEAR bargain from the peace treaty don't deserve it any more.[paragraph break]That's definitely the case with [5b]. They've had fun for long enough. Besides, [12b] was called Elshapius when the treaty was signed, and now annexing [5b] would just about make a nice new square tidy country, pleasing to look at on a map.[paragraph break]Besides, if [12b] doesn't annex [5b], some far less civilized nation will. It's for their own good. Especially since gold and precious metals were discovered.[paragraph break]Thankfully, the [12b] spy ministry has devised a cunning plan to make sure things go as well as they can for [5b].  And you, a knight with a crazy (and crazy fast) horse, are just the person to help execute it! The old [5b]n king will never suspect you."
+	say "Peace treaties get old and boring and stuffy after a while, y'know? They don't exactly keep up with the times. History changes. Perhaps the wimps who got a CLEAR bargain from the peace treaty don't deserve it any more.[paragraph break]That's definitely the case with [5b]. They've had fun for long enough. Besides, [12b] was called Elshapium when the treaty was signed, and now annexing [5b] would just about make a nice new square tidy country, pleasing to look at on a map.[paragraph break]Besides, if [12b] doesn't annex [5b], some far less civilized nation will. It's for their own good. Especially since gold and precious metals were discovered.[paragraph break]Thankfully, the [12b] spy ministry has devised a cunning plan to make sure things go as well as they can for [5b].  And you, a knight with a crazy (and crazy fast) horse, are just the person to help execute it! The old [5b]n king will never suspect you.[paragraph break]A solemn minister hands you a scroll entitled [DELANDA FIVEBYFIVIA EST]. And you're off!"

 volume testing - not for release

commit 8f8634c3b355f85ded706c67627942e769b73532
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Fri Jun 18 00:08:59 2021 -0500

    intro and some synonyms

diff --git a/story.ni b/story.ni
index 7129c0d..69cfb65 100644
--- a/story.ni
+++ b/story.ni
@@ -1,9 +1,17 @@
-"Conquering Fivebyfivia" by Andrew Schultz
+"Delanda Fivebyfivia Est" by Andrew Schultz

 volume basics and definitions

 debug-state is a truth state that varies.

+to say 12b: say "Twelvebytwelvia"
+
+to say 5b: say "Fivebyfivia"
+
+chapter DELANDA FIVEBYFIVIA EST
+
+DELANDA FIVEBYFIVIA EST is a thing. the player carries DELANDA FIVEBYFIVIA EST.
+
 chapter i6

 To say character number (N - a number): (- print (char) {N}; -)
@@ -16,14 +24,14 @@ a room has text called room-edge-text.

 offsite is a room. x of offsite is -3. y of offsite is -3.

-the description of a room is usually "[room-color]. You're [room-edge-text of the item described] of Fivebyfivia.[paragraph break][room-detail].".
+the description of a room is usually "[room-color]. You're [room-edge-text of the item described] of [5b].[paragraph break][room-detail].".

 to say room-color:
 	say "The ground is [if the remainder after dividing (x of location of player + y of location of player) by 2 is 0]light[else]dark[end if]er than normal here"

 to say room-detail:
 	if location of player is c3:
-		say "From here, your horse can bolt in any of the crazy directions it likes to zoom off. Hooray, freedom! Well, for you, not for Fivebyfivia";
+		say "From here, your horse can bolt in any of the crazy directions it likes to zoom off. Hooray, freedom! Well, for you, not for [5b]";
 		continue the action;
 	say "You can go [list of viable directions]";

@@ -36,7 +44,7 @@ definition: a direction (called d) is viable:
 section going nowhere

 check going nowhere:
-	say "Your trusty steed won't budge. You grumble for a bit, then realize Fivebyfivia has no [file of noun][square of noun] area. What a piffly country! They should've been taken over long before this. They should feel LUCKY a country as swell as Twelvebytwelvia is plotting to take them over.[paragraph break]Anyway. Another direction, perhaps." instead;
+	say "Your trusty steed won't budge. You grumble for a bit, then realize [5b] has no [file of noun][square of noun] area. What a piffly country! They should've been taken over long before this. They should feel LUCKY a country as swell as [12b] is plotting to take them over.[paragraph break]Anyway. Another direction, perhaps." instead;

 to say file of (d - a direction):
 	let d2 be xness of d + x of location of player;
@@ -373,9 +381,15 @@ chapter statsing

 statsing is an action applying to nothing.

+understand the command "status" as something new.
 understand the command "stats" as something new.
+understand the command "stat" as something new.
+understand the command "st" as something new.

+understand "status" as statsing.
 understand "stats" as statsing.
+understand "st" as statsing.
+understand "stat" as statsing.

 to say vis of (r - a room):
 	say " [if location of player is r]+[else if r is circle-visited]*[else] [end if]";
@@ -398,6 +412,9 @@ carry out statsing:
 after printing the name of a placed piece (called p) when statsing:
 	say "[location of p]"

+when play begins:
+	say "Peace treaties get old and boring and stuffy after a while, y'know? They don't exactly keep up with the times. History changes. Perhaps the wimps who got a CLEAR bargain from the peace treaty don't deserve it any more.[paragraph break]That's definitely the case with [5b]. They've had fun for long enough. Besides, [12b] was called Elshapius when the treaty was signed, and now annexing [5b] would just about make a nice new square tidy country, pleasing to look at on a map.[paragraph break]Besides, if [12b] doesn't annex [5b], some far less civilized nation will. It's for their own good. Especially since gold and precious metals were discovered.[paragraph break]Thankfully, the [12b] spy ministry has devised a cunning plan to make sure things go as well as they can for [5b].  And you, a knight with a crazy (and crazy fast) horse, are just the person to help execute it! The old [5b]n king will never suspect you."
+
 volume testing - not for release

 when play begins:
commit fabfffbf1c38e2fa490670303e757437b6c63444
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Thu Jun 17 22:04:00 2021 -0500

    reset on timed failure

diff --git a/story.ni b/story.ni
index ae26cf5..7129c0d 100644
--- a/story.ni
+++ b/story.ni
@@ -36,7 +36,7 @@ definition: a direction (called d) is viable:
 section going nowhere

 check going nowhere:
-	say "Your trusty steed won't budge. You grumble for a bit, then realize Fivebyfivia has no [file of noun][square of noun] area. Another direction, perhaps." instead;
+	say "Your trusty steed won't budge. You grumble for a bit, then realize Fivebyfivia has no [file of noun][square of noun] area. What a piffly country! They should've been taken over long before this. They should feel LUCKY a country as swell as Twelvebytwelvia is plotting to take them over.[paragraph break]Anyway. Another direction, perhaps." instead;

 to say file of (d - a direction):
 	let d2 be xness of d + x of location of player;
@@ -48,6 +48,18 @@ to say file of (d - a direction):
 to decide which number is square of (d - a direction):
 	decide on 1 + y of location of player + yness of d.

+section timed-going
+
+after going when need-to-hurry is true:
+	increment current-max-wait;
+	if this-quest-wait > current-max-wait:
+		if enemy king is placed:
+			say "You hear a noise and look around. The enemy king, disgusted at having his time wasted without meeting anyone, retreats. Perhaps he suspects something. Perhaps he does not.";
+		else:
+			say "You hear familiar moans. Your summoned compatriot [if number of placed pieces > 1]s have[else]has[end if] grown impatient. The whole operation was based on stealth, which you did not have this time.";
+		say "[line break]You have failed in your quest, and your king and queen will not be pleased ... unless we pretend this was just a practice run you planned in your head before the real thing. Yes, yes, let's do that. That's how it is.";
+		reset-the-board;
+
 section circle-visited

 a room can be circle-visited. a room is usually not circle-visited.
@@ -210,7 +222,7 @@ when play begins:
 				now rn1 is mapped northwestwest of re2;
 	setup-next-puzzle;

-volume people
+volume people and quests

 a piece is a kind of person. a piece can be reserved, irrelevant, or placed. a piece is usually irrelevant. a piece has a list of truth state called summon-list.

@@ -236,6 +248,8 @@ summon-list of queenside rook is { true, false, false, false }.

 quest-index is a number that varies. quest-index is 1.

+max-wait-times is a list of numbers variable. max-wait-times is { 2, 3, 2, 0 }.
+
 chapter calling

 calling is an action applying to one visible thing.
@@ -255,6 +269,7 @@ carry out calling:
 	if number of pieces in location of player > 0:
 		say "That would make things too crowded here. You already called [random piece in location of player] here." instead;
 	say "You call [the noun] to [location of player].";
+	now need-to-hurry is false;
 	now noun is placed;
 	move noun to location of player;
 	if number of reserved pieces is 0:
@@ -283,14 +298,23 @@ to setup-next-puzzle:
 			now P is reserved;
 		else:
 			now P is irrelevant;
-	if location of player is not c3:
-		move player to c3;
+
+current-max-wait is a number that varies.
+
+this-quest-wait is a number that varies.
+
+need-to-hurry is a truth state that varies.

 to reset-the-board:
+	if location of player is not c3:
+		move player to c3;
 	now all pieces are off-stage;
 	now all placed pieces are reserved;
 	if quest-index is 4:
 		now all rooms are not circle-visited;
+	now current-max-wait is entry quest-index of max-wait-times;
+	now this-quest-wait is 0;
+	now need-to-hurry is false.

 this is the checkmate processing rule:
 	let b1 be whether or not the location of the enemy king is checked;
commit ecce3e738c7e5e8a44bbd29d1aa8be45bcbc0ea8
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Thu Jun 17 20:19:07 2021 -0500

    better Can't Go That Way

diff --git a/story.ni b/story.ni
index d853752..ae26cf5 100644
--- a/story.ni
+++ b/story.ni
@@ -4,6 +4,10 @@ volume basics and definitions

 debug-state is a truth state that varies.

+chapter i6
+
+To say character number (N - a number): (- print (char) {N}; -)
+
 chapter room info

 a room has a number called x. a room has a number called y.
@@ -29,6 +33,21 @@ definition: a direction (called d) is viable:
 	if the room d of location of player is nowhere, no;
 	yes;

+section going nowhere
+
+check going nowhere:
+	say "Your trusty steed won't budge. You grumble for a bit, then realize Fivebyfivia has no [file of noun][square of noun] area. Another direction, perhaps." instead;
+
+to say file of (d - a direction):
+	let d2 be xness of d + x of location of player;
+	if d2 < 0:
+		say "[character number 123 + d2]";
+	else:
+		say "[character number 97 + d2]";
+
+to decide which number is square of (d - a direction):
+	decide on 1 + y of location of player + yness of d.
+
 section circle-visited

 a room can be circle-visited. a room is usually not circle-visited.
commit 3200422a26b2674d9d7e4a718d9e2f19a8c431ba
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Thu Jun 17 20:18:56 2021 -0500

    xness and yness defined

diff --git a/story.ni b/story.ni
index 204de4f..d853752 100644
--- a/story.ni
+++ b/story.ni
@@ -41,8 +41,14 @@ chapter direction info

 a direction can be normal or weird. a direction is usually normal.

+a direction has a number called yness. yness of a direction is usually 0.
+
+a direction has a number called xness. xness of a direction is usually 0.
+
 southsoutheast is a direction. it is weird. northnorthwest is a direction. it is weird.

+xness of southsoutheast is 1. yness of southsoutheast is -2. xness of northnorthwest is -1. yness of northnorthwest is 2.
+
 the opposite of southsoutheast is northnorthwest. the opposite of northnorthwest is southsoutheast.

 understand "sse" and "ses" and "ess" as southsoutheast.
@@ -51,6 +57,8 @@ understand "nnw" and "nwn" and "wnn" as northnorthwest.

 southeasteast is a direction. it is weird. northwestwest is a direction. it is weird.

+xness of southeasteast is 2. yness of southeasteast is -1. xness of northwestwest is -2. yness of northwestwest is 1.
+
 the opposite of southeasteast is northwestwest. the opposite of northwestwest is southeasteast.

 understand "see" and "ese" and "ees" as southeasteast.
@@ -59,6 +67,8 @@ understand "nww" and "wnw" and "wwn" as northwestwest.

 southsouthwest is a direction. it is weird. northnortheast is a direction. it is weird.

+xness of southsouthwest is -1. yness of southsouthwest is -2. xness of northnortheast is 1. yness of northnortheast is 2.
+
 the opposite of southsouthwest is northnortheast. the opposite of northnortheast is southsouthwest.

 understand "ssw" and "sws" and "wss" as southsouthwest.
@@ -67,12 +77,18 @@ understand "nne" and "nen" and "enn" as northnortheast.

 southwestwest is a direction. it is weird. northeasteast is a direction. it is weird.

+xness of southwestwest is -2. yness of southwestwest is -1. xness of northeasteast is 2. yness of northeasteast is 1.
+
 the opposite of southwestwest is northeasteast. the opposite of northeasteast is southwestwest.

 understand "sww" and "wsw" and "wws" as southwestwest.

 understand "nee" and "ene" and "een" as northeasteast.

+section for posterity
+
+xness of north is 0. yness of north is 1. xness of south is 0. yness of south is -1. xness of east is 1. yness of east is 0. xness of west is -1. yness of west is 0. xness of northwest is -1. yness of northwest is 1. xness of northeast is 1. yness of northeast is 1. xness of southwest is -1. yness of southwest is -1. xness of southeast is 1. yness of southeast is -1.
+
 chapter direction verbs

 volume rooms
commit 3aa689c2ed65a794e9d7108e1266def09cce101a
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Thu Jun 17 20:04:38 2021 -0500

    room-edge-text filled out

diff --git a/story.ni b/story.ni
index 7932a49..204de4f 100644
--- a/story.ni
+++ b/story.ni
@@ -87,43 +87,43 @@ d1 is a room. x of d1 is 3. y of d1 is 0. room-edge-text is "on the south edge a

 e1 is a room. x of e1 is 4. y of e1 is 0. room-edge-text is "at the relatively inaccessible southeast corner".

-a2 is a room. x of a2 is 0. y of a2 is 1.
+a2 is a room. x of a2 is 0. y of a2 is 1. room-edge-text is "on the west edge and near the south edge".

-b2 is a room. x of b2 is 1. y of b2 is 1.
+b2 is a room. x of b2 is 1. y of b2 is 1. room-edge-text is "in a southwest-ish area".

-c2 is a room. x of c2 is 2. y of c2 is 1.
+c2 is a room. x of c2 is 2. y of c2 is 1. room-edge-text is "just south of the center".

-d2 is a room. x of d2 is 3. y of d2 is 1.
+d2 is a room. x of d2 is 3. y of d2 is 1. room-edge-text is "in a southeast-ish area".

-e2 is a room. x of e2 is 4. y of e2 is 1.
+e2 is a room. x of e2 is 4. y of e2 is 1. room-edge-text is "on the east edge and near the south edge".

-a3 is a room. x of a3 is 0. y of a3 is 2.
+a3 is a room. x of a3 is 0. y of a3 is 2. room-edge-text is "at the center of the west edge".

-b3 is a room. x of b3 is 1. y of b3 is 2.
+b3 is a room. x of b3 is 1. y of b3 is 2. room-edge-text is "just west of the center".

 c3 is a room. x of c3 is 2. y of c3 is 2. room-edge-text is "smack in the center".

-d3 is a room. x of d3 is 3. y of d3 is 2.
+d3 is a room. x of d3 is 3. y of d3 is 2. room-edge-text is "just east of the center".

-e3 is a room. x of e3 is 4. y of e3 is 2.
+e3 is a room. x of e3 is 4. y of e3 is 2. room-edge-text is "at the center of the east edge".

-a4 is a room. x of a4 is 0. y of a4 is 3.
+a4 is a room. x of a4 is 0. y of a4 is 3. room-edge-text is "on the west edge and near the south edge".

-b4 is a room. x of b4 is 1. y of b4 is 3.
+b4 is a room. x of b4 is 1. y of b4 is 3. room-edge-text is "in a southeast-ish area".

-c4 is a room. x of c4 is 2. y of c4 is 3.
+c4 is a room. x of c4 is 2. y of c4 is 3. room-edge-text is "just north of the center".

-d4 is a room. x of d4 is 3. y of d4 is 3.
+d4 is a room. x of d4 is 3. y of d4 is 3. room-edge-text is "in a northeast-ish area".

-e4 is a room. x of e4 is 4. y of e4 is 3.
+e4 is a room. x of e4 is 4. y of e4 is 3. room-edge-text is "on the east edge and near the north edge".

 a5 is a room. x of a5 is 0. y of a5 is 4. room-edge-text is "at the relatively inaccessible northwest corner".

-b5 is a room. x of b5 is 1. y of b5 is 4.
+b5 is a room. x of b5 is 1. y of b5 is 4. room-edge-text is "on the north edge and near the west edge".

-c5 is a room. x of c5 is 2. y of c5 is 4.
+c5 is a room. x of c5 is 2. y of c5 is 4. room-edge-text is "in the center of the north edge".

-d5 is a room. x of d5 is 3. y of d5 is 4.
+d5 is a room. x of d5 is 3. y of d5 is 4. room-edge-text is "on the north edge and near the east edge".

 e5 is a room. x of e5 is 4. y of e5 is 4. room-edge-text is "at the relatively inaccessible northeast corner".

commit 0f7035763a6cb0d4273590647a5e1a4de67480f6
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Thu Jun 17 18:46:19 2021 -0500

    mechanics for basic room description

diff --git a/story.ni b/story.ni
index 3fcbe85..7932a49 100644
--- a/story.ni
+++ b/story.ni
@@ -1,4 +1,4 @@
-"Knight's Errand" by Andrew Schultz
+"Conquering Fivebyfivia" by Andrew Schultz

 volume basics and definitions

@@ -8,8 +8,27 @@ chapter room info

 a room has a number called x. a room has a number called y.

+a room has text called room-edge-text.
+
 offsite is a room. x of offsite is -3. y of offsite is -3.

+the description of a room is usually "[room-color]. You're [room-edge-text of the item described] of Fivebyfivia.[paragraph break][room-detail].".
+
+to say room-color:
+	say "The ground is [if the remainder after dividing (x of location of player + y of location of player) by 2 is 0]light[else]dark[end if]er than normal here"
+
+to say room-detail:
+	if location of player is c3:
+		say "From here, your horse can bolt in any of the crazy directions it likes to zoom off. Hooray, freedom! Well, for you, not for Fivebyfivia";
+		continue the action;
+	say "You can go [list of viable directions]";
+
+definition: a direction (called d) is viable:
+	if d is normal, no;
+	if the room d of location of player is offsite, no;
+	if the room d of location of player is nowhere, no;
+	yes;
+
 section circle-visited

 a room can be circle-visited. a room is usually not circle-visited.
@@ -58,15 +77,15 @@ chapter direction verbs

 volume rooms

-a1 is a room. x of a1 is 0. y of a1 is 0.
+a1 is a room. x of a1 is 0. y of a1 is 0. room-edge-text is "at the relatively inaccessible southwest corner".

-b1 is a room. x of b1 is 1. y of b1 is 0.
+b1 is a room. x of b1 is 1. y of b1 is 0. room-edge-text is "on the south edge and near the west edge".

-c1 is a room. x of c1 is 2. y of c1 is 0.
+c1 is a room. x of c1 is 2. y of c1 is 0. room-edge-text is "in the center of the south edge".

-d1 is a room. x of d1 is 3. y of d1 is 0.
+d1 is a room. x of d1 is 3. y of d1 is 0. room-edge-text is "on the south edge and near the east edge".

-e1 is a room. x of e1 is 4. y of e1 is 0.
+e1 is a room. x of e1 is 4. y of e1 is 0. room-edge-text is "at the relatively inaccessible southeast corner".

 a2 is a room. x of a2 is 0. y of a2 is 1.

@@ -82,7 +101,7 @@ a3 is a room. x of a3 is 0. y of a3 is 2.

 b3 is a room. x of b3 is 1. y of b3 is 2.

-c3 is a room. x of c3 is 2. y of c3 is 2.
+c3 is a room. x of c3 is 2. y of c3 is 2. room-edge-text is "smack in the center".

 d3 is a room. x of d3 is 3. y of d3 is 2.

@@ -98,15 +117,15 @@ d4 is a room. x of d4 is 3. y of d4 is 3.

 e4 is a room. x of e4 is 4. y of e4 is 3.

-d5 is a room. x of d5 is 3. y of d5 is 4.
-
-a5 is a room. x of a5 is 0. y of a5 is 4.
+a5 is a room. x of a5 is 0. y of a5 is 4. room-edge-text is "at the relatively inaccessible northwest corner".

 b5 is a room. x of b5 is 1. y of b5 is 4.

 c5 is a room. x of c5 is 2. y of c5 is 4.

-e5 is a room. x of e5 is 4. y of e5 is 4.
+d5 is a room. x of d5 is 3. y of d5 is 4.
+
+e5 is a room. x of e5 is 4. y of e5 is 4. room-edge-text is "at the relatively inaccessible northeast corner".

 the player is in c3.

@@ -121,7 +140,7 @@ to decide which room is room_of (n1 - a number) and (n2 - a number):
 check going a normal direction:
 	if noun is up, say "Your horse can fly across ground but not over it." instead;
 	if noun is down, say "Your horse isn't built for that." instead;
-	say "Your horse doesn't go in normal directions. It goes in diagonal ones. And not just southeast (SE). Southsoutheast (SSE, ESS, SES) and such." instead;
+	say "Your horse doesn't go in normal directions. It goes in diagonal ones. But not normal ones like southeast (SE). Southsoutheast (SSE, ESS, SES) and, well, 7 others. DIRS gives a full rundown." instead;

 volume initialization

commit 06c971fa42fb0b814cf8a5aa09bc786b1d0594cb
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Thu Jun 17 07:10:49 2021 -0500

    final quest details and such

diff --git a/story.ni b/story.ni
index 033f2bb..3fcbe85 100644
--- a/story.ni
+++ b/story.ni
@@ -10,8 +10,14 @@ a room has a number called x. a room has a number called y.

 offsite is a room. x of offsite is -3. y of offsite is -3.

+section circle-visited
+
 a room can be circle-visited. a room is usually not circle-visited.

+after going to a circle-visited room:
+	say "A groan goes up. You've been here before. Your triumphant tour is cut short.";
+	reset-the-board;
+
 chapter direction info

 a direction can be normal or weird. a direction is usually normal.
@@ -229,6 +235,8 @@ to setup-next-puzzle:
 to reset-the-board:
 	now all pieces are off-stage;
 	now all placed pieces are reserved;
+	if quest-index is 4:
+		now all rooms are not circle-visited;

 this is the checkmate processing rule:
 	let b1 be whether or not the location of the enemy king is checked;
@@ -291,7 +299,20 @@ understand the command "stats" as something new.

 understand "stats" as statsing.

+to say vis of (r - a room):
+	say " [if location of player is r]+[else if r is circle-visited]*[else] [end if]";
+
 carry out statsing:
+	if quest-index is 4:
+		say "VISITED SO FAR:[line break]";
+		say "[fixed letter spacing]   a b c d e[line break]";
+		say "5[vis of a5][vis of b5][vis of c5][vis of d5][vis of e5] 5[line break]";
+		say "4[vis of a4][vis of b4][vis of c4][vis of d4][vis of e4] 4[line break]";
+		say "3[vis of a3][vis of b3][vis of c3][vis of d3][vis of e3] 3[line break]";
+		say "2[vis of a2][vis of b2][vis of c2][vis of d2][vis of e2] 2[line break]";
+		say "1[vis of a1][vis of b1][vis of c1][vis of d1][vis of e1] 1[line break]";
+		say "   a b c d e[variable letter spacing][line break]";
+		say "Visited so far: [number of circle-visited rooms] square[if location of player is not c3]s[end if].";
 	say "Reserved pieces to (C)all: [list of reserved pieces].";
 	say "Pieces out on the board: [list of placed pieces].";
 	the rule succeeds.
commit 92b19c0b428996cb50446517a72cead7cc6ab313
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Thu Jun 17 07:10:26 2021 -0500

    tweaks from playtesting including not printing c3 twice

diff --git a/story.ni b/story.ni
index 59f7e61..033f2bb 100644
--- a/story.ni
+++ b/story.ni
@@ -181,8 +181,10 @@ chapter calling
 calling is an action applying to one visible thing.

 understand the command "call" as something new.
+understand the command "place" as something new.

 understand "call [any piece]" as calling.
+understand "place [any piece]" as calling.

 carry out calling:
 	if quest-index is 4, say "You're on your own now." instead;
@@ -221,7 +223,8 @@ to setup-next-puzzle:
 			now P is reserved;
 		else:
 			now P is irrelevant;
-	move player to c3;
+	if location of player is not c3:
+		move player to c3;

 to reset-the-board:
 	now all pieces are off-stage;
@@ -303,11 +306,13 @@ when play begins:

 chapter stupid stuff

-test q1 with "ssw/nnw/see/see/call kingside/nww/call queenside/sww".
+test q1 with "ssw/nnw/see/see/call kingside/nww/call queenside/sww/call king".
 test q2 with "sse/call queen/nnw/ssw/call friendly king/nnw/call enemy king".
-test q3 with "sww/see/call rook/nnw/place friendly king/ssw/place enemy king".
+test q3 with "sww/see/call rook/nnw/call friendly king/ssw/call enemy king".
 test q4 with "nnw/ssw/sse/nee/nne/nww/sww/sse/see/nne/nnw/sww/ssw/see/nee/nnw/sww/nnw/see/nee/ssw/sse/nww/sww".

+test full with "test q1/test q2/test q3/test q4".
+
 chapter trying

 trying is an action applying to one number.
@@ -319,6 +324,10 @@ understand "try [number]" as trying.
 carry out trying:
 	if number understood < 1 or number understood > 4:
 		say "You need a number between 1 and 4." instead;
+	if quest-index is number understood:
+		say "We're already on that quest.";
+	else:
+		say "Moving to quest [number understood].";
 	now quest-index is number understood;
 	setup-next-puzzle;
 	the rule succeeds.
commit 7d117146f7a046d50fddfcfc149b34e8b91874bb
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jun 16 06:22:00 2021 -0500

    tests now runnable

diff --git a/story.ni b/story.ni
index ac378c1..59f7e61 100644
--- a/story.ni
+++ b/story.ni
@@ -298,6 +298,31 @@ after printing the name of a placed piece (called p) when statsing:

 volume testing - not for release

+when play begins:
+	now debug-state is true;
+
+chapter stupid stuff
+
+test q1 with "ssw/nnw/see/see/call kingside/nww/call queenside/sww".
+test q2 with "sse/call queen/nnw/ssw/call friendly king/nnw/call enemy king".
+test q3 with "sww/see/call rook/nnw/place friendly king/ssw/place enemy king".
+test q4 with "nnw/ssw/sse/nee/nne/nww/sww/sse/see/nne/nnw/sww/ssw/see/nee/nnw/sww/nnw/see/nee/ssw/sse/nww/sww".
+
+chapter trying
+
+trying is an action applying to one number.
+
+understand the command "try" as something new.
+
+understand "try [number]" as trying.
+
+carry out trying:
+	if number understood < 1 or number understood > 4:
+		say "You need a number between 1 and 4." instead;
+	now quest-index is number understood;
+	setup-next-puzzle;
+	the rule succeeds.
+
 chapter waysing

 waysing is an action out of world.
commit a8bddd9af4a81dfaeb00a6446662faa7f02c98da
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jun 16 06:21:51 2021 -0500

    last quest now solvable

diff --git a/story.ni b/story.ni
index b7c7978..ac378c1 100644
--- a/story.ni
+++ b/story.ni
@@ -10,6 +10,8 @@ a room has a number called x. a room has a number called y.

 offsite is a room. x of offsite is -3. y of offsite is -3.

+a room can be circle-visited. a room is usually not circle-visited.
+
 chapter direction info

 a direction can be normal or weird. a direction is usually normal.
@@ -172,7 +174,7 @@ the queenside rook is a neuter piece.

 summon-list of queenside rook is { true, false, false, false }.

-quest-index is a number that varies. quest-index is 0.
+quest-index is a number that varies. quest-index is 1.

 chapter calling

@@ -197,14 +199,23 @@ carry out calling:
 		consider the checkmate processing rule;
 	if the rule failed, reset-the-board;
 	if the rule succeeded:
+		increment quest-index;
 		setup-next-puzzle;
 	the rule succeeds.

+after printing the locale description when quest-index is 4:
+	now location of player is circle-visited;
+	say "[number of circle-visited rooms] vs [number of not circle-visited rooms].";
+	if number of not circle-visited rooms < 5:
+		say "[list of not circle-visited rooms].";
+	if number of circle-visited rooms is 25:
+		say "You win! Sort of.";
+		end the story;
+
 does the player mean calling a reserved piece: it is very likely.

 to setup-next-puzzle:
 	reset-the-board;
-	increment quest-index;
 	repeat with P running through pieces:
 		if entry quest-index of summon-list of P is true:
 			now P is reserved;
commit 47e672806a58b5c66712dd45854844abd19d1567
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jun 16 06:03:39 2021 -0500

    checking in-check, plus board reset

diff --git a/story.ni b/story.ni
index 97ab28b..b7c7978 100644
--- a/story.ni
+++ b/story.ni
@@ -203,12 +203,14 @@ carry out calling:
 does the player mean calling a reserved piece: it is very likely.

 to setup-next-puzzle:
+	reset-the-board;
 	increment quest-index;
 	repeat with P running through pieces:
 		if entry quest-index of summon-list of P is true:
 			now P is reserved;
 		else:
 			now P is irrelevant;
+	move player to c3;

 to reset-the-board:
 	now all pieces are off-stage;
@@ -234,7 +236,8 @@ to decide which number is absval of (n - a number):
 	decide on 0 - n;

 definition: a room (called r) is checked:
-	if r is nowhere, yes;
+	if r is nothing, yes;
+	if r is offsite, yes;
 	let x0 be x of r;
 	let y0 be y of r;
 	repeat with q running through on-stage pieces:
@@ -258,14 +261,10 @@ definition: a room (called r) is checked:
 	yes;

 definition: a room (called r) is surrounded:
-	if the room north of r is not checked, no;
-	if the room south of r is not checked, no;
-	if the room east of r is not checked, no;
-	if the room west of r is not checked, no;
-	if the room northwest of r is not checked, no;
-	if the room northeast of r is not checked, no;
-	if the room southeast of r is not checked, no;
-	if the room southwest of r is not checked, no;
+	repeat with D running through not weird directions:
+		if the room D of r is nothing, next;
+		if the room north of r is checked, next;
+		no;
 	yes;

 volume status
commit 13e672496123806e737418e098a6cabe8b793898
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jun 16 05:45:27 2021 -0500

    checked properties detailed

diff --git a/story.ni b/story.ni
index 3d5f80d..97ab28b 100644
--- a/story.ni
+++ b/story.ni
@@ -229,9 +229,30 @@ this is the checkmate processing rule:
 	say "The enemy king looks around, then runs one way, then another. Slowly it dawns on him. He is trapped! The end is not pretty.";
 	the rule succeeds;

+to decide which number is absval of (n - a number):
+	if n > 0, decide on n;
+	decide on 0 - n;
+
 definition: a room (called r) is checked:
 	if r is nowhere, yes;
+	let x0 be x of r;
+	let y0 be y of r;
 	repeat with q running through on-stage pieces:
+		if q is irrelevant, next;
+		let x1 be x of location of q;
+		let y1 be y of location of q;
+		let xdelt be absval of x1 - x0;
+		let ydelt be absval of y1 - y0;
+		if q is friendly king:
+			if xdelt > 1 or ydelt > 1, yes;
+			next;
+		if q is kingside rook or q is queenside rook:
+			if xdelt > 0 or ydelt > 0, yes;
+			next;
+		if q is queen:
+			if xdelt is 0 or ydelt is 0, next;
+			if absval of xdelt is absval of ydelt, next;
+			no;
 		next;
 	no;
 	yes;
commit 00d29e2587ffb4bfeacb32de51d7021b6032182f
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jun 16 05:42:11 2021 -0500

    CALL and STATS verbs

diff --git a/story.ni b/story.ni
index 9a27bf9..3d5f80d 100644
--- a/story.ni
+++ b/story.ni
@@ -176,14 +176,23 @@ quest-index is a number that varies. quest-index is 0.

 chapter calling

-calling is an action applying to nothing.
+calling is an action applying to one visible thing.

 understand the command "call" as something new.

-understand "call" as calling.
+understand "call [any piece]" as calling.

 carry out calling:
 	if quest-index is 4, say "You're on your own now." instead;
+	if noun is placed:
+		say "You already placed [the noun] at [location of the noun]." instead;
+	if noun is irrelevant:
+		say "Right now [the noun] is not part of your maneuver." instead;
+	if number of pieces in location of player > 0:
+		say "That would make things too crowded here. You already called [random piece in location of player] here." instead;
+	say "You call [the noun] to [location of player].";
+	now noun is placed;
+	move noun to location of player;
 	if number of reserved pieces is 0:
 		consider the checkmate processing rule;
 	if the rule failed, reset-the-board;
@@ -191,6 +200,8 @@ carry out calling:
 		setup-next-puzzle;
 	the rule succeeds.

+does the player mean calling a reserved piece: it is very likely.
+
 to setup-next-puzzle:
 	increment quest-index;
 	repeat with P running through pieces:
@@ -236,6 +247,24 @@ definition: a room (called r) is surrounded:
 	if the room southwest of r is not checked, no;
 	yes;

+volume status
+
+chapter statsing
+
+statsing is an action applying to nothing.
+
+understand the command "stats" as something new.
+
+understand "stats" as statsing.
+
+carry out statsing:
+	say "Reserved pieces to (C)all: [list of reserved pieces].";
+	say "Pieces out on the board: [list of placed pieces].";
+	the rule succeeds.
+
+after printing the name of a placed piece (called p) when statsing:
+	say "[location of p]"
+
 volume testing - not for release

 chapter waysing
commit bac17d57a79c44e5e67b18e85f50cea3b1a2337a
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jun 16 05:41:35 2021 -0500

    2 bug fixes in grid movement setup

diff --git a/story.ni b/story.ni
index d3bf22a..9a27bf9 100644
--- a/story.ni
+++ b/story.ni
@@ -8,7 +8,7 @@ chapter room info

 a room has a number called x. a room has a number called y.

-offsite is a room.
+offsite is a room. x of offsite is -3. y of offsite is -3.

 chapter direction info

@@ -132,8 +132,8 @@ when play begins:
 				now r0 is mapped south of rn1;
 			let rn2 be room_of xval and yval + 2;
 			let re2 be room_of xval + 2 and yval;
-			let re2n1 be room_of xval + 1 and yval + 2;
-			let rn2e1 be room_of xval + 2 and yval + 1;
+			let re2n1 be room_of xval + 2 and yval + 1;
+			let rn2e1 be room_of xval + 1 and yval + 2;
 			if re2n1 is not offsite:
 				now r0 is mapped southwestwest of re2n1;
 				now re2n1 is mapped northeasteast of r0;
commit 57288d16cabfb9f61131ed962222562ce9acfe07
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jun 16 03:42:30 2021 -0500

    definitions for check and surrounding

diff --git a/story.ni b/story.ni
index 0312e49..d3bf22a 100644
--- a/story.ni
+++ b/story.ni
@@ -146,16 +146,17 @@ when play begins:
 			if re2 is not offsite and rn1 is not offsite:
 				now re2 is mapped southeasteast of rn1;
 				now rn1 is mapped northwestwest of re2;
+	setup-next-puzzle;

 volume people

 a piece is a kind of person. a piece can be reserved, irrelevant, or placed. a piece is usually irrelevant. a piece has a list of truth state called summon-list.

-the friendly king is a piece.
+the friendly king is a piece. understand "k" and "k1" as friendly king.

 summon-list of friendly king is { false, true, true, false }.

-the enemy king is a piece.
+the enemy king is a piece. understand "k" and "k2" as enemy king.

 summon-list of enemy king is { true, true, true, false }.

@@ -171,7 +172,69 @@ the queenside rook is a neuter piece.

 summon-list of queenside rook is { true, false, false, false }.

-quest-index is a number that varies. quest-index is 1.
+quest-index is a number that varies. quest-index is 0.
+
+chapter calling
+
+calling is an action applying to nothing.
+
+understand the command "call" as something new.
+
+understand "call" as calling.
+
+carry out calling:
+	if quest-index is 4, say "You're on your own now." instead;
+	if number of reserved pieces is 0:
+		consider the checkmate processing rule;
+	if the rule failed, reset-the-board;
+	if the rule succeeded:
+		setup-next-puzzle;
+	the rule succeeds.
+
+to setup-next-puzzle:
+	increment quest-index;
+	repeat with P running through pieces:
+		if entry quest-index of summon-list of P is true:
+			now P is reserved;
+		else:
+			now P is irrelevant;
+
+to reset-the-board:
+	now all pieces are off-stage;
+	now all placed pieces are reserved;
+
+this is the checkmate processing rule:
+	let b1 be whether or not the location of the enemy king is checked;
+	let b2 be whether or not the location of the enemy king is surrounded;
+	if b1 is false:
+		if b2 is true:
+			say "Stalemate!";
+		else:
+			say "The enemy king looks around and flees, unharmed.";
+		the rule fails;
+	if b2 is false:
+		say "The enemy king looks around, panicked. He realizes he's in a bit of trouble, but he manages to flee.";
+		the rule fails;
+	say "The enemy king looks around, then runs one way, then another. Slowly it dawns on him. He is trapped! The end is not pretty.";
+	the rule succeeds;
+
+definition: a room (called r) is checked:
+	if r is nowhere, yes;
+	repeat with q running through on-stage pieces:
+		next;
+	no;
+	yes;
+
+definition: a room (called r) is surrounded:
+	if the room north of r is not checked, no;
+	if the room south of r is not checked, no;
+	if the room east of r is not checked, no;
+	if the room west of r is not checked, no;
+	if the room northwest of r is not checked, no;
+	if the room northeast of r is not checked, no;
+	if the room southeast of r is not checked, no;
+	if the room southwest of r is not checked, no;
+	yes;

 volume testing - not for release

commit b142f050bb9a6bfff499980affd92051d7e638d3
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jun 16 03:26:34 2021 -0500

    added pieces as a sort of person

diff --git a/story.ni b/story.ni
index a4111ac..0312e49 100644
--- a/story.ni
+++ b/story.ni
@@ -147,6 +147,32 @@ when play begins:
 				now re2 is mapped southeasteast of rn1;
 				now rn1 is mapped northwestwest of re2;

+volume people
+
+a piece is a kind of person. a piece can be reserved, irrelevant, or placed. a piece is usually irrelevant. a piece has a list of truth state called summon-list.
+
+the friendly king is a piece.
+
+summon-list of friendly king is { false, true, true, false }.
+
+the enemy king is a piece.
+
+summon-list of enemy king is { true, true, true, false }.
+
+the queen is a female piece.
+
+summon-list of queen is { false, true, false, false }.
+
+the kingside rook is a neuter piece.
+
+summon-list of kingside rook is { true, false, true, false }.
+
+the queenside rook is a neuter piece.
+
+summon-list of queenside rook is { true, false, false, false }.
+
+quest-index is a number that varies. quest-index is 1.
+
 volume testing - not for release

 chapter waysing
commit bce15f1bc95e966dc36e6c962b008fbe1423c0a9
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jun 16 03:11:20 2021 -0500

    ways test command added with rooms reshuffle

diff --git a/story.ni b/story.ni
index 65a1d1d..a4111ac 100644
--- a/story.ni
+++ b/story.ni
@@ -52,51 +52,51 @@ volume rooms

 a1 is a room. x of a1 is 0. y of a1 is 0.

-a2 is a room. x of a2 is 0. y of a2 is 1.
+b1 is a room. x of b1 is 1. y of b1 is 0.

-a3 is a room. x of a3 is 0. y of a3 is 2.
+c1 is a room. x of c1 is 2. y of c1 is 0.

-a4 is a room. x of a4 is 0. y of a4 is 3.
+d1 is a room. x of d1 is 3. y of d1 is 0.

-a5 is a room. x of a5 is 0. y of a5 is 4.
+e1 is a room. x of e1 is 4. y of e1 is 0.

-b1 is a room. x of b1 is 1. y of b1 is 0.
+a2 is a room. x of a2 is 0. y of a2 is 1.

 b2 is a room. x of b2 is 1. y of b2 is 1.

-b3 is a room. x of b3 is 1. y of b3 is 2.
+c2 is a room. x of c2 is 2. y of c2 is 1.

-b4 is a room. x of b4 is 1. y of b4 is 3.
+d2 is a room. x of d2 is 3. y of d2 is 1.

-b5 is a room. x of b5 is 1. y of b5 is 4.
+e2 is a room. x of e2 is 4. y of e2 is 1.

-c1 is a room. x of c1 is 2. y of c1 is 0.
+a3 is a room. x of a3 is 0. y of a3 is 2.

-c2 is a room. x of c2 is 2. y of c2 is 1.
+b3 is a room. x of b3 is 1. y of b3 is 2.

 c3 is a room. x of c3 is 2. y of c3 is 2.

-c4 is a room. x of c4 is 2. y of c4 is 3.
+d3 is a room. x of d3 is 3. y of d3 is 2.

-c5 is a room. x of c5 is 2. y of c5 is 4.
+e3 is a room. x of e3 is 4. y of e3 is 2.

-d1 is a room. x of d1 is 3. y of d1 is 0.
+a4 is a room. x of a4 is 0. y of a4 is 3.

-d2 is a room. x of d2 is 3. y of d2 is 1.
+b4 is a room. x of b4 is 1. y of b4 is 3.

-d3 is a room. x of d3 is 3. y of d3 is 2.
+c4 is a room. x of c4 is 2. y of c4 is 3.

 d4 is a room. x of d4 is 3. y of d4 is 3.

-d5 is a room. x of d5 is 3. y of d5 is 4.
+e4 is a room. x of e4 is 4. y of e4 is 3.

-e1 is a room. x of e1 is 4. y of e1 is 0.
+d5 is a room. x of d5 is 3. y of d5 is 4.

-e2 is a room. x of e2 is 4. y of e2 is 1.
+a5 is a room. x of a5 is 0. y of a5 is 4.

-e3 is a room. x of e3 is 4. y of e3 is 2.
+b5 is a room. x of b5 is 1. y of b5 is 4.

-e4 is a room. x of e4 is 4. y of e4 is 3.
+c5 is a room. x of c5 is 2. y of c5 is 4.

 e5 is a room. x of e5 is 4. y of e5 is 4.

@@ -139,10 +139,27 @@ when play begins:
 				now re2n1 is mapped northeasteast of r0;
 			if rn2e1 is not offsite:
 				now r0 is mapped southsouthwest of rn2e1;
-				now re2n1 is mapped northnortheast of r0;
+				now rn2e1 is mapped northnortheast of r0;
 			if rn2 is not offsite and re1 is not offsite:
 				now re1 is mapped southsoutheast of rn2;
 				now rn2 is mapped northnorthwest of re1;
 			if re2 is not offsite and rn1 is not offsite:
 				now re2 is mapped southeasteast of rn1;
 				now rn1 is mapped northwestwest of re2;
+
+volume testing - not for release
+
+chapter waysing
+
+waysing is an action out of world.
+
+understand the command "ways" as something new.
+
+understand "ways" as waysing.
+
+carry out waysing:
+	repeat with Q running through weird directions:
+		say "[Q] [the room Q of location of player].";
+	repeat with Q running through { north, south, east, west }:
+		say "[Q] [the room Q of location of player].";
+	the rule succeeds.
commit d529d9ea269c51f066f93312a16c217b917aaebf
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jun 16 03:05:05 2021 -0500

    first try at diagonal direction linking rooms

diff --git a/story.ni b/story.ni
index 1da87b2..65a1d1d 100644
--- a/story.ni
+++ b/story.ni
@@ -120,13 +120,29 @@ volume initialization
 when play begins:
 	repeat with xval running from 0 to 3:
 		repeat with yval running from 0 to 3:
-			let r1 be room_of xval and yval;
-			let r2 be room_of xval + 1 and yval;
-			let r3 be room_of xval and yval + 1;
-			if r1 is offsite, next;
-			if r2 is not offsite:
-				now r1 is mapped west of r2;
-				now r2 is mapped east of r1;
-			if r3 is not offsite:
-				now r3 is mapped north of r1;
-				now r1 is mapped south of r3;
+			let r0 be room_of xval and yval;
+			let re1 be room_of xval + 1 and yval;
+			let rn1 be room_of xval and yval + 1;
+			if r0 is offsite, next; [ shouldn't happen, but ... ]
+			if re1 is not offsite:
+				now r0 is mapped west of re1;
+				now re1 is mapped east of r0;
+			if rn1 is not offsite:
+				now rn1 is mapped north of r0;
+				now r0 is mapped south of rn1;
+			let rn2 be room_of xval and yval + 2;
+			let re2 be room_of xval + 2 and yval;
+			let re2n1 be room_of xval + 1 and yval + 2;
+			let rn2e1 be room_of xval + 2 and yval + 1;
+			if re2n1 is not offsite:
+				now r0 is mapped southwestwest of re2n1;
+				now re2n1 is mapped northeasteast of r0;
+			if rn2e1 is not offsite:
+				now r0 is mapped southsouthwest of rn2e1;
+				now re2n1 is mapped northnortheast of r0;
+			if rn2 is not offsite and re1 is not offsite:
+				now re1 is mapped southsoutheast of rn2;
+				now rn2 is mapped northnorthwest of re1;
+			if re2 is not offsite and rn1 is not offsite:
+				now re2 is mapped southeasteast of rn1;
+				now rn1 is mapped northwestwest of re2;
commit 6010ff068637913b0f89ed347c43b2e8a3946dda
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jun 16 02:08:33 2021 -0500

    block normal directions

diff --git a/story.ni b/story.ni
index 54d9353..1da87b2 100644
--- a/story.ni
+++ b/story.ni
@@ -12,7 +12,9 @@ offsite is a room.

 chapter direction info

-southsoutheast is a direction. northnorthwest is a direction.
+a direction can be normal or weird. a direction is usually normal.
+
+southsoutheast is a direction. it is weird. northnorthwest is a direction. it is weird.

 the opposite of southsoutheast is northnorthwest. the opposite of northnorthwest is southsoutheast.

@@ -20,7 +22,7 @@ understand "sse" and "ses" and "ess" as southsoutheast.

 understand "nnw" and "nwn" and "wnn" as northnorthwest.

-southeasteast is a direction. northwestwest is a direction.
+southeasteast is a direction. it is weird. northwestwest is a direction. it is weird.

 the opposite of southeasteast is northwestwest. the opposite of northwestwest is southeasteast.

@@ -28,7 +30,7 @@ understand "see" and "ese" and "ees" as southeasteast.

 understand "nww" and "wnw" and "wwn" as northwestwest.

-southsouthwest is a direction. northnortheast is a direction.
+southsouthwest is a direction. it is weird. northnortheast is a direction. it is weird.

 the opposite of southsouthwest is northnortheast. the opposite of northnortheast is southsouthwest.

@@ -36,7 +38,7 @@ understand "ssw" and "sws" and "wss" as southsouthwest.

 understand "nne" and "nen" and "enn" as northnortheast.

-southwestwest is a direction. northeasteast is a direction.
+southwestwest is a direction. it is weird. northeasteast is a direction. it is weird.

 the opposite of southwestwest is northeasteast. the opposite of northeasteast is southwestwest.

@@ -108,6 +110,11 @@ to decide which room is room_of (n1 - a number) and (n2 - a number):
 		say "Could not find room for [n1] and [n2].";
 	decide on offsite

+check going a normal direction:
+	if noun is up, say "Your horse can fly across ground but not over it." instead;
+	if noun is down, say "Your horse isn't built for that." instead;
+	say "Your horse doesn't go in normal directions. It goes in diagonal ones. And not just southeast (SE). Southsoutheast (SSE, ESS, SES) and such." instead;
+
 volume initialization

 when play begins:
commit d8150aabc176d073cfcbe53f551dedbf359e6491
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jun 16 01:57:29 2021 -0500

    established weird directions

diff --git a/story.ni b/story.ni
index ea29bff..54d9353 100644
--- a/story.ni
+++ b/story.ni
@@ -4,10 +4,48 @@ volume basics and definitions

 debug-state is a truth state that varies.

+chapter room info
+
 a room has a number called x. a room has a number called y.

 offsite is a room.

+chapter direction info
+
+southsoutheast is a direction. northnorthwest is a direction.
+
+the opposite of southsoutheast is northnorthwest. the opposite of northnorthwest is southsoutheast.
+
+understand "sse" and "ses" and "ess" as southsoutheast.
+
+understand "nnw" and "nwn" and "wnn" as northnorthwest.
+
+southeasteast is a direction. northwestwest is a direction.
+
+the opposite of southeasteast is northwestwest. the opposite of northwestwest is southeasteast.
+
+understand "see" and "ese" and "ees" as southeasteast.
+
+understand "nww" and "wnw" and "wwn" as northwestwest.
+
+southsouthwest is a direction. northnortheast is a direction.
+
+the opposite of southsouthwest is northnortheast. the opposite of northnortheast is southsouthwest.
+
+understand "ssw" and "sws" and "wss" as southsouthwest.
+
+understand "nne" and "nen" and "enn" as northnortheast.
+
+southwestwest is a direction. northeasteast is a direction.
+
+the opposite of southwestwest is northeasteast. the opposite of northeasteast is southwestwest.
+
+understand "sww" and "wsw" and "wws" as southwestwest.
+
+understand "nee" and "ene" and "een" as northeasteast.
+
+chapter direction verbs
+
 volume rooms

 a1 is a room. x of a1 is 0. y of a1 is 0.
commit c366e17c11d16fc4a7c61362cb5262ad0397f268
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jun 16 01:33:56 2021 -0500

    offsite room added for (probably unnecessary) checks

diff --git a/story.ni b/story.ni
index a08b73c..ea29bff 100644
--- a/story.ni
+++ b/story.ni
@@ -1,9 +1,15 @@
 "Knight's Errand" by Andrew Schultz

+volume basics and definitions
+
 debug-state is a truth state that varies.

 a room has a number called x. a room has a number called y.

+offsite is a room.
+
+volume rooms
+
 a1 is a room. x of a1 is 0. y of a1 is 0.

 a2 is a room. x of a2 is 0. y of a2 is 1.
@@ -54,12 +60,17 @@ e4 is a room. x of e4 is 4. y of e4 is 3.

 e5 is a room. x of e5 is 4. y of e5 is 4.

+the player is in c3.
+
 to decide which room is room_of (n1 - a number) and (n2 - a number):
 	repeat with Q running through rooms:
 		if x of Q is n1 and y of Q is n2:
 			decide on Q;
 	if debug-state is true:
 		say "Could not find room for [n1] and [n2].";
+	decide on offsite
+
+volume initialization

 when play begins:
 	repeat with xval running from 0 to 3:
@@ -67,7 +78,10 @@ when play begins:
 			let r1 be room_of xval and yval;
 			let r2 be room_of xval + 1 and yval;
 			let r3 be room_of xval and yval + 1;
-			now r1 is mapped west of r2;
-			now r2 is mapped east of r1;
-			now r3 is mapped north of r1;
-			now r1 is mapped south of r3;
+			if r1 is offsite, next;
+			if r2 is not offsite:
+				now r1 is mapped west of r2;
+				now r2 is mapped east of r1;
+			if r3 is not offsite:
+				now r3 is mapped north of r1;
+				now r1 is mapped south of r3;
commit cbc3f6adba368c91246e032075e5f39ee877b63c
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jun 16 01:33:07 2021 -0500

    basic grid map

diff --git a/story.ni b/story.ni
index 64315a8..a08b73c 100644
--- a/story.ni
+++ b/story.ni
@@ -1,5 +1,7 @@
 "Knight's Errand" by Andrew Schultz

+debug-state is a truth state that varies.
+
 a room has a number called x. a room has a number called y.

 a1 is a room. x of a1 is 0. y of a1 is 0.
@@ -52,3 +54,20 @@ e4 is a room. x of e4 is 4. y of e4 is 3.

 e5 is a room. x of e5 is 4. y of e5 is 4.

+to decide which room is room_of (n1 - a number) and (n2 - a number):
+	repeat with Q running through rooms:
+		if x of Q is n1 and y of Q is n2:
+			decide on Q;
+	if debug-state is true:
+		say "Could not find room for [n1] and [n2].";
+
+when play begins:
+	repeat with xval running from 0 to 3:
+		repeat with yval running from 0 to 3:
+			let r1 be room_of xval and yval;
+			let r2 be room_of xval + 1 and yval;
+			let r3 be room_of xval and yval + 1;
+			now r1 is mapped west of r2;
+			now r2 is mapped east of r1;
+			now r3 is mapped north of r1;
+			now r1 is mapped south of r3;
commit 12058babcfe1332970c645c7827ef123d9bbcf3f
Author: Andrew <blurglecruncheon@gmail.com>
Date:   Wed Jun 16 01:09:39 2021 -0500

    all 25 rooms

diff --git a/story.ni b/story.ni
new file mode 100644
index 0000000..64315a8
--- /dev/null
+++ b/story.ni
@@ -0,0 +1,54 @@
+"Knight's Errand" by Andrew Schultz
+
+a room has a number called x. a room has a number called y.
+
+a1 is a room. x of a1 is 0. y of a1 is 0.
+
+a2 is a room. x of a2 is 0. y of a2 is 1.
+
+a3 is a room. x of a3 is 0. y of a3 is 2.
+
+a4 is a room. x of a4 is 0. y of a4 is 3.
+
+a5 is a room. x of a5 is 0. y of a5 is 4.
+
+b1 is a room. x of b1 is 1. y of b1 is 0.
+
+b2 is a room. x of b2 is 1. y of b2 is 1.
+
+b3 is a room. x of b3 is 1. y of b3 is 2.
+
+b4 is a room. x of b4 is 1. y of b4 is 3.
+
+b5 is a room. x of b5 is 1. y of b5 is 4.
+
+c1 is a room. x of c1 is 2. y of c1 is 0.
+
+c2 is a room. x of c2 is 2. y of c2 is 1.
+
+c3 is a room. x of c3 is 2. y of c3 is 2.
+
+c4 is a room. x of c4 is 2. y of c4 is 3.
+
+c5 is a room. x of c5 is 2. y of c5 is 4.
+
+d1 is a room. x of d1 is 3. y of d1 is 0.
+
+d2 is a room. x of d2 is 3. y of d2 is 1.
+
+d3 is a room. x of d3 is 3. y of d3 is 2.
+
+d4 is a room. x of d4 is 3. y of d4 is 3.
+
+d5 is a room. x of d5 is 3. y of d5 is 4.
+
+e1 is a room. x of e1 is 4. y of e1 is 0.
+
+e2 is a room. x of e2 is 4. y of e2 is 1.
+
+e3 is a room. x of e3 is 4. y of e3 is 2.
+
+e4 is a room. x of e4 is 4. y of e4 is 3.
+
+e5 is a room. x of e5 is 4. y of e5 is 4.
+
commit 1512e3f97d4719f4013d2d5df2365ac13961fe9e
Author: Andrew Schultz <blurglecruncheon@gmail.com>
Date:   Tue Jun 15 22:25:26 2021 -0500

    Initial commit

diff --git a/README.md b/README.md
new file mode 100644
index 0000000..8b5dc42
--- /dev/null
+++ b/README.md
@@ -0,0 +1,2 @@
+# knights-errand
+ParserComp 2021 project
